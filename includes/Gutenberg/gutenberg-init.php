<?php
if (!defined('ABSPATH')) {
    exit; // Prevent direct access
}

function fancy_post_grid_add_custom_block_category($categories) {
    return array_merge(
        $categories,
        array(
            array(
                'slug'  => 'fancy-post-grid-category',
                'title' => __('Fancy Post Grid', 'fancy-post-grid'),
            ),
        )
    );
}
add_filter('block_categories_all', 'fancy_post_grid_add_custom_block_category');

function fancy_post_grid_register_gutenberg_block() {  
    // Register Swiper CSS & JS
    wp_register_style(
        'fpg-swiper-css',
        plugins_url('blocks/fancy-post-slider/swiper-bundle.min.css', __FILE__),
        array(),
        filemtime(plugin_dir_path(__FILE__) . 'blocks/fancy-post-slider/swiper-bundle.min.css')
    );

    wp_register_script(
        'fpg-swiper',
        plugins_url('blocks/fancy-post-slider/swiper-bundle.min.js', __FILE__),
        array(),
        filemtime(plugin_dir_path(__FILE__) . 'blocks/fancy-post-slider/swiper-bundle.min.js'),
        true
    );
    wp_register_script(
        'fpg-isotope-pkgd',
        plugins_url('blocks/fancy-post-slider/isotope.pkgd.min.js', __FILE__),
        array(),
        filemtime(plugin_dir_path(__FILE__) . 'blocks/fancy-post-slider/isotope.pkgd.min.js'),
        true
    );
    wp_register_script(
        'fpg-main-js',
        plugins_url('blocks/fancy-post-slider/main.js', __FILE__),
        array('fpg-swiper', 'fpg-isotope-pkgd'),
        filemtime(plugin_dir_path(__FILE__) . 'blocks/fancy-post-slider/main.js'),
        true
    );

    wp_register_script(
        'fancy-post-grid-block',
        plugins_url('blocks/fancy-post-grid/grid-block.js', __FILE__),
        array('wp-blocks', 'wp-element', 'wp-editor', 'wp-data'),
        filemtime(plugin_dir_path(__FILE__) . 'blocks/fancy-post-grid/grid-block.js')
    );

    wp_register_script(
        'fancy-post-slider-block',
        plugins_url('blocks/fancy-post-slider/slider-block.js', __FILE__),
        array('wp-blocks', 'wp-element', 'wp-editor', 'wp-data'),
        filemtime(plugin_dir_path(__FILE__) . 'blocks/fancy-post-slider/slider-block.js')
    );

    wp_register_script(
        'fancy-post-list-block',
        plugins_url('blocks/fancy-post-list/list-block.js', __FILE__),
        array('wp-blocks', 'wp-element', 'wp-editor', 'wp-data'),
        filemtime(plugin_dir_path(__FILE__) . 'blocks/fancy-post-list/list-block.js')
    );

    wp_register_script(
        'fancy-post-isotope-block',
        plugins_url('blocks/fancy-post-isotope/isotope-block.js', __FILE__),
        array('wp-blocks', 'wp-element', 'wp-editor', 'wp-data'),
        filemtime(plugin_dir_path(__FILE__) . 'blocks/fancy-post-isotope/isotope-block.js')
    );    

    wp_register_style(
        'fancy-post-grid-style',
        plugins_url('blocks/fancy-post-grid/grid-style.css', __FILE__),
        array(),
        filemtime(plugin_dir_path(__FILE__) . 'blocks/fancy-post-grid/grid-style.css')
    );

    wp_register_style(
        'fancy-post-slider-style',
        plugins_url('blocks/fancy-post-slider/slider-style.css', __FILE__),
        array('fpg-swiper-js'),
        filemtime(plugin_dir_path(__FILE__) . 'blocks/fancy-post-slider/slider-style.css')
    );

    wp_register_style(
        'fancy-post-isotope-style',
        plugins_url('blocks/fancy-post-isotope/isotope-style.css', __FILE__),
        array(),
        filemtime(plugin_dir_path(__FILE__) . 'blocks/fancy-post-isotope/isotope-style.css')
    );

    wp_register_style(
        'fancy-post-list-style',
        plugins_url('blocks/fancy-post-list/list-style.css', __FILE__),
        array(),
        filemtime(plugin_dir_path(__FILE__) . 'blocks/fancy-post-list/list-style.css')
    );

    register_block_type('fancy-post-grid/block', array(
        'editor_script' => 'fancy-post-grid-block',
        'editor_style'  => 'fancy-post-grid-style',
        'style'         => '',
        'render_callback' => 'fancy_post_grid_render_callback', // PHP function to render posts
    ));

    register_block_type('fancy-post-slider/block', array(
        'editor_script' => 'fancy-post-slider-block',
        'editor_style'  => 'fancy-post-slider-style',
        'style'         => 'fpg-swiper-css',
        'script'          => 'fpg-main-js', // loads both main.js & swiper-js
        'render_callback' => 'fancy_post_slider_render_callback', // PHP function to render posts
    ));

    register_block_type('fancy-post-list/block', array(
        'editor_script' => 'fancy-post-list-block',
        'editor_style'  => 'fancy-post-list-style',
        'style'         => 'fancy-post-list-style',
        'render_callback' => 'fancy_post_list_render_callback', // PHP function to render posts
    ));

     register_block_type('fancy-post-isotope/block', array(
        'editor_script' => 'fancy-post-isotope-block',
        'editor_style'  => 'fancy-post-isotope-style',
        'style'         => 'fancy-post-isotope-style',
        'render_callback' => 'fancy_post_isotope_render_callback', // PHP function to render posts
    )); 
}
add_action('init', 'fancy_post_grid_register_gutenberg_block');


function fancy_post_grid_render_callback($attributes) {
    // Content Layout
    
    $gridLayoutStyle = isset($attributes['gridLayoutStyle']) ? $attributes['gridLayoutStyle'] : 'style1';
    $gridColumns = isset($attributes['gridColumns']) ? absint($attributes['gridColumns']) : '';
    //Query Builder
    $selectedCategory = isset($attributes['selectedCategory']) ? sanitize_text_field($attributes['selectedCategory']) : '';
    $selectedTag = isset($attributes['selectedTag']) ? sanitize_text_field($attributes['selectedTag']) : '';
    $orderBy = isset($attributes['orderBy']) ? sanitize_text_field($attributes['orderBy']) : 'title';
    $postLimit = isset($attributes['postLimit']) ? absint($attributes['postLimit']) : 3;
      
    // Pagination settings
    $enablePagination = isset($attributes['enablePagination']) ? filter_var($attributes['enablePagination'], FILTER_VALIDATE_BOOLEAN) : true;
    // Links
    $postLinkTarget = isset($attributes['postLinkTarget']) ? sanitize_text_field($attributes['postLinkTarget']) : 'newWindow';
    $thumbnailLink = isset($attributes['thumbnailLink']) ? filter_var($attributes['thumbnailLink'], FILTER_VALIDATE_BOOLEAN) : true;
    $postLinkType = isset($attributes['postLinkType']) ? sanitize_text_field($attributes['postLinkType']) : 'yeslink';

    // Field Selector
    $showPostTitle = isset($attributes['showPostTitle']) ? filter_var($attributes['showPostTitle'], FILTER_VALIDATE_BOOLEAN) : true;
    $showThumbnail = isset($attributes['showThumbnail']) ? filter_var($attributes['showThumbnail'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostExcerpt = isset($attributes['showPostExcerpt']) ? filter_var($attributes['showPostExcerpt'], FILTER_VALIDATE_BOOLEAN) : true;
    $showReadMoreButton = isset($attributes['showReadMoreButton']) ? filter_var($attributes['showReadMoreButton'], FILTER_VALIDATE_BOOLEAN) : true;
    $showMetaData = isset($attributes['showMetaData']) ? filter_var($attributes['showMetaData'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostDate = isset($attributes['showPostDate']) ? filter_var($attributes['showPostDate'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostAuthor = isset($attributes['showPostAuthor']) ? filter_var($attributes['showPostAuthor'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostCategory = isset($attributes['showPostCategory']) ? filter_var($attributes['showPostCategory'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostTags = isset($attributes['showPostTags']) ? filter_var($attributes['showPostTags'], FILTER_VALIDATE_BOOLEAN) : false;
    $showPostCommentsCount = isset($attributes['showPostCommentsCount']) ? filter_var($attributes['showPostCommentsCount'], FILTER_VALIDATE_BOOLEAN) : false;
    $showMetaIcon = isset($attributes['showMetaIcon']) ? filter_var($attributes['showMetaIcon'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostDateIcon = isset($attributes['showPostDateIcon']) ? filter_var($attributes['showPostDateIcon'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostAuthorIcon = isset($attributes['showPostAuthorIcon']) ? filter_var($attributes['showPostAuthorIcon'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostCategoryIcon = isset($attributes['showPostCategoryIcon']) ? filter_var($attributes['showPostCategoryIcon'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostTagsIcon = isset($attributes['showPostTagsIcon']) ? filter_var($attributes['showPostTagsIcon'], FILTER_VALIDATE_BOOLEAN) : false;
    $showPostCommentsCountIcon = isset($attributes['showPostCommentsCountIcon']) ? filter_var($attributes['showPostCommentsCountIcon'], FILTER_VALIDATE_BOOLEAN) : false;

    // Order values
    $metaOrder = isset($attributes['metaOrder']) ? absint($attributes['metaOrder']) : '';
    $titleOrder = isset($attributes['titleOrder']) ? absint($attributes['titleOrder']) : '';
    $excerptOrder = isset($attributes['excerptOrder']) ? absint($attributes['excerptOrder']) : '';
    $buttonOrder = isset($attributes['buttonOrder']) ? absint($attributes['buttonOrder']) : '';

    // Post title settings
    $titleTag               = isset($attributes['titleTag']) ? sanitize_text_field($attributes['titleTag']) : 'h3';
    $titleHoverUnderLine    = isset($attributes['titleHoverUnderLine']) ? sanitize_text_field($attributes['titleHoverUnderLine']) : 'enable';
    $titleCropBy            = isset($attributes['titleCropBy']) ? sanitize_text_field($attributes['titleCropBy']) : 'word';
    $titleLength            = isset($attributes['titleLength']) ? absint($attributes['titleLength']) : 12;
    
    //THUMB sETTINGS
    $thumbnailSize = isset($attributes['thumbnailSize']) ? sanitize_text_field($attributes['thumbnailSize']) : '';
    $hoverAnimation = isset($attributes['hoverAnimation']) ? sanitize_text_field($attributes['hoverAnimation']) : 'hover-zoom_in';

    // Excerpt Settings
    $excerptType = isset($attributes['excerptType']) ? sanitize_text_field($attributes['excerptType']) : 'word';
    $excerptIndicator = isset($attributes['excerptIndicator']) ? sanitize_text_field($attributes['excerptIndicator']) : '...';
    $excerptLimit = isset($attributes['excerptLimit']) ? absint($attributes['excerptLimit']) : 10;
    // Meta data Settings
    $metaAuthorPrefix = isset($attributes['metaAuthorPrefix']) ? sanitize_text_field($attributes['metaAuthorPrefix']) : __('By', 'fancy-post-grid');
    $metaSeperator = isset($attributes['metaSeperator']) ? sanitize_text_field($attributes['metaSeperator']) : '';
    //Button Settings   
    $showButtonIcon = isset($attributes['showButtonIcon']) ? filter_var($attributes['showPostCommentsCountIcon'], FILTER_VALIDATE_BOOLEAN) : true;
    $iconPosition = isset($attributes['iconPosition']) ? sanitize_text_field($attributes['iconPosition']) : 'right';
    $buttonStyle = isset($attributes['buttonStyle']) ? sanitize_text_field($attributes['buttonStyle']) : '';
    $readMoreLabel = isset($attributes['readMoreLabel']) ? sanitize_text_field($attributes['readMoreLabel']) : __('Read More', 'fancy-post-grid');
    // SECTION Area
    $sectionBgColor    = isset($attributes['sectionBgColor']) ? sanitize_hex_color($attributes['sectionBgColor']) : '';
    $sectionMargin = isset($attributes['sectionMargin']) ? $attributes['sectionMargin'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $sectionPadding = isset($attributes['sectionPadding']) ? $attributes['sectionPadding'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    // ITEM Box
    $itemPadding = isset($attributes['itemPadding']) ? $attributes['itemPadding'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $itemMargin = isset($attributes['itemMargin']) ? $attributes['itemMargin'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $itemBorderRadius = isset($attributes['itemBorderRadius']) ? $attributes['itemBorderRadius'] : ['top' => '5', 'right' => '5', 'bottom' => '5', 'left' => '5'];
    $itemBorderWidth = isset($attributes['itemBorderWidth']) ? $attributes['itemBorderWidth'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $itemBoxAlignment   = isset($attributes['itemBoxAlignment']) ? sanitize_text_field($attributes['itemBoxAlignment']) : 'start';
    $itemBorderType     = isset($attributes['itemBorderType']) ? sanitize_text_field($attributes['itemBorderType']) : '';
    $itemBoxShadow = isset($attributes['itemBoxShadow']) ? $attributes['itemBoxShadow'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
    $itemBackgroundColor = isset($attributes['itemBackgroundColor']) ? sanitize_hex_color($attributes['itemBackgroundColor']) : '';
    $itemBorderColor    = isset($attributes['itemBorderColor']) ? sanitize_hex_color($attributes['itemBorderColor']) : '';   
    $itemBoxShadowColor = isset($attributes['itemBoxShadowColor']) ? sanitize_hex_color($attributes['itemBoxShadowColor']) : '';
    $itemGap      = isset($attributes['itemGap']) ? absint($attributes['itemGap']) : 30;

    // Content Box
    $contentitemPaddingNew = isset($attributes['contentitemPaddingNew']) ? $attributes['contentitemPaddingNew'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $contentitemMarginNew = isset($attributes['contentitemMarginNew']) ? $attributes['contentitemMarginNew'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $contentBorderWidth = isset($attributes['contentBorderWidth']) ? $attributes['contentBorderWidth'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $contentNormalBorderType = isset($attributes['contentnormalBorderType']) ? sanitize_text_field($attributes['contentnormalBorderType']) : '';
    $contentBgColor    = isset($attributes['contentBgColor']) ? sanitize_hex_color($attributes['contentBgColor']) : '';   
    $contentBorderColor = isset($attributes['contentBorderColor']) ? sanitize_hex_color($attributes['contentBorderColor']) : '';
    // Thumbnail
    $thumbnailMargin = isset($attributes['thumbnailMargin']) ? $attributes['thumbnailMargin'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $thumbnailPadding = isset($attributes['thumbnailPadding']) ? $attributes['thumbnailPadding'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $thumbnailBorderRadius = isset($attributes['thumbnailBorderRadius']) ? $attributes['thumbnailBorderRadius'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];

    // Post Title
    $postTitleFontSize      = isset($attributes['postTitleFontSize']) ? absint($attributes['postTitleFontSize']) : '';
    $postTitleLineHeight    = isset($attributes['postTitleLineHeight']) ? floatval($attributes['postTitleLineHeight']) : '';
    $postTitleLetterSpacing = isset($attributes['postTitleLetterSpacing']) ? floatval($attributes['postTitleLetterSpacing']) : '';
    $postTitleFontWeight    = isset($attributes['postTitleFontWeight']) ? sanitize_text_field($attributes['postTitleFontWeight']) : '';
    $postTitleAlignment     = isset($attributes['postTitleAlignment']) ? sanitize_text_field($attributes['postTitleAlignment']) : '';
    $postTitleColor         = isset($attributes['postTitleColor']) ? sanitize_hex_color($attributes['postTitleColor']) : '';
    $postTitleBgColor       = isset($attributes['postTitleBgColor']) ? sanitize_hex_color($attributes['postTitleBgColor']) : ''; 
    $postTitleHoverColor    = isset($attributes['postTitleHoverColor']) ? sanitize_hex_color($attributes['postTitleHoverColor']) : '';
    $postTitleHoverBgColor  = isset($attributes['postTitleHoverBgColor']) ? sanitize_hex_color($attributes['postTitleHoverBgColor']) : '';
    $postTitleMargin  = isset($attributes['postTitleMargin']) ? array_map('sanitize_text_field', $attributes['postTitleMargin']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $postTitlePadding = isset($attributes['postTitlePadding']) ? array_map('sanitize_text_field', $attributes['postTitlePadding']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];

    // Excerpt
    $excerptFontSize = isset($attributes['excerptFontSize']) ? absint($attributes['excerptFontSize']) : '';
    $excerptLineHeight = isset($attributes['excerptLineHeight']) ? floatval($attributes['excerptLineHeight']) : '';
    $excerptLetterSpacing = isset($attributes['excerptLetterSpacing']) ? floatval($attributes['excerptLetterSpacing']) : '';
    $excerptFontWeight = isset($attributes['excerptFontWeight']) ? sanitize_text_field($attributes['excerptFontWeight']) : '';
    $excerptAlignment = isset($attributes['excerptAlignment']) ? sanitize_text_field($attributes['excerptAlignment']) : '';
    $excerptMargin = isset($attributes['excerptMargin']) ? array_map('sanitize_text_field', $attributes['excerptMargin']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $excerptPadding = isset($attributes['excerptPadding']) ? array_map('sanitize_text_field', $attributes['excerptPadding']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $excerptColor = isset($attributes['excerptColor']) ? sanitize_hex_color($attributes['excerptColor']) : '';
    $excerptBgColor = isset($attributes['excerptBgColor']) ? sanitize_hex_color($attributes['excerptBgColor']) : '';
    $excerptBorderType = isset($attributes['excerptBorderType']) ? sanitize_text_field($attributes['excerptBorderType']) : '';
    $excerptHoverColor = isset($attributes['excerptHoverColor']) ? sanitize_hex_color($attributes['excerptHoverColor']) : '';
    $excerptHoverBgColor = isset($attributes['excerptHoverBgColor']) ? sanitize_hex_color($attributes['excerptHoverBgColor']) : '';
    $excerptHoverBorderColor = isset($attributes['excerptHoverBorderColor']) ? sanitize_hex_color($attributes['excerptHoverBorderColor']) : '';

    // Meta Data Attributes
    $metaAlignment = isset($attributes['metaAlignment']) ? sanitize_text_field($attributes['metaAlignment']) : '';
    $metaMarginNew = isset($attributes['metaMarginNew']) ? $attributes['metaMarginNew'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $metaPadding = isset($attributes['metaPadding']) ? $attributes['metaPadding'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $metaTextColor = isset($attributes['metaTextColor']) ? sanitize_hex_color($attributes['metaTextColor']) : '';
    $separatorColor = isset($attributes['separatorColor']) ? sanitize_hex_color($attributes['separatorColor']) : '';
    $metaFontSize = isset($attributes['metaFontSize']) ? absint($attributes['metaFontSize']) : '';
    $metaIconColor = isset($attributes['metaIconColor']) ? sanitize_hex_color($attributes['metaIconColor']) : '';
    $metaBgColor = isset($attributes['metaBgColor']) ? sanitize_hex_color($attributes['metaBgColor']) : '';
    
    // Button Alignment
    $buttonAlignment = isset($attributes['buttonAlignment']) ? sanitize_text_field($attributes['buttonAlignment']) : '';
    $buttonMarginNew = isset($attributes['buttonMarginNew']) ? array_map('sanitize_text_field', $attributes['buttonMarginNew']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $buttonPaddingNew = isset($attributes['buttonPaddingNew']) ? array_map('sanitize_text_field', $attributes['buttonPaddingNew']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $buttonFontSize = isset($attributes['buttonFontSize']) ? absint($attributes['buttonFontSize']) : '';
    $buttonBorderWidth = isset($attributes['buttonBorderWidth']) ? array_map('sanitize_text_field', $attributes['buttonBorderWidth']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $buttonFontWeight = isset($attributes['buttonFontWeight']) ? sanitize_text_field($attributes['buttonFontWeight']) : '';
    $buttonTextColor = isset($attributes['buttonTextColor']) ? sanitize_hex_color($attributes['buttonTextColor']) : '';
    $buttonBackgroundColor = isset($attributes['buttonBackgroundColor']) ? sanitize_hex_color($attributes['buttonBackgroundColor']) : '';
    $buttonBorderType = isset($attributes['buttonBorderType']) ? sanitize_text_field($attributes['buttonBorderType']) : '';
    $buttonBorderRadius = isset($attributes['buttonBorderRadius']) ? array_map('sanitize_text_field', $attributes['buttonBorderRadius']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
    $buttonHoverTextColor = isset($attributes['buttonHoverTextColor']) ? sanitize_hex_color($attributes['buttonHoverTextColor']) : '';
    $buttonHoverBackgroundColor = isset($attributes['buttonHoverBackgroundColor']) ? sanitize_hex_color($attributes['buttonHoverBackgroundColor']) : ''; 
    $buttonBorderColor = isset($attributes['buttonBorderColor']) ? sanitize_hex_color($attributes['buttonBorderColor']) : '';
    $buttonHoverBorderColor = isset($attributes['buttonHoverBorderColor']) ? sanitize_hex_color($attributes['buttonHoverBorderColor']) : '';
    // Pagination Attributes
    $paginationAlignment = isset($attributes['paginationAlignment']) ? sanitize_text_field($attributes['paginationAlignment']) : 'center';

    $paginationMarginNew = isset($attributes['paginationMarginNew']) ? $attributes['paginationMarginNew'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $paginationPaddingNew = isset($attributes['paginationPaddingNew']) ? $attributes['paginationPaddingNew'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    
    $paginationBorderStyle = isset($attributes['paginationBorderStyle']) ? sanitize_text_field($attributes['paginationBorderStyle']) : 'solid';
    $paginationFontSize = isset($attributes['paginationFontSize']) ? absint($attributes['paginationFontSize']) : '16';
    $paginationBorderWidthNew = isset($attributes['paginationBorderWidthNew']) ? array_map('sanitize_text_field', $attributes['paginationBorderWidthNew']) : ['top' => '1', 'right' => '1', 'bottom' => '1', 'left' => '1'];
    
    $paginationBorderRadius = isset($attributes['paginationBorderRadius']) ? array_map('sanitize_text_field', $attributes['paginationBorderRadius']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $paginationGap = isset($attributes['paginationGap']) ? absint($attributes['paginationGap']) : 20;
    $paginationTextColor = isset($attributes['paginationTextColor']) ? sanitize_hex_color($attributes['paginationTextColor']) : '#6a6d7a';
    $paginationBackgroundColor = isset($attributes['paginationBackgroundColor']) ? sanitize_hex_color($attributes['paginationBackgroundColor']) : '';
    $paginationBorderColor = isset($attributes['paginationBorderColor']) ? sanitize_hex_color($attributes['paginationBorderColor']) : '#eaeaea';
    $paginationHoverTextColor = isset($attributes['paginationHoverTextColor']) ? sanitize_hex_color($attributes['paginationHoverTextColor']) : '#ffffff';
    $paginationHoverBackgroundColor = isset($attributes['paginationHoverBackgroundColor']) ? sanitize_hex_color($attributes['paginationHoverBackgroundColor']) : '#007aff';
    $paginationHoverBorderColor = isset($attributes['paginationHoverBorderColor']) ? sanitize_hex_color($attributes['paginationHoverBorderColor']) : '#007aff';
    $paginationActiveTextColor = isset($attributes['paginationActiveTextColor']) ? sanitize_hex_color($attributes['paginationActiveTextColor']) : '#ffffff';
    $paginationActiveBackgroundColor = isset($attributes['paginationActiveBackgroundColor']) ? sanitize_hex_color($attributes['paginationActiveBackgroundColor']) : '#007aff';
    $paginationActiveBorderColor = isset($attributes['paginationActiveBorderColor']) ? sanitize_hex_color($attributes['paginationActiveBorderColor']) : '#007aff';

    //END ATTRIBUTES
    
    $paged = (get_query_var('paged')) ? get_query_var('paged') : 1;

    $query_args = array(
        'post_type'      => 'post',
        'posts_per_page' => $postLimit, // Adjust as needed
        'paged'          => $paged,
        'orderby'        => $orderBy,
        'order'          => 'DESC', // Ensure ordering
    );

    // Filter by category (use 'cat' for category ID)
    if (!empty($selectedCategory) && is_numeric($selectedCategory)) {
        $query_args['cat'] = intval($selectedCategory); 
    }

    // Filter by tag (use 'tag__in' for tag IDs)
    if (!empty($selectedTag) && is_numeric($selectedTag)) {
        $query_args['tag__in'] = array(intval($selectedTag)); 
    }
    // GRID COLUMNS
    $gridColumns1 = ($gridLayoutStyle === 'style1' && $gridColumns == null)
              ? 3 : $gridColumns; 
    $gridColumns2 = ($gridLayoutStyle === 'style2' && $gridColumns == null)
              ? 3 : $gridColumns; 
    $gridColumns3 = ($gridLayoutStyle === 'style3' && $gridColumns == null)
              ? 3 : $gridColumns; 
    $gridColumns4 = ($gridLayoutStyle === 'style4' && $gridColumns == null)
              ? 3 : $gridColumns; 
    $gridColumns5 = ($gridLayoutStyle === 'style5' && $gridColumns == null)
              ? 3 : $gridColumns; 
    $gridColumns6 = ($gridLayoutStyle === 'style6' && $gridColumns == null)
              ? 3 : $gridColumns; 
    $gridColumns7 = ($gridLayoutStyle === 'style7' && $gridColumns == null)
              ? 4 : $gridColumns; 
    $gridColumns8 = ($gridLayoutStyle === 'style8' && $gridColumns == null)
              ? 3 : $gridColumns; 
    $gridColumns9 = ($gridLayoutStyle === 'style9' && $gridColumns == null)
              ? 3 : $gridColumns; 
    $gridColumns10 = ($gridLayoutStyle === 'style10' && $gridColumns == null)
              ? 3 : $gridColumns; 
    $gridColumns11 = ($gridLayoutStyle === 'style11' && $gridColumns == null)
              ? 3 : $gridColumns; 
    $gridColumns12 = ($gridLayoutStyle === 'style12' && $gridColumns == null)
              ? 3 : $gridColumns; 

    // GRID COLUMNS
    $thumbnailSize1 = ($gridLayoutStyle === 'style1' && $thumbnailSize == null)
              ? 'fancy_post_custom_size' : $thumbnailSize; 
    $thumbnailSize2 = ($gridLayoutStyle === 'style2' && $thumbnailSize == null)
              ? 'fancy_post_custom_size' : $thumbnailSize; 
    $thumbnailSize3 = ($gridLayoutStyle === 'style3' && $thumbnailSize == null)
              ? 'fancy_post_custom_size' : $thumbnailSize; 
    $thumbnailSize4 = ($gridLayoutStyle === 'style4' && $thumbnailSize == null)
              ? 'fancy_post_landscape' : $thumbnailSize; 
    $thumbnailSize5 = ($gridLayoutStyle === 'style5' && $thumbnailSize == null)
              ? 'fancy_post_square' : $thumbnailSize; 
    $thumbnailSize6 = ($gridLayoutStyle === 'style6' && $thumbnailSize == null)
              ? 'fancy_post_landscape' : $thumbnailSize; 
    $thumbnailSize7 = ($gridLayoutStyle === 'style7' && $thumbnailSize == null)
              ? 'fancy_post_square' : $thumbnailSize; 
    $thumbnailSize8 = ($gridLayoutStyle === 'style8' && $thumbnailSize == null)
              ? 'fancy_post_landscape' : $thumbnailSize; 
    $thumbnailSize9 = ($gridLayoutStyle === 'style9' && $thumbnailSize == null)
              ? 'fancy_post_landscape' : $thumbnailSize; 
    $thumbnailSize10 = ($gridLayoutStyle === 'style10' && $thumbnailSize == null)
              ? 'fancy_post_landscape' : $thumbnailSize; 
    $thumbnailSize11 = ($gridLayoutStyle === 'style11' && $thumbnailSize == null)
              ? 'fancy_post_landscape' : $thumbnailSize; 
    $thumbnailSize12 = ($gridLayoutStyle === 'style12' && $thumbnailSize == null)
              ? 'fancy_post_square' : $thumbnailSize;
    
    // buttonStyle
    $buttonStyle1 = ($gridLayoutStyle === 'style1' && $buttonStyle == null)
              ? 'fpg-flat' : $buttonStyle; 
    $buttonStyle2 = ($gridLayoutStyle === 'style2' && $buttonStyle == null)
              ? 'fpg-border' : $buttonStyle; 
    $buttonStyle3 = ($gridLayoutStyle === 'style3' && $buttonStyle == null)
              ? 'fpg-filled' : $buttonStyle; 
    $buttonStyle5 = ($gridLayoutStyle === 'style5' && $buttonStyle == null)
              ? 'fpg-flat' : $buttonStyle; 
    $buttonStyle6 = ($gridLayoutStyle === 'style6' && $buttonStyle == null)
              ? 'fpg-border' : $buttonStyle; 
    $buttonStyle10 = ($gridLayoutStyle === 'style10' && $buttonStyle == null)
              ? 'fpg-filled' : $buttonStyle; 
    $buttonStyle11 = ($gridLayoutStyle === 'style11' && $buttonStyle == null)
              ? 'fpg-border' : $buttonStyle; 
    $buttonStyle12 = ($gridLayoutStyle === 'style12' && $buttonStyle == null)
              ? 'fpg-filled' : $buttonStyle;  

    // Run the query
    $query = new WP_Query($query_args);
    
    if (!$query->have_posts()) {
        return '<p>' . esc_html__('No posts found.', 'fancy-post-grid') . '</p>';
    }
    if ($gridLayoutStyle === 'style1') {
        $output = '<div class="rs-blog-layout-5 ' . esc_attr($gridLayoutStyle) . '" style="display: grid; grid-template-columns: repeat(' . esc_attr($gridColumns1) . ', 1fr); ';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }
        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';
    }else if ($gridLayoutStyle === 'style2') {
        $output = '<div class="rs-blog-layout-6 grey ' . esc_attr($gridLayoutStyle) . '" style="display: grid; 
                    grid-template-columns: repeat(' . esc_attr($gridColumns2) . ', 1fr); ';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }    
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }

        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';
    }else if ($gridLayoutStyle === 'style3') {
        $output = '<div class="rs-blog-layout-28  ' . esc_attr($gridLayoutStyle) . '" style="display: grid; 
                    grid-template-columns: repeat(' . esc_attr($gridColumns3) . ', 1fr); ';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }    
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }

        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';
    }else if ($gridLayoutStyle === 'style4') {
        $output = '<div class="rs-blog-layout-30  ' . esc_attr($gridLayoutStyle) . '" style="display: grid; 
                    grid-template-columns: repeat(' . esc_attr($gridColumns4) . ', 1fr); ';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }    
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }

        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';
    }else if ($gridLayoutStyle === 'style5') {
        $output = '<div class="rs-blog-layout-12 ' . esc_attr($gridLayoutStyle) . '" style="display: grid; 
                    grid-template-columns: repeat(' . esc_attr($gridColumns5) . ', 1fr); ';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }    
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }

        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';
    }else if ($gridLayoutStyle === 'style6') {
        $output = '<div class="rs-blog-layout-13 ' . esc_attr($gridLayoutStyle) . '" style="display: grid; 
                    grid-template-columns: repeat(' . esc_attr($gridColumns6) . ', 1fr); ';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }    
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }

        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';
    }else if ($gridLayoutStyle === 'style7') {
        $output = '<div class="rs-blog-layout-14 grey ' . esc_attr($gridLayoutStyle) . '" style="display: grid; 
                    grid-template-columns: repeat(' . esc_attr($gridColumns7) . ', 1fr); ';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }    
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }

        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';
    }else if ($gridLayoutStyle === 'style8') {
        $output = '<div class="rs-blog-layout-15 ' . esc_attr($gridLayoutStyle) . '" style="display: grid; 
                    grid-template-columns: repeat(' . esc_attr($gridColumns8) . ', 1fr); ';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }    
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }

        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';
    }else if ($gridLayoutStyle === 'style9') {
        $output = '<div class="rs-blog-layout-16 ' . esc_attr($gridLayoutStyle) . '" style="display: grid; 
                    grid-template-columns: repeat(' . esc_attr($gridColumns9) . ', 1fr); ';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }    
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }

        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';
    }else if ($gridLayoutStyle === 'style10') {
        $output = '<div class="rs-blog-layout-19' . esc_attr($gridLayoutStyle) . '" style="display: grid; 
                    grid-template-columns: repeat(' . esc_attr($gridColumns10) . ', 1fr); ';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }    
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }

        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';
    }else if ($gridLayoutStyle === 'style11') {
        $output = '<div class="rs-blog-layout-21  ' . esc_attr($gridLayoutStyle) . '" style="display: grid; 
                    grid-template-columns: repeat(' . esc_attr($gridColumns11) . ', 1fr); ';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }    
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }

        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';
    }else if ($gridLayoutStyle === 'style12') {
        $output = '<div class="rs-blog-layout-26  ' . esc_attr($gridLayoutStyle) . '" style="display: grid; 
                    grid-template-columns: repeat(' . esc_attr($gridColumns12) . ', 1fr); ';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }    
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }

        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';
    }    
        while ($query->have_posts()) {
            $query->the_post();
            $post_id = get_the_ID();
            $permalink = get_permalink($post_id);
            $title = get_the_title();
            $date = get_the_date();
            $getdate = get_the_date('M j, Y', $post_id);
            $author = get_the_author();
            $categories = get_the_category_list(', ');
            $tags = get_the_tag_list('', ', ');
            $comments_count = get_comments_number();
            if ($gridLayoutStyle === 'style1') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize1, ['class' => 'fancy-post-thumbnail']);}
            if ($gridLayoutStyle === 'style2') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize2, ['class' => 'fancy-post-thumbnail']);}
            if ($gridLayoutStyle === 'style3') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize3, ['class' => 'fancy-post-thumbnail']);}
            if ($gridLayoutStyle === 'style4') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize4, ['class' => 'fancy-post-thumbnail']);}
            if ($gridLayoutStyle === 'style5') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize5, ['class' => 'fancy-post-thumbnail']);}
            if ($gridLayoutStyle === 'style6') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize6, ['class' => 'fancy-post-thumbnail']);}
            if ($gridLayoutStyle === 'style7') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize7, ['class' => 'fancy-post-thumbnail']);}
            if ($gridLayoutStyle === 'style8') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize8, ['class' => 'fancy-post-thumbnail']);}
            if ($gridLayoutStyle === 'style9') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize9, ['class' => 'fancy-post-thumbnail']);}
            if ($gridLayoutStyle === 'style10') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize10, ['class' => 'fancy-post-thumbnail']);}
            if ($gridLayoutStyle === 'style11') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize11, ['class' => 'fancy-post-thumbnail']);}
            if ($gridLayoutStyle === 'style12') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize12, ['class' => 'fancy-post-thumbnail']);}

            // Title Crop
            if ($titleCropBy === 'word') {
                $titleArray = explode(' ', $title);
                $croppedTitle = implode(' ', array_slice($titleArray, 0, (int) $titleLength));
            } elseif ($titleCropBy === 'cha') {
                $croppedTitle = mb_substr($title, 0, $titleLength);
            } else {
                $croppedTitle = $title; // fallback
            }
            // Fetch full content when 'full_content' is selected
            if ($excerptType === 'full_content') {
                $excerpt = apply_filters('the_content', get_the_content());
            } elseif ($excerptType === 'word') {
                $excerpt = wp_trim_words(get_the_excerpt(), $excerptLimit, $excerptIndicator);
            } else { // 'character'
                $excerpt = mb_substr(get_the_excerpt(), 0, $excerptLimit) . $excerptIndicator;
            }
            

            // Style-based output
            if ($gridLayoutStyle === 'style1') {
                // Full post layout
                
                $output .= '<div class="rs-blog__single align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                    // MARGIN    
                    if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                        $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'margin: 40px 0px 0px 0px;';
                    }

                    // Padding
                    if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                        $output .= 'padding: ' .
                            (isset($itemPadding['top']) && $itemPadding['top'] !== '' ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' .
                            (isset($itemPadding['right']) && $itemPadding['right'] !== '' ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' .
                            (isset($itemPadding['bottom']) && $itemPadding['bottom'] !== '' ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' .
                            (isset($itemPadding['left']) && $itemPadding['left'] !== '' ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; ';
                    } else {
                        $output .= 'padding: 0px;';
                    }


                    // Border Radius
                    if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' .
                            (isset($itemBorderRadius['top']) && $itemBorderRadius['top'] !== '' ? (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) : '0px') . ' ' .
                            (isset($itemBorderRadius['right']) && $itemBorderRadius['right'] !== '' ? (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) : '0px') . ' ' .
                            (isset($itemBorderRadius['bottom']) && $itemBorderRadius['bottom'] !== '' ? (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) : '0px') . ' ' .
                            (isset($itemBorderRadius['left']) && $itemBorderRadius['left'] !== '' ? (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) : '0px') . '; ';
                    } else {
                        $output .= 'border-radius: 0px;';
                    }

                    // Border Width
                    if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (isset($itemBorderWidth['top']) && $itemBorderWidth['top'] !== '' ? (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) : '0px') . ' ' .
                            (isset($itemBorderWidth['right']) && $itemBorderWidth['right'] !== '' ? (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) : '0px') . ' ' .
                            (isset($itemBorderWidth['bottom']) && $itemBorderWidth['bottom'] !== '' ? (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) : '0px') . ' ' .
                            (isset($itemBorderWidth['left']) && $itemBorderWidth['left'] !== '' ? (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) : '0px') . '; ';
                    } else {
                        $output .= 'border-width: 0px;';
                    }


                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (
                        !empty($itemBoxShadow['top']) ||
                        !empty($itemBoxShadow['right']) ||
                        !empty($itemBoxShadow['bottom']) ||
                        !empty($itemBoxShadow['left']) ||
                        !empty($itemBoxShadowColor)
                    ) {
                        $output .= 'box-shadow: ' .
                            (isset($itemBoxShadow['left']) && $itemBoxShadow['left'] !== '' ? (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) : '0px') . ' ' .
                            (isset($itemBoxShadow['top']) && $itemBoxShadow['top'] !== '' ? (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) : '0px') . ' ' .
                            (isset($itemBoxShadow['right']) && $itemBoxShadow['right'] !== '' ? (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) : '0px') . ' ' .
                            (isset($itemBoxShadow['bottom']) && $itemBoxShadow['bottom'] !== '' ? (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) : '0px') . ' ' .
                            (!empty($itemBoxShadowColor) ? esc_attr($itemBoxShadowColor) : 'rgba(0,0,0,0.1)') . '; ';
                    }

                $output .= '">';

                // Thumbnail
                if ($thumbnail && $showThumbnail) {
                    $output .= '<div class="rs-thumb" style="';

                    // Margin
                    $output .= 'margin: ' . 
                        (isset($thumbnailMargin['top']) && $thumbnailMargin['top'] !== '' ? (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) : '0px') . ' ' .
                        (isset($thumbnailMargin['right']) && $thumbnailMargin['right'] !== '' ? (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) : '0px') . ' ' .
                        (isset($thumbnailMargin['bottom']) && $thumbnailMargin['bottom'] !== '' ? (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) : '0px') . ' ' .
                        (isset($thumbnailMargin['left']) && $thumbnailMargin['left'] !== '' ? (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) : '0px') . '; ';

                    // Padding
                    $output .= 'padding: ' . 
                        (isset($thumbnailPadding['top']) && $thumbnailPadding['top'] !== '' ? (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) : '0px') . ' ' .
                        (isset($thumbnailPadding['right']) && $thumbnailPadding['right'] !== '' ? (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) : '0px') . ' ' .
                        (isset($thumbnailPadding['bottom']) && $thumbnailPadding['bottom'] !== '' ? (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) : '0px') . ' ' .
                        (isset($thumbnailPadding['left']) && $thumbnailPadding['left'] !== '' ? (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) : '0px') . '; ';

                    // Border Radius
                    $output .= 'border-radius: ' .
                        (isset($thumbnailBorderRadius['top']) && $thumbnailBorderRadius['top'] !== '' ? (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) : '0px') . ' ' .
                        (isset($thumbnailBorderRadius['right']) && $thumbnailBorderRadius['right'] !== '' ? (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) : '0px') . ' ' .
                        (isset($thumbnailBorderRadius['bottom']) && $thumbnailBorderRadius['bottom'] !== '' ? (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) : '0px') . ' ' .
                        (isset($thumbnailBorderRadius['left']) && $thumbnailBorderRadius['left'] !== '' ? (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) : '0px') . ';';


                    $output .= '">';

                    // Anchor with optional border-radius and overflow
                    if ($thumbnailLink) {
                        $output .= '<a href="' . esc_url($permalink) . '">';
                        $output .= $thumbnail;
                        $output .= '</a>';
                    } else {
                        $output .= $thumbnail;
                    }
                    $output .= '</div>';
                }
                // END Thumbnail

                // MAIN Content
                $output .= '<div class="rs-content" style="';
                    // Margin
                    if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                        $output .= 'margin: ' .
                            (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                            (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                            (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                            (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                    }
                    // Padding
                    if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                        $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'padding: 20px 0px 0px 0px;';
                    }
                    // Check if at least one side is not empty
                    if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                            (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                            (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                            (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';

                // Meta Data
                if ($showMetaData) {
                    $output .= '<ul class="meta-data-list align-' . $metaAlignment . ' " style="';  
                        // Margin
                        if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                            $output .= 'margin: ' .
                                (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                        }
                        // Padding
                        if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                            $output .= 'padding: ' .
                                (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                        }   
                        
                        // Color
                        if (!empty($metaTextColor)) {
                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                        }
                        // Order
                        if (!empty($metaOrder)) {
                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                        }
                    $output .= '">';

                    $meta_items = [];

                    // Date
                    if ($showPostDate) {
                        $meta = '<li class="meta-date" style="';

                        // Color
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        // Font size
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        // Icon
                        if ($showPostDateIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-calendar-alt" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($getdate) . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Author
                    if ($showPostAuthor) {
                        $meta = '<li class="meta-author" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostAuthorIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-user" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Category
                    if ($showPostCategory) {
                        $meta = '<li class="meta-categories" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCategoryIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-folder" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        // Get category names without links
                        $categories_list = get_the_category($post_id);
                        if (!empty($categories_list)) {
                            $category_names = array();
                            foreach ($categories_list as $category) {
                                $category_names[] = esc_html($category->name);
                            }
                            $meta .= implode(', ', $category_names); // comma-separated plain text categories
                        }

                        $meta .= '</li>';
                        $meta_items[] = $meta;
                    }
                    // Tags
                    if ($showPostTags && !empty($tags)) {
                        $meta = '<li class="meta-tags" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostTagsIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-tags" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Comment Count
                    if ($showPostCommentsCount) {
                        $meta = '<li class="meta-comment-count" style="';
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCommentsCountIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-comments" style="';
                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }
                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Now join meta items with the separator
                    if (!empty($meta_items)) {
                        $separator = '';

                        if ($metaSeperator !== '') {
                            $separator = '';
                            if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                $separatorStyle = '';
                                if (!empty($separatorColor)) {
                                    $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                            }
                        }

                        $output .= implode($separator, $meta_items);
                    }
                    $output .= '</ul>'; // Close meta-data-list               
                }
                // End Meta Data

                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }
                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }
                    // Margin
                    if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .
                            (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                            (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                            (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                            (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                    }
                    // Padding
                    if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                            (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                            (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                            (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                    }
                    // Class name
                    $classNames = 'title' 
                        . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                        . ' align-' . esc_attr($postTitleAlignment);
                    // Hover JS (conditionally included)
                    $onmouseover = !empty($postTitleHoverBgColor) 
                        ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                        : '';
                    $onmouseout = !empty($postTitleBgColor) 
                        ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                        : '';
                    // Final output
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                        . $onmouseover 
                        . $onmouseout 
                        . '>';

                    $style = '';
                    $hoverStyle = '';
                    $mouseoutStyle = '';

                    // Build inline styles conditionally
                    if (!empty($postTitleFontSize)) {
                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                    }
                    if (!empty($postTitleLineHeight)) {
                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                    }
                    if (!empty($postTitleLetterSpacing)) {
                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                    }
                    if (!empty($postTitleFontWeight)) {
                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                    }
                    if (!empty($postTitleColor)) {
                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        if ($titleHoverUnderLine === 'enable') {
                            $style .= 'background-image: linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%); ';
                            $style .= 'background-position: 0 100%; ';
                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                        }
                    }
                    // Build hover color style if set
                    if (!empty($postTitleHoverColor)) {
                        $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        if ($titleHoverUnderLine === 'enable') {
                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                        }
                    }
                    // Final output
                    $output .= '<a href="' . esc_url($permalink) . '" 
                        style="' . esc_attr(trim($style)) . '"'
                        . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                        . esc_html($croppedTitle) . '</a>';    
                    $output .= '</' . esc_attr($titleTag) . '>';
                }

                // Excerpt
                if ($showPostExcerpt) {
                    $excerptStyles = '';
                    $excerptColorStyles = '';

                    // Order
                    if (!empty($excerptOrder)) {
                        $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                    }

                    // Typography
                    if (!empty($excerptFontSize)) {
                        $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                    }

                    if (!empty($excerptLineHeight)) {
                        $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                    }

                    if (!empty($excerptLetterSpacing)) {
                        $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                    }

                    if (!empty($excerptFontWeight)) {
                        $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                    }

                    if (!empty($excerptColor)) {
                        $excerptColorStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                    }

                    if (!empty($excerptBgColor)) {
                        $excerptColorStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                    }

                    if (!empty($excerptBorderType)) {
                        $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                    }

                    // Margin
                    if (!empty($excerptMargin['top']) || !empty($excerptMargin['right']) || !empty($excerptMargin['bottom']) || !empty($excerptMargin['left'])) {
                        $excerptStyles .= 'margin: ' .
                            (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) . ' ' .
                            (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) . ' ' .
                            (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) . ' ' .
                            (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($excerptPadding['top']) || !empty($excerptPadding['right']) || !empty($excerptPadding['bottom']) || !empty($excerptPadding['left'])) {
                        $excerptStyles .= 'padding: ' .
                            (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) . ' ' .
                            (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) . ' ' .
                            (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) . ' ' .
                            (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) . '; ';
                    }

                    // Handle hover logic conditionally
                    $hoverIn = '';
                    $hoverOut = '';

                    if (!empty($excerptHoverColor)) {
                        $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                        $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                    }

                    if (!empty($excerptHoverBgColor)) {
                        $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                        $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                    }

                    if (!empty($excerptHoverBorderColor)) {
                        $hoverIn .= 'this.style.borderColor=\'' . esc_attr($excerptHoverBorderColor) . '\';';
                        $hoverOut .= 'this.style.borderColor=\'inherit\';';
                    }

                    $output .= '<div class="fpg-excerpt' . ' align-' . esc_attr($excerptAlignment) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                    $output .= '>';
                    $output .= '<p style="' . esc_attr(trim($excerptColorStyles)) . '"';

                        if (!empty($hoverIn) || !empty($hoverOut)) {
                            if (!empty($hoverIn)) {
                                $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                            }
                            if (!empty($hoverOut)) {
                                $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                            }
                        }

                        $output .= '>' . esc_html($excerpt) . '</p>';
                    $output .= '</div>';
                }
                // End Excerpt

                // Button Output                
                if ($showReadMoreButton) {
                    // Button wrapper styles
                    $buttonWrapperStyle = '';

                    // Margin
                    if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                        $buttonWrapperStyle .= 'margin: ' .
                            (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                            (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                            (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                            (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                    }

                    // Order
                    if (!empty($buttonOrder)) {
                        $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                    }

                   
                    $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                    // Button inline styles
                    $buttonInlineStyles = '';

                    if (!empty($buttonTextColor)) {
                        $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                    }
                    if (!empty($buttonBackgroundColor)) {
                        $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                    }
                    
                    if (!empty($buttonFontSize)) {
                        $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                    }
                    if (!empty($buttonFontWeight)) {
                        $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                    }
                    if (!empty($buttonBorderColor)) {
                        $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                    }
                    if (!empty($buttonBorderType)) {
                        $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                    }

                    // Border width
                    
                    if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                        $buttonInlineStyles .= 'border-width: ' .
                            (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                            (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                            (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                            (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                    }
                    if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                        $buttonInlineStyles .= 'border-radius: ' .
                            (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                            (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                            (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                            (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                    }
                    if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                        $buttonInlineStyles .= 'padding: ' .
                            (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                            (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                            (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                            (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                    }

                    // Hover styles
                    $buttonHoverInlineStyles = '';
                    $buttonResetStyles = '';

                    if (!empty($buttonHoverTextColor)) {
                        $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                        $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                    }
                    if (!empty($buttonHoverBorderColor)) {
                        $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                        $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                    }
                    if (!empty($buttonHoverBackgroundColor)) {
                        $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                        $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                    }

                    // Button anchor tag
                    $output .= '<a class="rs-link read-more ' . esc_attr($buttonStyle1) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                    if (!empty($buttonHoverInlineStyles)) {
                        $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                    }

                    if (!empty($buttonResetStyles)) {
                        $output .= ' onmouseout="' . $buttonResetStyles . '"';
                    }

                    $output .= '>';

                    // Icon handling
                    $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                    $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                    $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                    if ($iconPosition === 'left' && $showButtonIcon) {
                        $output .= $leftIcon . ' ';
                    }

                    $output .= esc_html($readMoreLabel);

                    if ($iconPosition === 'right' && $showButtonIcon) {
                        $output .= ' ' . $rightIcon;
                    }

                    $output .= '</a></div>';
                }
                // End Button

                $output .= '</div>';
                // End MAIN Content
                $output .= '</div>';
                // End Full post layout
            }
            else if ($gridLayoutStyle === 'style2') {
                // Full post layout
                
                $output .= '<div class="rs-blog__single align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                    // MARGIN    
                    if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                        $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'margin: 40px 0px 0px 0px;';
                    }

                    // Padding
                    if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                            (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                            (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                            (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                    }

                    // Border Radius
                    if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' . 
                            (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                            (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                            (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                            (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                    }

                    // Border Width
                    if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' . 
                            (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                            (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                            (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                            (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                    }

                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                        $output .= 'box-shadow: ' . 
                            (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                            (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                            (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                            (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                            esc_attr($itemBoxShadowColor) . '; ';
                    }

                $output .= '">';

                // MAIN Content
                $output .= '<div class="rs-content" style="';
                    // Margin
                    if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                        $output .= 'margin: ' .
                            (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                            (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                            (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                            (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                    }
                    // Padding
                    if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                        $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'padding: 30px;';
                    }
                    // Check if at least one side is not empty
                    if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                            (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                            (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                            (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';

                // Meta Data
                if ($showMetaData) {
                    $output .= '<ul class="meta-data-list align-' . $metaAlignment . ' " style="';  
                        // Margin
                        if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                            $output .= 'margin: ' .
                                (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                        }
                        // Padding
                        if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                            $output .= 'padding: ' .
                                (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                        }   
                        
                        // Color
                        if (!empty($metaTextColor)) {
                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                        }
                        // Order
                        if (!empty($metaOrder)) {
                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                        }
                    $output .= '">';

                    $meta_items = [];

                    // Date
                    if ($showPostDate) {
                        $meta = '<li class="meta-date" style="';

                        // Color
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        // Font size
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        // Icon
                        if ($showPostDateIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-calendar-alt" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($getdate) . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Author
                    if ($showPostAuthor) {
                        $meta = '<li class="meta-author" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostAuthorIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-user" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Category
                    if ($showPostCategory) {
                        $meta = '<li class="meta-categories" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCategoryIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-folder" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        // Get category names without links
                        $categories_list = get_the_category($post_id);
                        if (!empty($categories_list)) {
                            $category_names = array();
                            foreach ($categories_list as $category) {
                                $category_names[] = esc_html($category->name);
                            }
                            $meta .= implode(', ', $category_names); // comma-separated plain text categories
                        }

                        $meta .= '</li>';
                        $meta_items[] = $meta;
                    }
                    // Tags
                    if ($showPostTags && !empty($tags)) {
                        $meta = '<li class="meta-tags" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostTagsIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-tags" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Comment Count
                    if ($showPostCommentsCount) {
                        $meta = '<li class="meta-comment-count" style="';
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCommentsCountIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-comments" style="';
                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }
                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Now join meta items with the separator
                    if (!empty($meta_items)) {
                        $separator = '';

                        if ($metaSeperator !== '') {
                            $separator = '';
                            if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                $separatorStyle = '';
                                if (!empty($separatorColor)) {
                                    $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                            }
                        }

                        $output .= implode($separator, $meta_items);
                    }
                    $output .= '</ul>'; // Close meta-data-list               
                }
                // End Meta Data

                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }
                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }
                    // Margin
                    if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .
                            (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                            (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                            (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                            (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                    }
                    // Padding
                    if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                            (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                            (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                            (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                    }
                    // Class name
                    $classNames = 'title' 
                        . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                        . ' align-' . esc_attr($postTitleAlignment);
                    // Hover JS (conditionally included)
                    $onmouseover = !empty($postTitleHoverBgColor) 
                        ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                        : '';
                    $onmouseout = !empty($postTitleBgColor) 
                        ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                        : '';
                    // Final output
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                        . $onmouseover 
                        . $onmouseout 
                        . '>';

                    $style = '';
                    $hoverStyle = '';
                    $mouseoutStyle = '';

                    // Build inline styles conditionally
                    if (!empty($postTitleFontSize)) {
                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                    }
                    if (!empty($postTitleLineHeight)) {
                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                    }
                    if (!empty($postTitleLetterSpacing)) {
                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                    }
                    if (!empty($postTitleFontWeight)) {
                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                    }
                    if (!empty($postTitleColor)) {
                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        if ($titleHoverUnderLine === 'enable') {
                            $style .= 'background-image: linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%); ';
                            $style .= 'background-position: 0 100%; ';
                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                        }
                    }
                    // Build hover color style if set
                    if (!empty($postTitleHoverColor)) {
                        $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        if ($titleHoverUnderLine === 'enable') {
                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                        }

                    }
                    // Final output
                    $output .= '<a href="' . esc_url($permalink) . '" 
                        style="' . esc_attr(trim($style)) . '"'
                        . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                        . esc_html($croppedTitle) . '</a>';    
                    $output .= '</' . esc_attr($titleTag) . '>';
                }

                // Excerpt
                if ($showPostExcerpt) {
                    $excerptStyles = '';

                    // Order
                    if (!empty($excerptOrder)) {
                        $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                    }

                    // Typography
                    if (!empty($excerptFontSize)) {
                        $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                    }

                    if (!empty($excerptLineHeight)) {
                        $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                    }

                    if (!empty($excerptLetterSpacing)) {
                        $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                    }

                    if (!empty($excerptFontWeight)) {
                        $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                    }

                    if (!empty($excerptColor)) {
                        $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                    }

                    if (!empty($excerptBgColor)) {
                        $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                    }

                    if (!empty($excerptBorderType)) {
                        $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                    }

                    // Margin
                    if (!empty($excerptMargin['top']) || !empty($excerptMargin['right']) || !empty($excerptMargin['bottom']) || !empty($excerptMargin['left'])) {
                        $excerptStyles .= 'margin: ' .
                            (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) . ' ' .
                            (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) . ' ' .
                            (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) . ' ' .
                            (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($excerptPadding['top']) || !empty($excerptPadding['right']) || !empty($excerptPadding['bottom']) || !empty($excerptPadding['left'])) {
                        $excerptStyles .= 'padding: ' .
                            (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) . ' ' .
                            (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) . ' ' .
                            (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) . ' ' .
                            (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) . '; ';
                    }

                    // Handle hover logic conditionally
                    $hoverIn = '';
                    $hoverOut = '';

                    if (!empty($excerptHoverColor)) {
                        $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                        $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                    }

                    if (!empty($excerptHoverBgColor)) {
                        $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                        $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                    }

                    if (!empty($excerptHoverBorderColor)) {
                        $hoverIn .= 'this.style.borderColor=\'' . esc_attr($excerptHoverBorderColor) . '\';';
                        $hoverOut .= 'this.style.borderColor=\'inherit\';';
                    }

                    $output .= '<div class="fpg-excerpt' . ' align-' . esc_attr($excerptAlignment) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                    if (!empty($hoverIn) || !empty($hoverOut)) {
                        $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                        $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                    }

                    $output .= '>';
                    $output .= '<p>' . esc_html($excerpt) . '</p>';
                    $output .= '</div>';
                }
                // End Excerpt

                // Button Output                
                if ($showReadMoreButton) {
                    // Button wrapper styles
                    $buttonWrapperStyle = '';

                    // Margin
                    if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                        $buttonWrapperStyle .= 'margin: ' .
                            (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                            (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                            (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                            (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                    }

                    // Order
                    if (!empty($buttonOrder)) {
                        $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                    }

                   
                    $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                    // Button inline styles
                    $buttonInlineStyles = '';

                    if (!empty($buttonTextColor)) {
                        $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                    }
                    if (!empty($buttonBackgroundColor)) {
                        $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                    }
                    if (!empty($buttonFontSize)) {
                        $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                    }
                    if (!empty($buttonFontWeight)) {
                        $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                    }
                    if (!empty($buttonBorderColor)) {
                        $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                    }
                    if (!empty($buttonBorderType)) {
                        $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                    }

                    // Border width
                    
                    if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                        $buttonInlineStyles .= 'border-width: ' .
                            (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                            (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                            (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                            (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                    }
                    if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                        $buttonInlineStyles .= 'border-radius: ' .
                            (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                            (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                            (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                            (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                    }
                    if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                        $buttonInlineStyles .= 'padding: ' .
                            (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                            (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                            (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                            (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                    }

                    // Hover styles
                    $buttonHoverInlineStyles = '';
                    $buttonResetStyles = '';

                    if (!empty($buttonHoverTextColor)) {
                        $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                        $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                    }
                    if (!empty($buttonHoverBorderColor)) {
                        $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                        $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                    }
                    if (!empty($buttonHoverBackgroundColor)) {
                        $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                        $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                    }

                    // Button anchor tag
                    $output .= '<a class="rs-link read-more ' . esc_attr($buttonStyle2) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                    if (!empty($buttonHoverInlineStyles)) {
                        $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                    }

                    if (!empty($buttonResetStyles)) {
                        $output .= ' onmouseout="' . $buttonResetStyles . '"';
                    }

                    $output .= '>';

                    // Icon handling
                    $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                    $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                    $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                    if ($iconPosition === 'left' && $showButtonIcon) {
                        $output .= $leftIcon . ' ';
                    }

                    $output .= esc_html($readMoreLabel);

                    if ($iconPosition === 'right' && $showButtonIcon) {
                        $output .= ' ' . $rightIcon;
                    }

                    $output .= '</a></div>';
                }
                // End Button

                $output .= '</div>';
                // Thumbnail
                if ($thumbnail && $showThumbnail) {
                    $output .= '<div class="rs-thumb" style="';

                    // Margin
                    if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                        $output .= 'margin: ' . 
                            (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                            (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                            (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                            (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                            (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                            (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                            (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                    }
                    if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                        $output .= ' border-radius: ' .
                            (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                    }

                    $output .= '">';

                    // Anchor with optional border-radius and overflow
                    if ($thumbnailLink) {
                        $output .= '<a href="' . esc_url($permalink) . '">';
                        $output .= $thumbnail;
                        $output .= '</a>';
                    } else {
                        $output .= $thumbnail;
                    }
                    $output .= '</div>';
                }
                // END Thumbnail
                // End MAIN Content
                $output .= '</div>';
                // End Full post layout
            }
            
            else if ($gridLayoutStyle === 'style3') {
                // Full post layout
            
                $output .= '<div class="rs-blog-layout-28-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                    // MARGIN    
                    if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                        $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'margin: 40px 0px 0px 0px;';
                    }

                    // Padding
                    if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                            (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                            (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                            (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                    }

                    // Border Radius
                    if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' . 
                            (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                            (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                            (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                            (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                    }

                    // Border Width
                    if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' . 
                            (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                            (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                            (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                            (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                    }

                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                        $output .= 'box-shadow: ' . 
                            (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                            (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                            (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                            (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                            esc_attr($itemBoxShadowColor) . '; ';
                    }

                $output .= '">';

                    // Thumbnail
                    if ($thumbnail && $showThumbnail) {

                        $output .= '<div class="rs-thumb" style="';
                            // Margin
                            if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                                $output .= 'margin: ' . 
                                    (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                                    (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                                    (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                                    (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                            }

                            // Padding
                            if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                                $output .= 'padding: ' . 
                                    (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                                    (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                                    (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                                    (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                            }
                            if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                                $output .= ' border-radius: ' .
                                    (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                                    (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                                    (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                                    (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                            }

                        $output .= '">';
                        

                        // Anchor with optional border-radius and overflow
                        if ($thumbnailLink) {
                            $output .= '<a href="' . esc_url($permalink) . '">';
                            $output .= $thumbnail;
                            $output .= '</a>';
                        } else {
                            $output .= $thumbnail;
                        }
                    

                        // Now Insert Meta Data inside the Thumbnail
                        if ($showMetaData) {
                            // $output .= '<div class="rs-meta align-' . $metaAlignment . '">';
                            $output .= '<div class="rs-meta align-' . esc_attr($metaAlignment) . '"';

                            $metaStyle = '';
                            if (!empty($metaBgColor)) {
                                $metaStyle .= 'background-color: ' . esc_attr($metaBgColor) . '; ';
                            }

                            if (!empty($metaStyle)) {
                                $output .= ' style="' . trim($metaStyle) . '"';
                            }

                            $output .= '>';
                                $output .= '<ul class="meta-data-list " style="';  
                                    // Margin
                                    if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                                        $output .= 'margin: ' .
                                            (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                            (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                            (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                            (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                                    }
                                    // Padding
                                    if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                                        $output .= 'padding: ' .
                                            (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                            (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                            (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                            (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                                    }   
                                    
                                    // Color
                                    if (!empty($metaTextColor)) {
                                        $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                    }
                                    // Order
                                    if (!empty($metaOrder)) {
                                        $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                    }
                                $output .= '">';

                                    $meta_items = [];

                                    // Date
                                    if ($showPostDate) {
                                        $meta = '<li class="meta-date" style="';

                                        // Color
                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        // Font size
                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        // Icon
                                        if ($showPostDateIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-calendar-alt" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html($getdate) . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    // Author
                                    if ($showPostAuthor) {
                                        $meta = '<li class="meta-author" style="';

                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        if ($showPostAuthorIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-user" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    // Category
                                    if ($showPostCategory) {
                                        $meta = '<li class="meta-categories" style="';

                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        if ($showPostCategoryIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-folder" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        // Get category names without links
                                        $categories_list = get_the_category($post_id);
                                        if (!empty($categories_list)) {
                                            $category_names = array();
                                            foreach ($categories_list as $category) {
                                                $category_names[] = esc_html($category->name);
                                            }
                                            $meta .= implode(', ', $category_names); // comma-separated plain text categories
                                        }

                                        $meta .= '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    // Tags
                                    if ($showPostTags && !empty($tags)) {
                                        $meta = '<li class="meta-tags" style="';

                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        if ($showPostTagsIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-tags" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    // Comment Count
                                    if ($showPostCommentsCount) {
                                        $meta = '<li class="meta-comment-count" style="';
                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }
                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        if ($showPostCommentsCountIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-comments" style="';
                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }
                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }
                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    // Now join meta items with the separator
                                    if (!empty($meta_items)) {
                                        $separator = '';

                                        if ($metaSeperator !== '') {
                                            $separator = '';
                                            if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                                $separatorStyle = '';
                                                if (!empty($separatorColor)) {
                                                    $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                                }
                                                if (!empty($metaFontSize)) {
                                                    $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                                }

                                                $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                                            }
                                        }

                                        $output .= implode($separator, $meta_items);
                                    }
                                $output .= '</ul>'; // ul Close 
                            $output .= '</div>'; // Close meta-data-list
                        }

                        $output .= '</div>'; // Close fancy-post-image rs-thumb
                    }

                // MAIN Content
                $output .= '<div class="rs-content" style="';
                    // Margin
                    if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                        $output .= 'margin: ' .
                            (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                            (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                            (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                            (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                    }
                    // Padding
                    if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                        $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'padding: 20px 30px 30px 30px;';
                    }
                    // Check if at least one side is not empty
                    if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                            (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                            (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                            (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';
                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }
                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }
                    // Margin
                    if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .
                            (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                            (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                            (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                            (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                    }
                    // Padding
                    if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                            (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                            (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                            (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                    }
                    // Class name
                    $classNames = 'title' 
                        . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                        . ' align-' . esc_attr($postTitleAlignment);
                    // Hover JS (conditionally included)
                    $onmouseover = !empty($postTitleHoverBgColor) 
                        ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                        : '';
                    $onmouseout = !empty($postTitleBgColor) 
                        ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                        : '';
                    // Final output
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                        . $onmouseover 
                        . $onmouseout 
                        . '>';

                    $style = '';
                    $hoverStyle = '';
                    $mouseoutStyle = '';

                    // Build inline styles conditionally
                    if (!empty($postTitleFontSize)) {
                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                    }
                    if (!empty($postTitleLineHeight)) {
                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                    }
                    if (!empty($postTitleLetterSpacing)) {
                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                    }
                    if (!empty($postTitleFontWeight)) {
                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                    }
                    if (!empty($postTitleColor)) {
                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        if ($titleHoverUnderLine === 'enable') {
                            $style .= 'background-image: linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%); ';
                            $style .= 'background-position: 0 100%; ';
                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                        }
                    }
                    // Build hover color style if set
                    if (!empty($postTitleHoverColor)) {
                        $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        if ($titleHoverUnderLine === 'enable') {
                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                        }
                    }
                    // Final output
                    $output .= '<a href="' . esc_url($permalink) . '" 
                        style="' . esc_attr(trim($style)) . '"'
                        . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                        . esc_html($croppedTitle) . '</a>';    
                    $output .= '</' . esc_attr($titleTag) . '>';
                }

                // Excerpt
                if ($showPostExcerpt) {
                    $excerptStyles = '';

                    // Order
                    if (!empty($excerptOrder)) {
                        $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                    }

                    // Typography
                    if (!empty($excerptFontSize)) {
                        $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                    }

                    if (!empty($excerptLineHeight)) {
                        $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                    }

                    if (!empty($excerptLetterSpacing)) {
                        $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                    }

                    if (!empty($excerptFontWeight)) {
                        $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                    }

                    if (!empty($excerptColor)) {
                        $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                    }

                    if (!empty($excerptBgColor)) {
                        $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                    }

                    if (!empty($excerptBorderType)) {
                        $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                    }

                    // Margin
                    if (!empty($excerptMargin['top']) || !empty($excerptMargin['right']) || !empty($excerptMargin['bottom']) || !empty($excerptMargin['left'])) {
                        $excerptStyles .= 'margin: ' .
                            (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) . ' ' .
                            (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) . ' ' .
                            (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) . ' ' .
                            (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($excerptPadding['top']) || !empty($excerptPadding['right']) || !empty($excerptPadding['bottom']) || !empty($excerptPadding['left'])) {
                        $excerptStyles .= 'padding: ' .
                            (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) . ' ' .
                            (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) . ' ' .
                            (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) . ' ' .
                            (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) . '; ';
                    }

                    // Handle hover logic conditionally
                    $hoverIn = '';
                    $hoverOut = '';

                    if (!empty($excerptHoverColor)) {
                        $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                        $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                    }

                    if (!empty($excerptHoverBgColor)) {
                        $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                        $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                    }

                    if (!empty($excerptHoverBorderColor)) {
                        $hoverIn .= 'this.style.borderColor=\'' . esc_attr($excerptHoverBorderColor) . '\';';
                        $hoverOut .= 'this.style.borderColor=\'inherit\';';
                    }

                    $output .= '<div class="fpg-excerpt' . ' align-' . esc_attr($excerptAlignment) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                    if (!empty($hoverIn) || !empty($hoverOut)) {
                        $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                        $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                    }

                    $output .= '>';
                    $output .= '<p>' . esc_html($excerpt) . '</p>';
                    $output .= '</div>';
                }
                // End Excerpt
                
                // Button Output                
                if ($showReadMoreButton) {
                    // Button wrapper styles
                    $buttonWrapperStyle = '';

                    // Margin
                    if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                        $buttonWrapperStyle .= 'margin: ' .
                            (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                            (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                            (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                            (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                    }

                    // Order
                    if (!empty($buttonOrder)) {
                        $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                    }

                   
                    $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                    // Button inline styles
                    $buttonInlineStyles = '';

                    if (!empty($buttonTextColor)) {
                        $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                    }
                    if (!empty($buttonBackgroundColor)) {
                        $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                    }
                    if (!empty($buttonFontSize)) {
                        $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                    }
                    if (!empty($buttonFontWeight)) {
                        $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                    }
                    if (!empty($buttonBorderColor)) {
                        $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                    }
                    if (!empty($buttonBorderType)) {
                        $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                    }

                    // Border width
                    
                    if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                        $buttonInlineStyles .= 'border-width: ' .
                            (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                            (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                            (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                            (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                    }
                    if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                        $buttonInlineStyles .= 'border-radius: ' .
                            (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                            (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                            (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                            (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                    }
                    if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                        $buttonInlineStyles .= 'padding: ' .
                            (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                            (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                            (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                            (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                    }

                    // Hover styles
                    $buttonHoverInlineStyles = '';
                    $buttonResetStyles = '';

                    if (!empty($buttonHoverTextColor)) {
                        $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                        $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                    }
                    if (!empty($buttonHoverBorderColor)) {
                        $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                        $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                    }
                    if (!empty($buttonHoverBackgroundColor)) {
                        $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                        $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                    }

                    // Button anchor tag
                    $output .= '<a class="rs-btn read-more ' . esc_attr($buttonStyle3) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                    if (!empty($buttonHoverInlineStyles)) {
                        $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                    }

                    if (!empty($buttonResetStyles)) {
                        $output .= ' onmouseout="' . $buttonResetStyles . '"';
                    }

                    $output .= '>';

                    // Icon handling
                    $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                    $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                    $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                    if ($iconPosition === 'left' && $showButtonIcon) {
                        $output .= $leftIcon . ' ';
                    }

                    $output .= esc_html($readMoreLabel);

                    if ($iconPosition === 'right' && $showButtonIcon) {
                        $output .= ' ' . $rightIcon;
                    }

                    $output .= '</a></div>';
                }
                // End Button

                $output .= '</div>';
                // End MAIN Content
                $output .= '</div>';
                // End Full post layout
            }
            else if ($gridLayoutStyle === 'style4') {
                // Full post layout
                $output .= '<div class="rs-blog-layout-30-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                    // MARGIN    
                    if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                        $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'margin: 40px 0px 0px 0px;';
                    }

                    if ( !empty($itemPadding['top']) || !empty($itemPadding['right']) ||  !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                        $output .= 'margin: ' .(isset($itemPadding['top']) && $itemPadding['top'] !== '' ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' . (isset($itemPadding['right']) && $itemPadding['right'] !== '' ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' . (isset($itemPadding['bottom']) && $itemPadding['bottom'] !== '' ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' . (isset($itemPadding['left']) && $itemPadding['left'] !== '' ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'padding: 20px 20px 15px 20px;';
                    }
                    // Padding
                    if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                            (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                            (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                            (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                    }

                    // Border Radius
                    if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' . 
                            (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                            (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                            (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                            (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                    }

                    // Border Width
                    if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' . 
                            (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                            (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                            (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                            (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                    }

                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                        $output .= 'box-shadow: ' . 
                            (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                            (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                            (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                            (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                            esc_attr($itemBoxShadowColor) . '; ';
                    }

                $output .= '">';
                
                // Thumbnail
                if ($thumbnail && $showThumbnail) {
                    $output .= '<div class="rs-thumb" style="';

                        // Margin
                        if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                            $output .= 'margin: ' . 
                                (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                                (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                                (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                                (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                        }

                        // Padding
                        if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                            $output .= 'padding: ' . 
                                (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                                (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                                (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                                (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                        }
                        if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                            $output .= ' border-radius: ' .
                                (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                                (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                                (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                                (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                        }

                        $output .= '">';

                        // Anchor with optional border-radius and overflow
                        if ($thumbnailLink) {
                            $output .= '<a href="' . esc_url($permalink) . '">';
                            $output .= $thumbnail;
                            $output .= '</a>';
                        } else {
                            $output .= $thumbnail;
                        }
                    

                        // Date
                        if ($showPostDate) {
                            // Build dynamic style for the container
                            $style = '';
                            if (!empty($metaTextColor)) {
                                $style .= 'color:' . esc_attr($metaTextColor) . ';';
                            }
                            if (!empty($metaFontSize)) {
                                $style .= 'font-size:' . esc_attr($metaFontSize) . 'px;';
                            }

                            $output .= '<div class="meta-date" style="' . $style . '">';
                            $output .= '<span>';

                            // Build dynamic style for the icon
                            $iconStyle = '';
                            if (!empty($metaIconColor)) {
                                $iconStyle .= 'color:' . esc_attr($metaIconColor) . ';';
                            }
                            if (!empty($metaFontSize)) {
                                $iconStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px;';
                            }

                            if ($showPostDateIcon && $showMetaIcon) {
                                $output .= '<i class="fas fa-calendar-alt" style="' . $iconStyle . '"></i> ';
                            }

                            $output .= esc_html($getdate);
                            $output .= '</span>';
                            $output .= '</div>';
                        }

                        $output .= '</div>'; // Close fancy-post-image rs-thumb
                    }

                // MAIN Content
                $output .= '<div class="rs-content" style="';
                    // Margin
                    if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                        $output .= 'margin: ' .
                            (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                            (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                            (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                            (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                    }
                    // Padding
                    if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                        $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'padding: 20px 0px 20px 0px;';
                    }
                    // Check if at least one side is not empty
                    if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                            (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                            (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                            (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';

                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }
                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }
                    // Margin
                    if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .
                            (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                            (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                            (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                            (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                    }
                    // Padding
                    if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                            (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                            (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                            (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                    }
                    // Class name
                    $classNames = 'title' 
                        . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                        . ' align-' . esc_attr($postTitleAlignment);
                    // Hover JS (conditionally included)
                    $onmouseover = !empty($postTitleHoverBgColor) 
                        ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                        : '';
                    $onmouseout = !empty($postTitleBgColor) 
                        ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                        : '';
                    // Final output
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                        . $onmouseover 
                        . $onmouseout 
                        . '>';

                    $style = '';
                    $hoverStyle = '';
                    $mouseoutStyle = '';

                    // Build inline styles conditionally
                    if (!empty($postTitleFontSize)) {
                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                    }
                    if (!empty($postTitleLineHeight)) {
                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                    }
                    if (!empty($postTitleLetterSpacing)) {
                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                    }
                    if (!empty($postTitleFontWeight)) {
                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                    }
                    if (!empty($postTitleColor)) {
                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        if ($titleHoverUnderLine === 'enable') {
                            $style .= 'background-image: linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%); ';
                            $style .= 'background-position: 0 100%; ';
                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                        }
                    }
                    // Build hover color style if set
                    if (!empty($postTitleHoverColor)) {
                        $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        if ($titleHoverUnderLine === 'enable') {
                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                        }
                    }
                    // Final output
                    $output .= '<a href="' . esc_url($permalink) . '" 
                        style="' . esc_attr(trim($style)) . '"'
                        . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                        . esc_html($croppedTitle) . '</a>';    
                    $output .= '</' . esc_attr($titleTag) . '>';
                }
                // Now Insert Meta Data inside the Thumbnail
                if ($showMetaData) {
                    $output .= '<div class="rs-meta align-' . $metaAlignment . '">';
                    $output .= '<ul class="meta-data-list" style="';  
                        // Margin
                        if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                            $output .= 'margin: ' .
                                (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                        }
                        // Padding
                        if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                            $output .= 'padding: ' .
                                (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                        }   
                        
                        // Color
                        if (!empty($metaTextColor)) {
                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                        }
                        // Order
                        if (!empty($metaOrder)) {
                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                        }
                    $output .= '">';

                    $meta_items = [];

                    // Author
                    if ($showPostAuthor) {
                        $meta = '<li class="meta-author" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostAuthorIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-user" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Category
                    if ($showPostCategory) {
                        $meta = '<li class="meta-categories" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCategoryIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-folder" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        // Get category names without links
                        $categories_list = get_the_category($post_id);
                        if (!empty($categories_list)) {
                            $category_names = array();
                            foreach ($categories_list as $category) {
                                $category_names[] = esc_html($category->name);
                            }
                            $meta .= implode(', ', $category_names); // comma-separated plain text categories
                        }

                        $meta .= '</li>';
                        $meta_items[] = $meta;
                    }
                    // Tags
                    if ($showPostTags && !empty($tags)) {
                        $meta = '<li class="meta-tags" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostTagsIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-tags" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Comment Count
                    if ($showPostCommentsCount) {
                        $meta = '<li class="meta-comment-count" style="';
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCommentsCountIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-comments" style="';
                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }
                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Now join meta items with the separator
                    if (!empty($meta_items)) {
                        $separator = '';

                        if ($metaSeperator !== '') {
                            $separator = '';
                            if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                $separatorStyle = '';
                                if (!empty($separatorColor)) {
                                    $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                            }
                        }

                        $output .= implode($separator, $meta_items);
                    }
                    $output .= '</ul>'; // Close meta-data-list
                    $output .= '</div>'; // Close meta-data-list
                }
                // Excerpt
                if ($showPostExcerpt) {
                    $excerptStyles = '';
                    $excerptColorStyles = '';

                    // Order
                    if (!empty($excerptOrder)) {
                        $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                    }

                    // Typography
                    if (!empty($excerptFontSize)) {
                        $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                    }

                    if (!empty($excerptLineHeight)) {
                        $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                    }

                    if (!empty($excerptLetterSpacing)) {
                        $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                    }

                    if (!empty($excerptFontWeight)) {
                        $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                    }

                    if (!empty($excerptColor)) {
                        $excerptColorStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                    }

                    if (!empty($excerptBgColor)) {
                        $excerptColorStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                    }

                    if (!empty($excerptBorderType)) {
                        $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                    }

                    // Margin
                    if (!empty($excerptMargin['top']) || !empty($excerptMargin['right']) || !empty($excerptMargin['bottom']) || !empty($excerptMargin['left'])) {
                        $excerptStyles .= 'margin: ' .
                            (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) . ' ' .
                            (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) . ' ' .
                            (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) . ' ' .
                            (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($excerptPadding['top']) || !empty($excerptPadding['right']) || !empty($excerptPadding['bottom']) || !empty($excerptPadding['left'])) {
                        $excerptStyles .= 'padding: ' .
                            (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) . ' ' .
                            (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) . ' ' .
                            (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) . ' ' .
                            (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) . '; ';
                    }

                    // Handle hover logic conditionally
                    $hoverIn = '';
                    $hoverOut = '';

                    if (!empty($excerptHoverColor)) {
                        $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                        $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                    }

                    if (!empty($excerptHoverBgColor)) {
                        $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                        $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                    }

                    if (!empty($excerptHoverBorderColor)) {
                        $hoverIn .= 'this.style.borderColor=\'' . esc_attr($excerptHoverBorderColor) . '\';';
                        $hoverOut .= 'this.style.borderColor=\'inherit\';';
                    }

                    $output .= '<div class="fpg-excerpt' . ' align-' . esc_attr($excerptAlignment) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                    $output .= '>';
                    $output .= '<p style="' . esc_attr(trim($excerptColorStyles)) . '"';

                        if (!empty($hoverIn) || !empty($hoverOut)) {
                            if (!empty($hoverIn)) {
                                $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                            }
                            if (!empty($hoverOut)) {
                                $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                            }
                        }

                        $output .= '>' . esc_html($excerpt) . '</p>';
                    $output .= '</div>';
                }
                // End Excerpt

                $output .= '</div>';
                // End MAIN Content
                $output .= '</div>';
                // End Full post layout
            }
            elseif ($gridLayoutStyle === 'style5') {
                // Full post layout
                $output .= '<div class="pre-blog-item style_12 pre-blog-meta-style2 default">';
                $output .= '<div class="blog-inner-wrap pre-thum-default pre-meta-blocks top align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                    // MARGIN    
                    if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                        $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'margin: 0px 0px 0px 0px;';
                    }

                    // Padding
                    if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                            (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                            (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                            (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                    }

                    // Border Radius
                    if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' . 
                            (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                            (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                            (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                            (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                    }

                    // Border Width
                    if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' . 
                            (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                            (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                            (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                            (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                    }

                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                        $output .= 'box-shadow: ' . 
                            (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                            (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                            (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                            (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                            esc_attr($itemBoxShadowColor) . '; ';
                    }

                $output .= '">';    
                // Thumbnail
                if ($thumbnail && $showThumbnail) {
                    $output .= '<div class="pre-image-wrap" style="';

                    // Margin
                    if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                        $output .= 'margin: ' . 
                            (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                            (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                            (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                            (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                            (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                            (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                            (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                    }
                    if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                        $output .= ' border-radius: ' .
                            (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                    }

                    $output .= '">';

                    // Anchor with optional border-radius and overflow
                    if ($thumbnailLink) {
                        $output .= '<a href="' . esc_url($permalink) . '">';
                        $output .= $thumbnail;
                        $output .= '</a>';
                    } else {
                        $output .= $thumbnail;
                    }
                    
                    if ($showPostDate) {
                        $output .= '<div class="pre-blog-meta" style="color:' . esc_attr($metaTextColor) . '; ">';
                        
                        $output .= '<span class="pre-date">' . esc_html(get_the_date('d')) . '</span>';
                        $output .= '<span class="pre-month"> ' . esc_html(get_the_date('F')) . '</span>'; 
                        $output .= '</div>';
                    }
                    $output .= '</div>';
                }
                
                // MAIN Content
                $output .= '<div class="pre-blog-content" style="';
                    // Margin
                    if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                        $output .= 'margin: ' .
                            (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                            (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                            (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                            (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                    }
                    // Padding
                    if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                        $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'padding: 75px 20px 25px 20px;';
                    }
                    // Check if at least one side is not empty
                    if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                            (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                            (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                            (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';

                // Meta Data
                if ($showMetaData) {
                    $output .= '<ul class="meta-data-list align-' . $metaAlignment . ' " style="';  
                        // Margin
                        if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                            $output .= 'margin: ' .
                                (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                        }
                        // Padding
                        if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                            $output .= 'padding: ' .
                                (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                        }   
                        
                        // Color
                        if (!empty($metaTextColor)) {
                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                        }
                        // Order
                        if (!empty($metaOrder)) {
                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                        }
                    $output .= '">';

                    $meta_items = [];

                    // Author
                    if ($showPostAuthor) {
                        $meta = '<li class="meta-author" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostAuthorIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-user" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Category
                    if ($showPostCategory) {
                        $meta = '<li class="meta-categories" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCategoryIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-folder" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        // Get category names without links
                        $categories_list = get_the_category($post_id);
                        if (!empty($categories_list)) {
                            $category_names = array();
                            foreach ($categories_list as $category) {
                                $category_names[] = esc_html($category->name);
                            }
                            $meta .= implode(', ', $category_names); // comma-separated plain text categories
                        }

                        $meta .= '</li>';
                        $meta_items[] = $meta;
                    }
                    // Tags
                    if ($showPostTags && !empty($tags)) {
                        $meta = '<li class="meta-tags" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostTagsIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-tags" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Comment Count
                    if ($showPostCommentsCount) {
                        $meta = '<li class="meta-comment-count" style="';
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCommentsCountIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-comments" style="';
                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }
                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Now join meta items with the separator
                    if (!empty($meta_items)) {
                        $separator = '';

                        if ($metaSeperator !== '') {
                            $separator = '';
                            if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                $separatorStyle = '';
                                if (!empty($separatorColor)) {
                                    $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                            }
                        }

                        $output .= implode($separator, $meta_items);
                    }
                    $output .= '</ul>'; // Close meta-data-list               
                }
                // End Meta Data

                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }
                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }
                    // Margin
                    
                    if ( !empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) ||  !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .(isset($postTitleMargin['top']) && $postTitleMargin['top'] !== '' ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' . (isset($postTitleMargin['right']) && $postTitleMargin['right'] !== '' ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' . (isset($postTitleMargin['bottom']) && $postTitleMargin['bottom'] !== '' ? (is_numeric($postTitleMargin['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' . (isset($postTitleMargin['left']) && $postTitleMargin['left'] !== '' ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $titleStyles .= 'margin: 0px 0px 28px 0px;';
                    }
                    // Padding
                    if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                            (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                            (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                            (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                    }
                    // Class name
                    $classNames = 'pre-post-title' 
                        . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                        . ' align-' . esc_attr($postTitleAlignment);
                    // Hover JS (conditionally included)
                    $onmouseover = !empty($postTitleHoverBgColor) 
                        ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                        : '';
                    $onmouseout = !empty($postTitleBgColor) 
                        ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                        : '';
                    // Final output
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                        . $onmouseover 
                        . $onmouseout 
                        . '>';

                    $style = '';
                    $hoverStyle = '';
                    $mouseoutStyle = '';

                    // Build inline styles conditionally
                    if (!empty($postTitleFontSize)) {
                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                    }
                    if (!empty($postTitleLineHeight)) {
                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                    }
                    if (!empty($postTitleLetterSpacing)) {
                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                    }
                    if (!empty($postTitleFontWeight)) {
                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                    }
                    if (!empty($postTitleColor)) {
                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        if ($titleHoverUnderLine === 'enable') {
                            $style .= 'background-image: linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%); ';
                            $style .= 'background-position: 0 100%; ';
                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                        }
                    }
                    // Build hover color style if set
                    if (!empty($postTitleHoverColor)) {
                        $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        if ($titleHoverUnderLine === 'enable') {
                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                        }
                    }
                    // Final output
                    $output .= '<a href="' . esc_url($permalink) . '" 
                        style="' . esc_attr(trim($style)) . '"'
                        . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                        . esc_html($croppedTitle) . '</a>';    
                    $output .= '</' . esc_attr($titleTag) . '>';
                }

                // Excerpt
                if ($showPostExcerpt) {
                    $excerptStyles = '';

                    // Order
                    if (!empty($excerptOrder)) {
                        $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                    }

                    // Typography
                    if (!empty($excerptFontSize)) {
                        $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                    }

                    if (!empty($excerptLineHeight)) {
                        $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                    }

                    if (!empty($excerptLetterSpacing)) {
                        $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                    }

                    if (!empty($excerptFontWeight)) {
                        $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                    }

                    if (!empty($excerptColor)) {
                        $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                    }

                    if (!empty($excerptBgColor)) {
                        $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                    }

                    if (!empty($excerptBorderType)) {
                        $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                    }

                    // Margin
                    if (!empty($excerptMargin['top']) || !empty($excerptMargin['right']) || !empty($excerptMargin['bottom']) || !empty($excerptMargin['left'])) {
                        $excerptStyles .= 'margin: ' .
                            (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) . ' ' .
                            (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) . ' ' .
                            (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) . ' ' .
                            (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($excerptPadding['top']) || !empty($excerptPadding['right']) || !empty($excerptPadding['bottom']) || !empty($excerptPadding['left'])) {
                        $excerptStyles .= 'padding: ' .
                            (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) . ' ' .
                            (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) . ' ' .
                            (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) . ' ' .
                            (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) . '; ';
                    }

                    // Handle hover logic conditionally
                    $hoverIn = '';
                    $hoverOut = '';

                    if (!empty($excerptHoverColor)) {
                        $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                        $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                    }

                    if (!empty($excerptHoverBgColor)) {
                        $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                        $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                    }

                    if (!empty($excerptHoverBorderColor)) {
                        $hoverIn .= 'this.style.borderColor=\'' . esc_attr($excerptHoverBorderColor) . '\';';
                        $hoverOut .= 'this.style.borderColor=\'inherit\';';
                    }

                    $output .= '<div class="pre-content' . ' align-' . esc_attr($excerptAlignment) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                    if (!empty($hoverIn) || !empty($hoverOut)) {
                        $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                        $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                    }

                    $output .= '>';
                    $output .= '<p>' . esc_html($excerpt) . '</p>';
                    $output .= '</div>';
                }
                // End Excerpt
               
                // Button Output                
                if ($showReadMoreButton) {
                    // Button wrapper styles
                    $buttonWrapperStyle = '';

                    // Margin
                    if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                        $buttonWrapperStyle .= 'margin: ' .
                            (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                            (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                            (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                            (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                    }

                    // Order
                    if (!empty($buttonOrder)) {
                        $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                    }

                   
                    $output .= '<div class="blog-btn-part align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                    // Button inline styles
                    $buttonInlineStyles = '';

                    if (!empty($buttonTextColor)) {
                        $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                    }
                    if (!empty($buttonBackgroundColor)) {
                        $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                    }
                    if (!empty($buttonFontSize)) {
                        $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                    }
                    if (!empty($buttonFontWeight)) {
                        $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                    }
                    if (!empty($buttonBorderColor)) {
                        $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                    }
                    if (!empty($buttonBorderType)) {
                        $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                    }

                    // Border width
                    
                    if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                        $buttonInlineStyles .= 'border-width: ' .
                            (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                            (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                            (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                            (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                    }
                    if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                        $buttonInlineStyles .= 'border-radius: ' .
                            (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                            (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                            (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                            (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                    }
                    if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                        $buttonInlineStyles .= 'padding: ' .
                            (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                            (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                            (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                            (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                    }

                    // Hover styles
                    $buttonHoverInlineStyles = '';
                    $buttonResetStyles = '';

                    if (!empty($buttonHoverTextColor)) {
                        $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                        $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                    }
                    if (!empty($buttonHoverBorderColor)) {
                        $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                        $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                    }
                    if (!empty($buttonHoverBackgroundColor)) {
                        $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                        $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                    }

                    // Button anchor tag
                    $output .= '<a class="blog-btn icon-after read-more ' . esc_attr($buttonStyle5) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                    if (!empty($buttonHoverInlineStyles)) {
                        $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                    }

                    if (!empty($buttonResetStyles)) {
                        $output .= ' onmouseout="' . $buttonResetStyles . '"';
                    }

                    $output .= '>';

                    $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                    $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                    $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                    if ($iconPosition === 'left' && $showButtonIcon) {
                        $output .= $leftIcon . ' ';
                    }

                    $output .= esc_html($readMoreLabel);

                    if ($iconPosition === 'right' && $showButtonIcon) {
                        $output .= ' ' . $rightIcon;
                    }

                    $output .= '</a></div>';
                }
                // End Button

                $output .= '</div>';
                // End MAIN Content
                $output .= '</div>';
                $output .= '</div>';
                // End Full post layout
            } 
            elseif ($gridLayoutStyle === 'style6') {
                // Full post layout
                
                $output .= '<div class="rs-blog-layout-13-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                    // MARGIN    
                    if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                        $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'margin: 40px 0px 0px 0px;';
                    }

                    // Padding
                    if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                            (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                            (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                            (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                    }

                    // Border Radius
                    if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' . 
                            (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                            (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                            (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                            (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                    }

                    // Border Width
                    if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' . 
                            (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                            (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                            (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                            (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                    }

                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                        $output .= 'box-shadow: ' . 
                            (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                            (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                            (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                            (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                            esc_attr($itemBoxShadowColor) . '; ';
                    }

                $output .= '">';
                    // Thumbnail
                if ($thumbnail && $showThumbnail) {
                    $output .= '<div class="rs-thumb" style="';

                    // Margin
                    if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                        $output .= 'margin: ' . 
                            (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                            (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                            (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                            (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                            (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                            (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                            (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                    }
                    if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                        $output .= ' border-radius: ' .
                            (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                    }

                    $output .= '">';

                    // Anchor with optional border-radius and overflow
                    if ($thumbnailLink) {
                        $output .= '<a href="' . esc_url($permalink) . '">';
                        $output .= $thumbnail;
                        $output .= '</a>';
                    } else {
                        $output .= $thumbnail;
                    }
                    
                    if ($showPostDate) {
                        $output .= '<div class="pre-blog-meta" style="color:' . esc_attr($metaTextColor) . '; ">';
                        
                        $output .= '<span class="pre-date">' . esc_html(get_the_date('d')) . '</span>';
                        $output .= '<span class="pre-month"> ' . esc_html(get_the_date('F')) . '</span>'; 
                        $output .= '</div>';
                    }
                    $output .= '</div>';
                }
                
                // MAIN Content
                $output .= '<div class="rs-content" style="';
                    // Margin
                    if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                        $output .= 'margin: ' .
                            (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                            (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                            (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                            (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                    }
                    // Padding
                    if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                        $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'padding: 0px 0px 0px 0px;';
                    }
                    // Check if at least one side is not empty
                    if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                            (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                            (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                            (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';

                // Meta Data
                if ($showMetaData) {
                    $output .= '<div class="rs-meta">'; 
                    $output .= '<ul class="meta-data-list align-' . $metaAlignment . ' " style="';  
                        // Margin
                        if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                            $output .= 'margin: ' .
                                (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                        }
                        // Padding
                        if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                            $output .= 'padding: ' .
                                (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                        }   
                        
                        // Color
                        if (!empty($metaTextColor)) {
                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                        }
                        // Order
                        if (!empty($metaOrder)) {
                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                        }
                    $output .= '">';

                    $meta_items = [];

                    // Author
                    
                    if ($showPostAuthor) {
                        $meta = '<li class="meta-author">';

                        // Author Avatar
                        if ($showPostAuthorIcon && $showMetaIcon) {
                            $author_id = get_the_author_meta('ID');
                            $avatar_size = !empty($metaFontSize) ? intval($metaFontSize) * 2 : 24; // Double the font size for avatar
                            $avatar = get_avatar($author_id, $avatar_size, '', '', [
                                'class' => 'author-avatar',
                                'style' => !empty($metaIconColor) ? 'vertical-align:middle; margin-right:8px; border-radius:50%; color:' . esc_attr($metaIconColor) . ';' : 'vertical-align:middle; margin-right:8px; border-radius:50%;',
                            ]);
                            $meta .= $avatar;
                        }

                        // Author Name
                        $meta .= '<span style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        $meta .= '<a href="' . esc_url(get_author_posts_url(get_the_author_meta('ID'))) . '" style="text-decoration:none; color:inherit;">';
                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author);
                        $meta .= '</a>';

                        $meta .= '</span></li>';

                        $meta_items[] = $meta;
                    }
                    if ($showPostDate) {
                        $meta = '<li class="meta-date" style="';

                        // Text color
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        // Font size
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        // Only year
                        $year = get_the_date('Y', $post_id); // Make sure $post_id is defined
                        $meta .= 'News in ' . esc_html($year);

                        $meta .= '</li>';
                        $meta_items[] = $meta;
                    }

                    // Now join meta items with the separator
                    if (!empty($meta_items)) {
                        $separator = '';

                        if ($metaSeperator !== '') {
                            $separator = '';
                            if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                $separatorStyle = '';
                                if (!empty($separatorColor)) {
                                    $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                            }
                        }

                        $output .= implode($separator, $meta_items);
                    }
                    $output .= '</ul>'; 
                    $output .= '</div>';               
                }
                // End Meta Data

                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }
                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }
                    // Margin
                    if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .
                            (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                            (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                            (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                            (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                    }
                    // Padding
                    if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                            (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                            (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                            (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                    }
                    // Class name
                    $classNames = 'title' 
                        . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                        . ' align-' . esc_attr($postTitleAlignment);
                    // Hover JS (conditionally included)
                    $onmouseover = !empty($postTitleHoverBgColor) 
                        ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                        : '';
                    $onmouseout = !empty($postTitleBgColor) 
                        ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                        : '';
                    // Final output
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                        . $onmouseover 
                        . $onmouseout 
                        . '>';

                    $style = '';
                    $hoverStyle = '';
                    $mouseoutStyle = '';

                    // Build inline styles conditionally
                    if (!empty($postTitleFontSize)) {
                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                    }
                    if (!empty($postTitleLineHeight)) {
                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                    }
                    if (!empty($postTitleLetterSpacing)) {
                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                    }
                    if (!empty($postTitleFontWeight)) {
                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                    }
                    if (!empty($postTitleColor)) {
                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        if ($titleHoverUnderLine === 'enable') {
                            $style .= 'background-image: linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%); ';
                            $style .= 'background-position: 0 100%; ';
                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                        }
                    }
                    // Build hover color style if set
                    if (!empty($postTitleHoverColor)) {
                        $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        if ($titleHoverUnderLine === 'enable') {
                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                        }
                    }
                    // Final output
                    $output .= '<a href="' . esc_url($permalink) . '" 
                        style="' . esc_attr(trim($style)) . '"'
                        . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                        . esc_html($croppedTitle) . '</a>';    
                    $output .= '</' . esc_attr($titleTag) . '>';
                }
                
                // Button Output                
                if ($showReadMoreButton) {
                    // Button wrapper styles
                    $buttonWrapperStyle = '';

                    // Margin
                    if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                        $buttonWrapperStyle .= 'margin: ' .
                            (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                            (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                            (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                            (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                    }

                    // Order
                    if (!empty($buttonOrder)) {
                        $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                    }

                   
                    $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                    // Button inline styles
                    $buttonInlineStyles = '';

                    if (!empty($buttonTextColor)) {
                        $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                    }
                    if (!empty($buttonBackgroundColor)) {
                        $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                    }
                    if (!empty($buttonFontSize)) {
                        $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                    }
                    if (!empty($buttonFontWeight)) {
                        $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                    }
                    if (!empty($buttonBorderColor)) {
                        $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                    }
                    if (!empty($buttonBorderType)) {
                        $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                    }

                    // Border width
                    
                    if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                        $buttonInlineStyles .= 'border-width: ' .
                            (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                            (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                            (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                            (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                    }
                    if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                        $buttonInlineStyles .= 'border-radius: ' .
                            (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                            (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                            (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                            (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                    }
                    if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                        $buttonInlineStyles .= 'padding: ' .
                            (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                            (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                            (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                            (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                    }

                    // Hover styles
                    $buttonHoverInlineStyles = '';
                    $buttonResetStyles = '';

                    if (!empty($buttonHoverTextColor)) {
                        $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                        $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                    }
                    if (!empty($buttonHoverBorderColor)) {
                        $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                        $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                    }
                    if (!empty($buttonHoverBackgroundColor)) {
                        $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                        $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                    }

                    // Button anchor tag
                    $output .= '<a class="blog-btn icon-after read-more ' . esc_attr($buttonStyle6) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                    if (!empty($buttonHoverInlineStyles)) {
                        $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                    }

                    if (!empty($buttonResetStyles)) {
                        $output .= ' onmouseout="' . $buttonResetStyles . '"';
                    }

                    $output .= '>';

                    // Icon handling
                    $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                    $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                    $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                    if ($iconPosition === 'left' && $showButtonIcon) {
                        $output .= $leftIcon . ' ';
                    }

                    $output .= esc_html($readMoreLabel);

                    if ($iconPosition === 'right' && $showButtonIcon) {
                        $output .= ' ' . $rightIcon;
                    }

                    $output .= '</a></div>';
                }
                // End Button

                $output .= '</div>';
                // End MAIN Content
                $output .= '</div>';
                
                // End Full post layout
            }
            else if ($gridLayoutStyle === 'style7') {
                // Full post layout
                $output .= '<div class="rs-blog-layout-14-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                    // MARGIN    
                    if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                        $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'margin: 40px 0px 0px 0px;';
                    }

                    // Padding
                    if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                            (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                            (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                            (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                    }

                    // Border Radius
                    if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' . 
                            (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                            (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                            (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                            (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                    }

                    // Border Width
                    if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' . 
                            (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                            (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                            (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                            (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                    }

                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                        $output .= 'box-shadow: ' . 
                            (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                            (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                            (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                            (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                            esc_attr($itemBoxShadowColor) . '; ';
                    }

                $output .= '">';
                // Thumbnail
                if ($thumbnail && $showThumbnail) {
                    $output .= '<div class="rs-thumb" style="';

                    // Margin
                    if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                        $output .= 'margin: ' . 
                            (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                            (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                            (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                            (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                            (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                            (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                            (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                    }
                    if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                        $output .= ' border-radius: ' .
                            (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                    }

                    $output .= '">';

                    // Anchor with optional border-radius and overflow
                    if ($thumbnailLink) {
                        $output .= '<a href="' . esc_url($permalink) . '">';
                        $output .= $thumbnail;
                        $output .= '</a>';
                    } else {
                        $output .= $thumbnail;
                    }
                    $output .= '</div>';
                }
                // END Thumbnail
                

                // MAIN Content
                $output .= '<div class="rs-content" style="';
                    // Margin
                    if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                        $output .= 'margin: ' .
                            (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                            (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                            (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                            (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                    }
                    // Padding
                    if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                        $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'padding: 20px;';
                    }
                    // Check if at least one side is not empty
                    if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                            (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                            (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                            (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';

                

                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }
                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }
                    // Margin
                    if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .
                            (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                            (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                            (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                            (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                    }
                    // Padding
                    if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                            (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                            (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                            (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                    }
                    // Class name
                    $classNames = 'title' 
                        . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                        . ' align-' . esc_attr($postTitleAlignment);
                    // Hover JS (conditionally included)
                    $onmouseover = !empty($postTitleHoverBgColor) 
                        ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                        : '';
                    $onmouseout = !empty($postTitleBgColor) 
                        ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                        : '';
                    // Final output
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                        . $onmouseover 
                        . $onmouseout 
                        . '>';

                    $style = '';
                    $hoverStyle = '';
                    $mouseoutStyle = '';

                    // Build inline styles conditionally
                    if (!empty($postTitleFontSize)) {
                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                    }
                    if (!empty($postTitleLineHeight)) {
                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                    }
                    if (!empty($postTitleLetterSpacing)) {
                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                    }
                    if (!empty($postTitleFontWeight)) {
                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                    }
                    if (!empty($postTitleColor)) {
                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        if ($titleHoverUnderLine === 'enable') {
                            $style .= 'background-image: linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%); ';
                            $style .= 'background-position: 0 100%; ';
                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                        }
                    }
                    // Build hover color style if set
                    if (!empty($postTitleHoverColor)) {
                        $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        if ($titleHoverUnderLine === 'enable') {
                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                        }
                    }
                    // Final output
                    $output .= '<a href="' . esc_url($permalink) . '" 
                        style="' . esc_attr(trim($style)) . '"'
                        . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                        . esc_html($croppedTitle) . '</a>';    
                    $output .= '</' . esc_attr($titleTag) . '>';
                }
                // Meta Data
                if ($showMetaData) {
                            
                    $output .= '<div class="rs-meta align-' . $metaAlignment . ' " style="';  
                        // Margin
                        if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                            $output .= 'margin: ' .
                                (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                        }
                        // Padding
                        if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                            $output .= 'padding: ' .
                                (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                        }   
                        
                        // Color
                        if (!empty($metaTextColor)) {
                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                        }
                        // Order
                        if (!empty($metaOrder)) {
                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                        }
                    $output .= '">';

                    $meta_items = [];

                    // Date
                    if ($showPostDate) {
                        $meta = '<span class="meta-date" style="';

                        // Color
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        // Font size
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        // Icon
                        if ($showPostDateIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-calendar-alt" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($getdate) . '</span>';
                        $meta_items[] = $meta;
                    }
                    if ($showPostCategory) {
                        $meta = '<a style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCategoryIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-folder" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        // Get category names without links
                        $categories_list = get_the_category($post_id);
                        if (!empty($categories_list)) {
                            $category_names = array();
                            foreach ($categories_list as $category) {
                                $category_names[] = esc_html($category->name);
                            }
                            $meta .= implode(', ', $category_names); // comma-separated plain text categories
                        }

                        $meta .= '</a>';
                        $meta_items[] = $meta;
                    }
                    
                    // Now join meta items with the separator
                    if (!empty($meta_items)) {
                        $separator = '';

                        if ($metaSeperator !== '') {
                            $separator = '';
                            if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                $separatorStyle = '';
                                if (!empty($separatorColor)) {
                                    $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                            }
                        }

                        $output .= implode($separator, $meta_items);
                    }

                    $output .= '</div>'; // Close meta-data-list
                    
                }
                // End Meta Data

                $output .= '</div>';
                // End MAIN Content
                $output .= '</div>';
                // End Full post layout
            }
            else if ($gridLayoutStyle === 'style8') {
                // Full post layout
                $output .= '<div class="rs-blog-layout-15-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                    // MARGIN    
                    if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                        $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'margin: 40px 0px 0px 0px;';
                    }

                    // Padding
                    if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                            (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                            (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                            (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                    }

                    // Border Radius
                    if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' . 
                            (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                            (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                            (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                            (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                    }

                    // Border Width
                    if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' . 
                            (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                            (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                            (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                            (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                    }

                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                        $output .= 'box-shadow: ' . 
                            (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                            (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                            (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                            (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                            esc_attr($itemBoxShadowColor) . '; ';
                    }

                $output .= '">';
                
                // MAIN Content
                $output .= '<div class="rs-content" style="';
                    // Margin
                    if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                        $output .= 'margin: ' .
                            (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                            (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                            (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                            (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                    }
                    // Padding
                    if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                        $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'padding: 0px 0px 0px 0px;';
                    }
                    // Check if at least one side is not empty
                    if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                            (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                            (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                            (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';               

                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }
                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }
                    // Margin
                    if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .
                            (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                            (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                            (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                            (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                    }
                    // Padding
                    if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                            (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                            (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                            (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                    }
                    // Class name
                    $classNames = 'title' 
                        . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                        . ' align-' . esc_attr($postTitleAlignment);
                    // Hover JS (conditionally included)
                    $onmouseover = !empty($postTitleHoverBgColor) 
                        ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                        : '';
                    $onmouseout = !empty($postTitleBgColor) 
                        ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                        : '';
                    // Final output
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                        . $onmouseover 
                        . $onmouseout 
                        . '>';

                    $style = '';
                    $hoverStyle = '';
                    $mouseoutStyle = '';

                    // Build inline styles conditionally
                    if (!empty($postTitleFontSize)) {
                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                    }
                    if (!empty($postTitleLineHeight)) {
                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                    }
                    if (!empty($postTitleLetterSpacing)) {
                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                    }
                    if (!empty($postTitleFontWeight)) {
                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                    }
                    if (!empty($postTitleColor)) {
                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        if ($titleHoverUnderLine === 'enable') {
                            $style .= 'background-image: linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%); ';
                            $style .= 'background-position: 0 100%; ';
                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                        }
                    }
                    // Build hover color style if set
                    if (!empty($postTitleHoverColor)) {
                        $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        if ($titleHoverUnderLine === 'enable') {
                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                        }
                    }
                    // Final output
                    $output .= '<a href="' . esc_url($permalink) . '" 
                        style="' . esc_attr(trim($style)) . '"'
                        . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                        . esc_html($croppedTitle) . '</a>';    
                    $output .= '</' . esc_attr($titleTag) . '>';
                }
                // Meta Data
                if ($showMetaData) {
                            
                    $output .= '<div class="rs-meta align-' . $metaAlignment . ' " style="';  
                        // Margin
                        if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                            $output .= 'margin: ' .
                                (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                        }
                        // Padding
                        if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                            $output .= 'padding: ' .
                                (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                        }   
                        
                        // Color
                        if (!empty($metaTextColor)) {
                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                        }
                        // Order
                        if (!empty($metaOrder)) {
                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                        }
                    $output .= '">';

                    $meta_items = [];

                    // Date
                    if ($showPostDate) {
                        // Format the date as "Oct 14, 2024"
                        $formatted_date = get_the_date('M j, Y', $post_id); // 'M' = short month, 'j' = day (no leading 0), 'Y' = full year

                        $meta = '<span class="meta-date" style="';

                        // Color
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        // Font size
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        // Icon
                        if ($showPostDateIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-calendar-alt" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($formatted_date) . '</span>';
                        $meta_items[] = $meta;
                    }


                    // Author
                    if ($showPostAuthor) {
                        $meta = '<a class="meta-author" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostAuthorIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-user" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</a>';
                        $meta_items[] = $meta;
                    }

                    // Now join meta items with the separator
                    if (!empty($meta_items)) {
                        $separator = '';

                        if ($metaSeperator !== '') {
                            $separator = '';
                            if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                $separatorStyle = '';
                                if (!empty($separatorColor)) {
                                    $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                            }
                        }

                        $output .= implode($separator, $meta_items);
                    }

                    $output .= '</div>'; // Close meta-data-list
                    
                }
                // End Meta Data

                $output .= '</div>';

                // Thumbnail
                if ($thumbnail && $showThumbnail) {
                    $output .= '<div class="rs-thumb" style="';

                    // Margin
                    if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                        $output .= 'margin: ' . 
                            (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                            (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                            (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                            (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                            (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                            (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                            (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                    }
                    if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                        $output .= ' border-radius: ' .
                            (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                    }

                    $output .= '">';

                    // Anchor with optional border-radius and overflow
                    if ($thumbnailLink) {
                        $output .= '<a href="' . esc_url($permalink) . '">';
                        $output .= $thumbnail;
                        $output .= '</a>';
                    } else {
                        $output .= $thumbnail;
                    }
                    // Category
                    if ($showPostCategory) {
                        $meta = '<div class="rs-category" style="';

                        // Add color and font-size styles if provided
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        // Add icon if enabled
                        if ($showPostCategoryIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-folder" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        // Get and display category names
                        $categories_list = get_the_category($post_id);
                        if (!empty($categories_list)) {
                            $category_names = array();
                            foreach ($categories_list as $category) {
                                $category_names[] = esc_html($category->name);
                            }
                            $meta .= implode(', ', $category_names); // comma-separated plain text
                        }

                        $meta .= '</div>';
                        $output .= $meta;
                    }

                    $output .= '</div>'; // Close fancy-post-image rs-thumb
                }
                // END Thumbnail

                // End MAIN Content
                $output .= '</div>';
                // End Full post layout
            }
            else if ($gridLayoutStyle === 'style9') {
                // Full post layout
                $output .= '<div class="rs-blog-layout-16-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                    // MARGIN    
                    if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                        $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'margin: 40px 0px 0px 0px;';
                    }

                    // Padding
                    if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                            (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                            (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                            (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                    }

                    // Border Radius
                    if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' . 
                            (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                            (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                            (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                            (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                    }

                    // Border Width
                    if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' . 
                            (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                            (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                            (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                            (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                    }

                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                        $output .= 'box-shadow: ' . 
                            (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                            (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                            (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                            (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                            esc_attr($itemBoxShadowColor) . '; ';
                    }

                $output .= '">';
                // Thumbnail
                if ($thumbnail && $showThumbnail) {
                    $output .= '<div class="rs-thumb" style="';

                    // Margin
                    if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                        $output .= 'margin: ' . 
                            (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                            (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                            (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                            (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                            (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                            (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                            (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                    }
                    if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                        $output .= ' border-radius: ' .
                            (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                    }

                    $output .= '">';

                    // Anchor with optional border-radius and overflow
                    if ($thumbnailLink) {
                        $output .= '<a href="' . esc_url($permalink) . '">';
                        $output .= $thumbnail;
                        $output .= '</a>';
                    } else {
                        $output .= $thumbnail;
                    }
                    $output .= '</div>';
                }
                // END Thumbnail
                

                // MAIN Content
                $output .= '<div class="rs-content" style="';
                    // Margin
                    if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                        $output .= 'margin: ' .
                            (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                            (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                            (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                            (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                    }
                    // Padding
                    if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                        $output .= 'margin: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'margin: 0px 0px 0px 0px;';
                    }
                    // Check if at least one side is not empty
                    if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                            (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                            (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                            (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';

                

                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }
                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }
                    // Margin
                    if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .
                            (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                            (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                            (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                            (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                    }
                    // Padding
                    if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                            (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                            (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                            (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                    }
                    // Class name
                    $classNames = 'title' 
                        . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                        . ' align-' . esc_attr($postTitleAlignment);
                    // Hover JS (conditionally included)
                    $onmouseover = !empty($postTitleHoverBgColor) 
                        ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                        : '';
                    $onmouseout = !empty($postTitleBgColor) 
                        ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                        : '';
                    // Final output
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                        . $onmouseover 
                        . $onmouseout 
                        . '>';

                    $style = '';
                    $hoverStyle = '';
                    $mouseoutStyle = '';

                    // Build inline styles conditionally
                    if (!empty($postTitleFontSize)) {
                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                    }
                    if (!empty($postTitleLineHeight)) {
                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                    }
                    if (!empty($postTitleLetterSpacing)) {
                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                    }
                    if (!empty($postTitleFontWeight)) {
                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                    }
                    if (!empty($postTitleColor)) {
                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        if ($titleHoverUnderLine === 'enable') {
                            $style .= 'background-image: linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%); ';
                            $style .= 'background-position: 0 100%; ';
                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                        }
                    }
                    // Build hover color style if set
                    if (!empty($postTitleHoverColor)) {
                        $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        if ($titleHoverUnderLine === 'enable') {
                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                        }
                    }
                    // Final output
                    $output .= '<a href="' . esc_url($permalink) . '" 
                        style="' . esc_attr(trim($style)) . '"'
                        . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                        . esc_html($croppedTitle) . '</a>';    
                    $output .= '</' . esc_attr($titleTag) . '>';
                }

                // Meta Data
                if ($showMetaData) {
                    $output .= '<div class="rs-meta align-' . esc_attr($metaAlignment) . '" style="';

                    // Margin
                    if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                        $output .= 'margin: ' .
                            (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                            (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                            (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                            (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                        $output .= 'padding: ' .
                            (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                            (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                            (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                            (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                    }

                    // Color
                    if (!empty($metaTextColor)) {
                        $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                    }

                    // Order
                    if (!empty($metaOrder)) {
                        $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                    }

                    $output .= '">';

                    $meta_items = [];

                    // Author
                    if ($showPostAuthor) {
                        $meta = '<div class="meta-author">';

                        // Author Avatar
                        if ($showPostAuthorIcon && $showMetaIcon) {
                            $author_id = get_the_author_meta('ID');
                            $avatar_size = !empty($metaFontSize) ? intval($metaFontSize) * 2 : 24; // Double the font size for avatar
                            $avatar = get_avatar($author_id, $avatar_size, '', '', [
                                'class' => 'author-avatar',
                                'style' => !empty($metaIconColor) ? 'vertical-align:middle; margin-right:8px; border-radius:50%; color:' . esc_attr($metaIconColor) . ';' : 'vertical-align:middle; margin-right:8px; border-radius:50%;',
                            ]);
                            $meta .= $avatar;
                        }

                        // Author Name
                        $meta .= '<span style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        $meta .= '<a href="' . esc_url(get_author_posts_url(get_the_author_meta('ID'))) . '" style="text-decoration:none; color:inherit;">';
                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author);
                        $meta .= '</a>';

                        $meta .= '</span></div>';

                        $meta_items[] = $meta;
                    }

                    // Date
                    if ($showPostDate) {
                        $meta = '<div class="meta-date"><span style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostDateIcon && $showMetaIcon) {
                            $meta .= '<i class="fa-regular fa-clock" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        // Format date as "26 Aug 2024"
                        $formatted_date = get_the_date('d M Y', $post_id); // use $post_id if needed
                        $meta .= esc_html($formatted_date) . '</span></div>';

                        $meta_items[] = $meta;
                    }



                    // Output all metadata without separators
                    $output .= implode('', $meta_items);

                    $output .= '</div>'; // Close .rs-meta
                }

                // End Meta Data

                $output .= '</div>';
                // End MAIN Content
                $output .= '</div>';
                // End Full post layout
            }
            else if ($gridLayoutStyle === 'style10') {
                // Full post layout
                $output .= '<div class="rs-blog-layout-19-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                    // MARGIN    
                    if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                        $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'margin: 40px 0px 0px 0px;';
                    }

                    // Padding
                    if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                            (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                            (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                            (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                    }

                    // Border Radius
                    if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' . 
                            (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                            (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                            (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                            (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                    }

                    // Border Width
                    if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' . 
                            (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                            (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                            (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                            (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                    }

                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                        $output .= 'box-shadow: ' . 
                            (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                            (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                            (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                            (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                            esc_attr($itemBoxShadowColor) . '; ';
                    }

                $output .= '">';
                // Thumbnail
                if ($thumbnail && $showThumbnail) {
                    $output .= '<div class="rs-thumb" style="';

                    // Margin
                    if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                        $output .= 'margin: ' . 
                            (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                            (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                            (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                            (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                            (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                            (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                            (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                    }
                    if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                        $output .= ' border-radius: ' .
                            (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                    }

                    $output .= '">';

                    // Anchor with optional border-radius and overflow
                    if ($thumbnailLink) {
                        $output .= '<a href="' . esc_url($permalink) . '">';
                        $output .= $thumbnail;
                        $output .= '</a>';
                    } else {
                        $output .= $thumbnail;
                    }
                    $output .= '</div>';
                }
                // END Thumbnail
                
                // MAIN Content
                $output .= '<div class="rs-content" style="';
                    // Margin
                    if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                        $output .= 'margin: ' .
                            (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                            (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                            (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                            (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                    }
                    // Padding
                    if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                        $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'padding: 0px 0px 0px 0px;';
                    }
                    // Check if at least one side is not empty
                    if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                            (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                            (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                            (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';

                // Meta Data
                if ($showMetaData) {
                    $output .= '<div class="rs-meta">'; 
                    $output .= '<ul class="meta-data-list align-' . $metaAlignment . ' " style="';  
                        // Margin
                        if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                            $output .= 'margin: ' .
                                (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                        }
                        // Padding
                        if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                            $output .= 'padding: ' .
                                (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                        }   
                        
                        // Color
                        if (!empty($metaTextColor)) {
                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                        }
                        // Order
                        if (!empty($metaOrder)) {
                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                        }
                    $output .= '">';

                    $meta_items = [];

                    // Date
                    if ($showPostDate) {
                        $meta = '<li class="meta-date" style="';

                        // Color
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        // Font size
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        // Icon
                        if ($showPostDateIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-calendar-alt" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($getdate) . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Author
                    if ($showPostAuthor) {
                        $meta = '<li class="meta-author" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostAuthorIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-user" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Category
                    if ($showPostCategory) {
                        $meta = '<li class="meta-categories" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCategoryIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-folder" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        // Get category names without links
                        $categories_list = get_the_category($post_id);
                        if (!empty($categories_list)) {
                            $category_names = array();
                            foreach ($categories_list as $category) {
                                $category_names[] = esc_html($category->name);
                            }
                            $meta .= implode(', ', $category_names); // comma-separated plain text categories
                        }

                        $meta .= '</li>';
                        $meta_items[] = $meta;
                    }
                    // Tags
                    if ($showPostTags && !empty($tags)) {
                        $meta = '<li class="meta-tags" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostTagsIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-tags" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Comment Count
                    if ($showPostCommentsCount) {
                        $meta = '<li class="meta-comment-count" style="';
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCommentsCountIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-comments" style="';
                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }
                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Now join meta items with the separator
                    if (!empty($meta_items)) {
                        $separator = '';

                        if ($metaSeperator !== '') {
                            $separator = '';
                            if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                $separatorStyle = '';
                                if (!empty($separatorColor)) {
                                    $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                            }
                        }

                        $output .= implode($separator, $meta_items);
                    }
                    $output .= '</ul>'; 
                    $output .= '</div>'; // Close meta-data-list               
                }
                // End Meta Data

                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }
                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }
                    // Margin
                    if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .
                            (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                            (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                            (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                            (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                    }
                    // Padding
                    if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                            (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                            (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                            (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                    }
                    // Class name
                    $classNames = 'title' 
                        . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                        . ' align-' . esc_attr($postTitleAlignment);
                    // Hover JS (conditionally included)
                    $onmouseover = !empty($postTitleHoverBgColor) 
                        ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                        : '';
                    $onmouseout = !empty($postTitleBgColor) 
                        ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                        : '';
                    // Final output
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                        . $onmouseover 
                        . $onmouseout 
                        . '>';

                    $style = '';
                    $hoverStyle = '';
                    $mouseoutStyle = '';

                    // Build inline styles conditionally
                    if (!empty($postTitleFontSize)) {
                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                    }
                    if (!empty($postTitleLineHeight)) {
                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                    }
                    if (!empty($postTitleLetterSpacing)) {
                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                    }
                    if (!empty($postTitleFontWeight)) {
                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                    }
                    if (!empty($postTitleColor)) {
                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        if ($titleHoverUnderLine === 'enable') {
                            $style .= 'background-image: linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%); ';
                            $style .= 'background-position: 0 100%; ';
                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                        }
                    }
                    // Build hover color style if set
                    if (!empty($postTitleHoverColor)) {
                        $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        if ($titleHoverUnderLine === 'enable') {
                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                        }
                    }
                    // Final output
                    $output .= '<a href="' . esc_url($permalink) . '" 
                        style="' . esc_attr(trim($style)) . '"'
                        . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                        . esc_html($croppedTitle) . '</a>';    
                    $output .= '</' . esc_attr($titleTag) . '>';
                }

                // Button Output                
                if ($showReadMoreButton) {
                    // Button wrapper styles
                    $buttonWrapperStyle = '';

                    // Margin
                    if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                        $buttonWrapperStyle .= 'margin: ' .
                            (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                            (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                            (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                            (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                    }

                    // Order
                    if (!empty($buttonOrder)) {
                        $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                    }

                   
                    $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                    // Button inline styles
                    $buttonInlineStyles = '';

                    if (!empty($buttonTextColor)) {
                        $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                    }
                    if (!empty($buttonBackgroundColor)) {
                        $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                    }
                    if (!empty($buttonFontSize)) {
                        $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                    }
                    if (!empty($buttonFontWeight)) {
                        $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                    }
                    if (!empty($buttonBorderColor)) {
                        $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                    }
                    if (!empty($buttonBorderType)) {
                        $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                    }

                    // Border width
                    
                    if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                        $buttonInlineStyles .= 'border-width: ' .
                            (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                            (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                            (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                            (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                    }
                    if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                        $buttonInlineStyles .= 'border-radius: ' .
                            (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                            (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                            (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                            (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                    }
                    if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                        $buttonInlineStyles .= 'padding: ' .
                            (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                            (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                            (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                            (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                    }

                    // Hover styles
                    $buttonHoverInlineStyles = '';
                    $buttonResetStyles = '';

                    if (!empty($buttonHoverTextColor)) {
                        $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                        $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                    }
                    if (!empty($buttonHoverBorderColor)) {
                        $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                        $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                    }
                    if (!empty($buttonHoverBackgroundColor)) {
                        $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                        $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                    }

                    // Button anchor tag
                    $output .= '<a class="rs-btn read-more ' . esc_attr($buttonStyle10) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                    if (!empty($buttonHoverInlineStyles)) {
                        $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                    }

                    if (!empty($buttonResetStyles)) {
                        $output .= ' onmouseout="' . $buttonResetStyles . '"';
                    }

                    $output .= '>';

                    // Icon handling
                    $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                    $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                    $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                    if ($iconPosition === 'left' && $showButtonIcon) {
                        $output .= $leftIcon . ' ';
                    }

                    $output .= esc_html($readMoreLabel);

                    if ($iconPosition === 'right' && $showButtonIcon) {
                        $output .= ' ' . $rightIcon;
                    }

                    $output .= '</a></div>';
                }
                // End Button

                $output .= '</div>';
                // End MAIN Content
                $output .= '</div>';
                // End Full post layout
            }
            else if ($gridLayoutStyle === 'style11') {
                // Full post layout
                $output .= '<div class="rs-blog-layout-21-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                    // MARGIN    
                    if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                        $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'margin: 40px 0px 0px 0px;';
                    }

                    // Padding
                    if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                            (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                            (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                            (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                    }

                    // Border Radius
                    if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' . 
                            (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                            (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                            (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                            (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                    }

                    // Border Width
                    if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' . 
                            (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                            (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                            (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                            (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                    }

                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                        $output .= 'box-shadow: ' . 
                            (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                            (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                            (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                            (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                            esc_attr($itemBoxShadowColor) . '; ';
                    }

                $output .= '">';

                if ($thumbnail && $showThumbnail) {
                    $output .= '<div class="rs-thumb" style="';

                    // Margin
                    if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                        $output .= 'margin: ' . 
                            (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                            (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                            (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                            (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                            (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                            (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                            (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                    }
                    if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                        $output .= ' border-radius: ' .
                            (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                    }

                    $output .= '">';

                    // Anchor with optional border-radius and overflow
                    if ($thumbnailLink) {
                        $output .= '<a href="' . esc_url($permalink) . '">';
                        $output .= $thumbnail;
                        $output .= '</a>';
                    } else {
                        $output .= $thumbnail;
                    }
                    
                    $output .= '
                    <svg viewBox="0 0 410 32" fill="none" xmlns="http://www.w3.org/2000/svg" class="shape__rs_course">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M346.69 23.5159C371.59 23.3769 398.013 17.3185 410 4.85404V32H0V9.75773C2.99658 0.284217 26.1914 -2.12936 41.5898 1.81449C49.0762 3.72855 55.7041 6.53361 62.3281 9.33695C69.3286 12.2997 76.3247 15.2605 84.3242 17.1654C111.49 25.8323 134.405 18.6565 157.427 11.4472C171.419 7.06559 185.451 2.67167 200.5 1.81449C217.549 0.842933 234.721 5.15653 251.493 9.36967C259.098 11.2798 266.62 13.1693 274.011 14.5363C278.288 15.3272 282.339 16.1309 286.297 16.9161C304.269 20.4812 320.31 23.6632 346.69 23.5159Z" fill="#ffffff"></path>
                    </svg>';
                    $output .= '</div>';
                }

                // MAIN Content
                $output .= '<div class="rs-content" style="';
                    // Margin
                    if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                        $output .= 'margin: ' .
                            (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                            (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                            (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                            (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                    }
                    // Padding
                    if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                        $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'padding: 20px 40px 30px 30px;';
                    }
                    // Check if at least one side is not empty
                    if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                            (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                            (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                            (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';

                // Meta Data
                if ($showMetaData) {
                    $output .= '<div class="rs-meta">'; 
                    $output .= '<ul class="meta-data-list align-' . $metaAlignment . ' " style="';  
                        // Margin
                        if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                            $output .= 'margin: ' .
                                (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                        }
                        // Padding
                        if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                            $output .= 'padding: ' .
                                (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                        }   
                        
                        // Color
                        if (!empty($metaTextColor)) {
                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                        }
                        // Order
                        if (!empty($metaOrder)) {
                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                        }
                    $output .= '">';

                    $meta_items = [];

                    // Date
                    if ($showPostDate) {
                        $meta = '<li class="meta-date" style="';

                        // Color
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        // Font size
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        // Icon
                        if ($showPostDateIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-calendar-alt" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($getdate) . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Author
                    if ($showPostAuthor) {
                        $meta = '<li class="meta-author" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostAuthorIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-user" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Category
                    if ($showPostCategory) {
                        $meta = '<li class="meta-categories" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCategoryIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-folder" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        // Get category names without links
                        $categories_list = get_the_category($post_id);
                        if (!empty($categories_list)) {
                            $category_names = array();
                            foreach ($categories_list as $category) {
                                $category_names[] = esc_html($category->name);
                            }
                            $meta .= implode(', ', $category_names); // comma-separated plain text categories
                        }

                        $meta .= '</li>';
                        $meta_items[] = $meta;
                    }
                    // Tags
                    if ($showPostTags && !empty($tags)) {
                        $meta = '<li class="meta-tags" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostTagsIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-tags" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Comment Count
                    if ($showPostCommentsCount) {
                        $meta = '<li class="meta-comment-count" style="';
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCommentsCountIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-comments" style="';
                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }
                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Now join meta items with the separator
                    if (!empty($meta_items)) {
                        $separator = '';

                        if ($metaSeperator !== '') {
                            $separator = '';
                            if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                $separatorStyle = '';
                                if (!empty($separatorColor)) {
                                    $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                            }
                        }

                        $output .= implode($separator, $meta_items);
                    }
                    $output .= '</ul>'; 
                    $output .= '</div>'; // Close meta-data-list                 
                }
                // End Meta Data

                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }
                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }
                    // Margin
                    if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .
                            (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                            (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                            (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                            (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                    }
                    // Padding
                    if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                            (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                            (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                            (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                    }
                    // Class name
                    $classNames = 'title' 
                        . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                        . ' align-' . esc_attr($postTitleAlignment);
                    // Hover JS (conditionally included)
                    $onmouseover = !empty($postTitleHoverBgColor) 
                        ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                        : '';
                    $onmouseout = !empty($postTitleBgColor) 
                        ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                        : '';
                    // Final output
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                        . $onmouseover 
                        . $onmouseout 
                        . '>';

                    $style = '';
                    $hoverStyle = '';
                    $mouseoutStyle = '';

                    // Build inline styles conditionally
                    if (!empty($postTitleFontSize)) {
                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                    }
                    if (!empty($postTitleLineHeight)) {
                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                    }
                    if (!empty($postTitleLetterSpacing)) {
                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                    }
                    if (!empty($postTitleFontWeight)) {
                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                    }
                    if (!empty($postTitleColor)) {
                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        if ($titleHoverUnderLine === 'enable') {
                            $style .= 'background-image: linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%); ';
                            $style .= 'background-position: 0 100%; ';
                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                        }
                    }
                    // Build hover color style if set
                    if (!empty($postTitleHoverColor)) {
                        $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        if ($titleHoverUnderLine === 'enable') {
                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                        }
                    }
                    // Final output
                    $output .= '<a href="' . esc_url($permalink) . '" 
                        style="' . esc_attr(trim($style)) . '"'
                        . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                        . esc_html($croppedTitle) . '</a>';    
                    $output .= '</' . esc_attr($titleTag) . '>';
                }

                // Button Output                
                if ($showReadMoreButton) {
                    // Button wrapper styles
                    $buttonWrapperStyle = '';

                    // Margin
                    if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                        $buttonWrapperStyle .= 'margin: ' .
                            (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                            (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                            (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                            (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                    }

                    // Order
                    if (!empty($buttonOrder)) {
                        $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                    }

                   
                    $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                    // Button inline styles
                    $buttonInlineStyles = '';

                    if (!empty($buttonTextColor)) {
                        $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                    }
                    if (!empty($buttonBackgroundColor)) {
                        $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                    }
                    if (!empty($buttonFontSize)) {
                        $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                    }
                    if (!empty($buttonFontWeight)) {
                        $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                    }
                    if (!empty($buttonBorderColor)) {
                        $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                    }
                    if (!empty($buttonBorderType)) {
                        $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                    }

                    // Border width
                    
                    if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                        $buttonInlineStyles .= 'border-width: ' .
                            (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                            (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                            (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                            (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                    }
                    if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                        $buttonInlineStyles .= 'border-radius: ' .
                            (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                            (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                            (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                            (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                    }
                    if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                        $buttonInlineStyles .= 'padding: ' .
                            (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                            (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                            (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                            (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                    }

                    // Hover styles
                    $buttonHoverInlineStyles = '';
                    $buttonResetStyles = '';

                    if (!empty($buttonHoverTextColor)) {
                        $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                        $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                    }
                    if (!empty($buttonHoverBorderColor)) {
                        $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                        $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                    }
                    if (!empty($buttonHoverBackgroundColor)) {
                        $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                        $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                    }

                    // Button anchor tag
                    $output .= '<a class="rs-btn read-more ' . esc_attr($buttonStyle11) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                    if (!empty($buttonHoverInlineStyles)) {
                        $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                    }

                    if (!empty($buttonResetStyles)) {
                        $output .= ' onmouseout="' . $buttonResetStyles . '"';
                    }

                    $output .= '>';

                    // Icon handling
                    $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                    $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                    $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                    if ($iconPosition === 'left' && $showButtonIcon) {
                        $output .= $leftIcon . ' ';
                    }

                    $output .= esc_html($readMoreLabel);

                    if ($iconPosition === 'right' && $showButtonIcon) {
                        $output .= ' ' . $rightIcon;
                    }

                    $output .= '</a></div>';
                }
                // End Button

                $output .= '</div>';
                // End MAIN Content
                $output .= '</div>';
                // End Full post layout
            }
            else if ($gridLayoutStyle === 'style12') {
                // Full post layout
                $output .= '<div class="rs-blog-layout-26-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                    // MARGIN    
                    if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                        $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'margin: 0px 0px 40px 0px;';
                    }

                    if ( !empty($itemPadding['top']) || !empty($itemPadding['right']) ||  !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                        $output .= 'padding: ' .(isset($itemPadding['top']) && $itemPadding['top'] !== '' ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' . (isset($itemPadding['right']) && $itemPadding['right'] !== '' ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' . (isset($itemPadding['bottom']) && $itemPadding['bottom'] !== '' ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' . (isset($itemPadding['left']) && $itemPadding['left'] !== '' ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'padding: 0px 0px 40px 0px;';
                    }

                    // Border Radius
                    if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' . 
                            (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                            (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                            (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                            (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                    }

                    // Border Width
                    if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' . 
                            (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                            (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                            (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                            (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                    }

                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                        $output .= 'box-shadow: ' . 
                            (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                            (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                            (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                            (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                            esc_attr($itemBoxShadowColor) . '; ';
                    }

                $output .= '">';

                // Thumbnail
                if ($thumbnail && $showThumbnail) {
                    $output .= '<div class="rs-thumb" style="';

                    // Margin
                    if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                        $output .= 'margin: ' . 
                            (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                            (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                            (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                            (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                            (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                            (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                            (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                    }
                    if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                        $output .= ' border-radius: ' .
                            (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                    }

                    $output .= '">';

                    // Anchor with optional border-radius and overflow
                    if ($thumbnailLink) {
                        $output .= '<a href="' . esc_url($permalink) . '">';
                        $output .= $thumbnail;
                        $output .= '</a>';
                    } else {
                        $output .= $thumbnail;
                    }
                    $output .= '</div>';
                }
                // END Thumbnail

                // MAIN Content
                $output .= '<div class="rs-content" style="';
                    // Margin
                    if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                        $output .= 'margin: ' .
                            (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                            (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                            (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                            (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                    }
                    // Padding
                    if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                        $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'padding: 40px 35px 50px 35px;';
                    }
                    // Check if at least one side is not empty
                    if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                            (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                            (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                            (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';

                // Meta Data
                if ($showMetaData) {
                            
                    $output .= '<div class="rs-meta align-' . $metaAlignment . ' " style="';  
                        // Margin
                        if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                            $output .= 'margin: ' .
                                (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                        }
                        // Padding
                        if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                            $output .= 'padding: ' .
                                (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                        }   
                        
                        // Color
                        if (!empty($metaTextColor)) {
                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                        }
                        // Order
                        if (!empty($metaOrder)) {
                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                        }
                    $output .= '">';

                    $meta_items = [];

                    // Date
                    if ($showPostDate) {
                        $meta = '<div class="meta-date" style="';

                        // Color
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        // Font size
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }
                        $meta .= '">';
                        $meta .= '<span>' . esc_html($getdate) . '</span>';
                        $meta .= '</div>';

                        $meta_items[] = $meta;
                    }

                    // Author
                    if ($showPostCategory) {
                        $meta = '<div class="meta-category" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        // Get category names without links
                        $categories_list = get_the_category($post_id);
                        if (!empty($categories_list)) {
                            $category_names = array();

                            foreach ($categories_list as $category) {
                                // If you want to link to the category archive, use get_category_link()
                                $category_link = esc_url(get_category_link($category->term_id));
                                $category_names[] = '<a href="' . $category_link . '">' . esc_html($category->name) . '</a>';
                            }

                            $meta .= implode(', ', $category_names); // comma-separated category links
                        }

                        $meta .= '</div>';
                        $meta_items[] = $meta;
                    }


                    // Now join meta items with the separator
                    $output .= implode( $meta_items);

                    $output .= '</div>'; // Close meta-data-list
                    
                }
                // End Meta Data

                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }
                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }
                    // Margin
                    if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .
                            (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                            (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                            (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                            (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                    }
                    // Padding
                    if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                            (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                            (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                            (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                    }
                    // Class name
                    $classNames = 'title' 
                        . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                        . ' align-' . esc_attr($postTitleAlignment);
                    // Hover JS (conditionally included)
                    $onmouseover = !empty($postTitleHoverBgColor) 
                        ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                        : '';
                    $onmouseout = !empty($postTitleBgColor) 
                        ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                        : '';
                    // Final output
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                        . $onmouseover 
                        . $onmouseout 
                        . '>';

                    $style = '';
                    $hoverStyle = '';
                    $mouseoutStyle = '';

                    // Build inline styles conditionally
                    if (!empty($postTitleFontSize)) {
                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                    }
                    if (!empty($postTitleLineHeight)) {
                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                    }
                    if (!empty($postTitleLetterSpacing)) {
                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                    }
                    if (!empty($postTitleFontWeight)) {
                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                    }
                    if (!empty($postTitleColor)) {
                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                        if ($titleHoverUnderLine === 'enable') {
                            $style .= 'background-image: linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%); ';
                            $style .= 'background-position: 0 100%; ';
                            $mouseoutStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleColor) . ' 0%, ' . esc_attr($postTitleColor) . ' 100%)\';';
                            $mouseoutStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                        }
                    }
                    // Build hover color style if set
                    if (!empty($postTitleHoverColor)) {
                        $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                        if ($titleHoverUnderLine === 'enable') {
                            $hoverStyle .= ' this.style.backgroundImage=\'linear-gradient(to bottom, ' . esc_attr($postTitleHoverColor) . ' 0%, ' . esc_attr($postTitleHoverColor) . ' 100%)\';';
                            $hoverStyle .= ' this.style.backgroundPosition=\'0 100%\';';
                        }
                    }
                    // Final output
                    $output .= '<a href="' . esc_url($permalink) . '" 
                        style="' . esc_attr(trim($style)) . '"'
                        . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                        . esc_html($croppedTitle) . '</a>';    
                    $output .= '</' . esc_attr($titleTag) . '>';
                }
                if ($showPostExcerpt) {
                    $excerptStyles = '';

                    // Order
                    if (!empty($excerptOrder)) {
                        $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                    }

                    // Typography
                    if (!empty($excerptFontSize)) {
                        $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                    }

                    if (!empty($excerptLineHeight)) {
                        $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                    }

                    if (!empty($excerptLetterSpacing)) {
                        $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                    }

                    if (!empty($excerptFontWeight)) {
                        $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                    }

                    if (!empty($excerptColor)) {
                        $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                    }

                    if (!empty($excerptBgColor)) {
                        $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                    }

                    if (!empty($excerptBorderType)) {
                        $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                    }

                    // Margin
                    if (!empty($excerptMargin['top']) || !empty($excerptMargin['right']) || !empty($excerptMargin['bottom']) || !empty($excerptMargin['left'])) {
                        $excerptStyles .= 'margin: ' .
                            (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) . ' ' .
                            (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) . ' ' .
                            (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) . ' ' .
                            (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($excerptPadding['top']) || !empty($excerptPadding['right']) || !empty($excerptPadding['bottom']) || !empty($excerptPadding['left'])) {
                        $excerptStyles .= 'padding: ' .
                            (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) . ' ' .
                            (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) . ' ' .
                            (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) . ' ' .
                            (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) . '; ';
                    }

                    // Handle hover logic conditionally
                    $hoverIn = '';
                    $hoverOut = '';

                    if (!empty($excerptHoverColor)) {
                        $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                        $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                    }

                    if (!empty($excerptHoverBgColor)) {
                        $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                        $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                    }

                    if (!empty($excerptHoverBorderColor)) {
                        $hoverIn .= 'this.style.borderColor=\'' . esc_attr($excerptHoverBorderColor) . '\';';
                        $hoverOut .= 'this.style.borderColor=\'inherit\';';
                    }

                    $output .= '<p class="fpg-excerpt' . ' align-' . esc_attr($excerptAlignment) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                    if (!empty($hoverIn) || !empty($hoverOut)) {
                        $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                        $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                    }

                    $output .= '>';
                    $output .= '' . esc_html($excerpt) . '</p>';
                    
                }
                // Button Output                
                if ($showReadMoreButton) {
                    // Button wrapper styles
                    $buttonWrapperStyle = '';

                    // Margin
                    if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                        $buttonWrapperStyle .= 'margin: ' .
                            (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                            (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                            (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                            (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                    }

                    // Order
                    if (!empty($buttonOrder)) {
                        $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                    }
   
                    $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                    // Button inline styles
                    $buttonInlineStyles = '';

                    if (!empty($buttonTextColor)) {
                        $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                    }
                    if (!empty($buttonBackgroundColor)) {
                        $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                    }
                    if (!empty($buttonFontSize)) {
                        $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                    }
                    if (!empty($buttonFontWeight)) {
                        $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                    }
                    if (!empty($buttonBorderColor)) {
                        $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                    }
                    if (!empty($buttonBorderType)) {
                        $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                    }

                    // Border width
                    
                    if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                        $buttonInlineStyles .= 'border-width: ' .
                            (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                            (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                            (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                            (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                    }
                    if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                        $buttonInlineStyles .= 'border-radius: ' .
                            (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                            (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                            (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                            (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                    }
                    if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                        $buttonInlineStyles .= 'padding: ' .
                            (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                            (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                            (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                            (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                    }

                    // Hover styles
                    $buttonHoverInlineStyles = '';
                    $buttonResetStyles = '';

                    if (!empty($buttonHoverTextColor)) {
                        $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                        $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                    }
                    if (!empty($buttonHoverBorderColor)) {
                        $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                        $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                    }
                    if (!empty($buttonHoverBackgroundColor)) {
                        $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                        $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                    }

                    // Button anchor tag
                    $output .= '<a class="rs-btn read-more ' . esc_attr($buttonStyle12) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                    if (!empty($buttonHoverInlineStyles)) {
                        $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                    }

                    if (!empty($buttonResetStyles)) {
                        $output .= ' onmouseout="' . $buttonResetStyles . '"';
                    }

                    $output .= '>';

                    // Icon handling
                    $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                    $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                    $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                    if ($iconPosition === 'left' && $showButtonIcon) {
                        $output .= $leftIcon . ' ';
                    }

                    $output .= esc_html($readMoreLabel);

                    if ($iconPosition === 'right' && $showButtonIcon) {
                        $output .= ' ' . $rightIcon;
                    }

                    $output .= '</a></div>';
                }
                // End Button

                $output .= '</div>';
                // End MAIN Content
                $output .= '</div>';
                // End Full post layout
            }
        }
        
        $output .= '</div>'; // End .fancy-post-grid


        if ($enablePagination) {
            // Generate individual style strings
            $margin = 
                (isset($paginationMarginNew['top']) && $paginationMarginNew['top'] !== '' ? (is_numeric($paginationMarginNew['top']) ? $paginationMarginNew['top'] . 'px' : esc_attr($paginationMarginNew['top'])) : '0px') . ' ' .
                (isset($paginationMarginNew['right']) && $paginationMarginNew['right'] !== '' ? (is_numeric($paginationMarginNew['right']) ? $paginationMarginNew['right'] . 'px' : esc_attr($paginationMarginNew['right'])) : '0px') . ' ' .
                (isset($paginationMarginNew['bottom']) && $paginationMarginNew['bottom'] !== '' ? (is_numeric($paginationMarginNew['bottom']) ? $paginationMarginNew['bottom'] . 'px' : esc_attr($paginationMarginNew['bottom'])) : '0px') . ' ' .
                (isset($paginationMarginNew['left']) && $paginationMarginNew['left'] !== '' ? (is_numeric($paginationMarginNew['left']) ? $paginationMarginNew['left'] . 'px' : esc_attr($paginationMarginNew['left'])) : '0px');

            $borderWidth = 
                (isset($paginationBorderWidthNew['top']) && $paginationBorderWidthNew['top'] !== '' ? (is_numeric($paginationBorderWidthNew['top']) ? $paginationBorderWidthNew['top'] . 'px' : esc_attr($paginationBorderWidthNew['top'])) : '0px') . ' ' .
                (isset($paginationBorderWidthNew['right']) && $paginationBorderWidthNew['right'] !== '' ? (is_numeric($paginationBorderWidthNew['right']) ? $paginationBorderWidthNew['right'] . 'px' : esc_attr($paginationBorderWidthNew['right'])) : '0px') . ' ' .
                (isset($paginationBorderWidthNew['bottom']) && $paginationBorderWidthNew['bottom'] !== '' ? (is_numeric($paginationBorderWidthNew['bottom']) ? $paginationBorderWidthNew['bottom'] . 'px' : esc_attr($paginationBorderWidthNew['bottom'])) : '0px') . ' ' .
                (isset($paginationBorderWidthNew['left']) && $paginationBorderWidthNew['left'] !== '' ? (is_numeric($paginationBorderWidthNew['left']) ? $paginationBorderWidthNew['left'] . 'px' : esc_attr($paginationBorderWidthNew['left'])) : '0px');

            $borderRadius = 
                (isset($paginationBorderRadius['top']) && $paginationBorderRadius['top'] !== '' ? (is_numeric($paginationBorderRadius['top']) ? $paginationBorderRadius['top'] . 'px' : esc_attr($paginationBorderRadius['top'])) : '0px') . ' ' .
                (isset($paginationBorderRadius['right']) && $paginationBorderRadius['right'] !== '' ? (is_numeric($paginationBorderRadius['right']) ? $paginationBorderRadius['right'] . 'px' : esc_attr($paginationBorderRadius['right'])) : '0px') . ' ' .
                (isset($paginationBorderRadius['bottom']) && $paginationBorderRadius['bottom'] !== '' ? (is_numeric($paginationBorderRadius['bottom']) ? $paginationBorderRadius['bottom'] . 'px' : esc_attr($paginationBorderRadius['bottom'])) : '0px') . ' ' .
                (isset($paginationBorderRadius['left']) && $paginationBorderRadius['left'] !== '' ? (is_numeric($paginationBorderRadius['left']) ? $paginationBorderRadius['left'] . 'px' : esc_attr($paginationBorderRadius['left'])) : '0px');

            $padding = 
                (isset($paginationPaddingNew['top']) && $paginationPaddingNew['top'] !== '' ? (is_numeric($paginationPaddingNew['top']) ? $paginationPaddingNew['top'] . 'px' : esc_attr($paginationPaddingNew['top'])) : '0px') . ' ' .
                (isset($paginationPaddingNew['right']) && $paginationPaddingNew['right'] !== '' ? (is_numeric($paginationPaddingNew['right']) ? $paginationPaddingNew['right'] . 'px' : esc_attr($paginationPaddingNew['right'])) : '0px') . ' ' .
                (isset($paginationPaddingNew['bottom']) && $paginationPaddingNew['bottom'] !== '' ? (is_numeric($paginationPaddingNew['bottom']) ? $paginationPaddingNew['bottom'] . 'px' : esc_attr($paginationPaddingNew['bottom'])) : '0px') . ' ' .
                (isset($paginationPaddingNew['left']) && $paginationPaddingNew['left'] !== '' ? (is_numeric($paginationPaddingNew['left']) ? $paginationPaddingNew['left'] . 'px' : esc_attr($paginationPaddingNew['left'])) : '0px');



            $gap = is_numeric($paginationGap) ? $paginationGap . 'px' : esc_attr($paginationGap);
            $fontSize = is_numeric($paginationFontSize) ? $paginationFontSize . 'px' : esc_attr($paginationFontSize);

            // Pagination wrapper
            $output .= '<div class="fpg-pagination" style="display: flex; justify-content: ' . esc_attr($paginationAlignment) . '; margin: ' . $margin . ';">';

            // UL
            $output .= '<ul class="page-numbers" style=" gap: ' . $gap . ';">';

            // Generate links
            $pagination_links = paginate_links(array(
                'total'     => $query->max_num_pages,
                'current'   => $paged,
                'format'    => '?paged=%#%',
                'prev_text' => esc_html__('« Prev', 'fancy-post-grid'),
                'next_text' => esc_html__('Next »', 'fancy-post-grid'),
                'type'      => 'array',
            ));

            if (!empty($pagination_links)) {
                foreach ($pagination_links as $link) {
                    $styled_link = preg_replace_callback(
                        '/<(a|span)([^>]*)>/',
                        function ($matches) use (
                            $borderWidth, $paginationBorderStyle, $paginationBorderColor, $borderRadius,$padding,
                            $paginationTextColor, $paginationBackgroundColor,
                            $paginationHoverTextColor, $paginationHoverBackgroundColor, $paginationHoverBorderColor,
                            $paginationActiveTextColor, $paginationActiveBackgroundColor, $paginationActiveBorderColor,$fontSize
                        ) {
                            $tag = $matches[1];
                            $attrs = $matches[2];

                            $is_current = strpos($attrs, 'current') !== false;

                            // Base style
                            $style = '';
                            $style .= 'font-size:' . esc_attr($fontSize) . '; ';
                            $style .= 'border-width:' . esc_attr($borderWidth) . '; ';
                            $style .= 'border-style:' . esc_attr($paginationBorderStyle) . '; ';
                            $style .= 'border-color:' . esc_attr($is_current ? $paginationActiveBorderColor : $paginationBorderColor) . '; ';
                            $style .= 'border-radius:' . esc_attr($borderRadius) . '; ';
                            $style .= 'padding:' . esc_attr($padding) . '; ';
                            $style .= 'color:' . esc_attr($is_current ? $paginationActiveTextColor : $paginationTextColor) . '; ';
                            $style .= 'background-color:' . esc_attr($is_current ? $paginationActiveBackgroundColor : $paginationBackgroundColor) . '; ';
                            

                            // Hover style via JS
                            $hover = 'this.style.color=\'' . esc_attr($paginationHoverTextColor) . '\';' .
                                     'this.style.backgroundColor=\'' . esc_attr($paginationHoverBackgroundColor) . '\';' .
                                     'this.style.borderColor=\'' . esc_attr($paginationHoverBorderColor) . '\';';

                            $out = '<' . $tag . $attrs . ' style="' . $style . '"';
                            if (!$is_current) {
                                $out .= ' onmouseover="' . $hover . '"';
                                // Reset on mouseout
                                $out .= ' onmouseout="this.style.color=\'' . esc_attr($paginationTextColor) . '\';' .
                                        'this.style.backgroundColor=\'' . esc_attr($paginationBackgroundColor) . '\';' .
                                        'this.style.borderColor=\'' . esc_attr($paginationBorderColor) . '\';"';
                            }
                            $out .= '>';
                            return $out;
                        },
                        $link
                    );

                    $output .= '<li>' . $styled_link . '</li>';
                }
            }

            $output .= '</ul>';
            $output .= '</div>';
        }

    wp_reset_postdata();

    return $output;
}

function fancy_post_slider_render_callback($attributes) {
    // Content Layout

    $sliderLayoutStyle = isset($attributes['sliderLayoutStyle']) ? $attributes['sliderLayoutStyle'] : 'style1';
    $gridColumns = isset($attributes['gridColumns']) ? absint($attributes['gridColumns']) : 3;
    //Query Builder
    $selectedCategory = isset($attributes['selectedCategory']) ? sanitize_text_field($attributes['selectedCategory']) : '';
    $selectedTag = isset($attributes['selectedTag']) ? sanitize_text_field($attributes['selectedTag']) : '';
    $orderBy = isset($attributes['orderBy']) ? sanitize_text_field($attributes['orderBy']) : 'title';
    $postLimit = isset($attributes['postLimit']) ? absint($attributes['postLimit']) : 9;
      
    // Pagination settings
    $enablePagination = isset($attributes['enablePagination']) ? filter_var($attributes['enablePagination'], FILTER_VALIDATE_BOOLEAN) : true;
    $enableArrow = isset($attributes['enableArrow']) ? filter_var($attributes['enableArrow'], FILTER_VALIDATE_BOOLEAN) : true;
    $enableKeyboard = isset($attributes['enableKeyboard']) ? filter_var($attributes['enableKeyboard'], FILTER_VALIDATE_BOOLEAN) : true;
    $enableLoop = isset($attributes['enableLoop']) ? filter_var($attributes['enableLoop'], FILTER_VALIDATE_BOOLEAN) : true;
    $enableFreeMode = isset($attributes['enableFreeMode']) ? filter_var($attributes['enableFreeMode'], FILTER_VALIDATE_BOOLEAN) : true;
    $paginationClickable = isset($attributes['paginationClickable']) ? filter_var($attributes['paginationClickable'], FILTER_VALIDATE_BOOLEAN) : true;
    $paginationType = isset($attributes['paginationType']) ? sanitize_text_field($attributes['paginationType']) : 'bullets';
    $autoPlaySpeed = isset($attributes['autoPlaySpeed']) ? absint($attributes['autoPlaySpeed']) : 3000;

    // Links
    $postLinkTarget = isset($attributes['postLinkTarget']) ? sanitize_text_field($attributes['postLinkTarget']) : 'newWindow';
    $thumbnailLink = isset($attributes['thumbnailLink']) ? filter_var($attributes['thumbnailLink'], FILTER_VALIDATE_BOOLEAN) : true;
    $postLinkType = isset($attributes['postLinkType']) ? sanitize_text_field($attributes['postLinkType']) : 'yeslink';

    // Field Selector
    $showPostTitle = isset($attributes['showPostTitle']) ? filter_var($attributes['showPostTitle'], FILTER_VALIDATE_BOOLEAN) : true;
    $showThumbnail = isset($attributes['showThumbnail']) ? filter_var($attributes['showThumbnail'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostExcerpt = isset($attributes['showPostExcerpt']) ? filter_var($attributes['showPostExcerpt'], FILTER_VALIDATE_BOOLEAN) : true;
    $showReadMoreButton = isset($attributes['showReadMoreButton']) ? filter_var($attributes['showReadMoreButton'], FILTER_VALIDATE_BOOLEAN) : true;
    $showMetaData = isset($attributes['showMetaData']) ? filter_var($attributes['showMetaData'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostDate = isset($attributes['showPostDate']) ? filter_var($attributes['showPostDate'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostAuthor = isset($attributes['showPostAuthor']) ? filter_var($attributes['showPostAuthor'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostCategory = isset($attributes['showPostCategory']) ? filter_var($attributes['showPostCategory'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostTags = isset($attributes['showPostTags']) ? filter_var($attributes['showPostTags'], FILTER_VALIDATE_BOOLEAN) : false;
    $showPostCommentsCount = isset($attributes['showPostCommentsCount']) ? filter_var($attributes['showPostCommentsCount'], FILTER_VALIDATE_BOOLEAN) : false;
    $showMetaIcon = isset($attributes['showMetaIcon']) ? filter_var($attributes['showMetaIcon'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostDateIcon = isset($attributes['showPostDateIcon']) ? filter_var($attributes['showPostDateIcon'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostAuthorIcon = isset($attributes['showPostAuthorIcon']) ? filter_var($attributes['showPostAuthorIcon'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostCategoryIcon = isset($attributes['showPostCategoryIcon']) ? filter_var($attributes['showPostCategoryIcon'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostTagsIcon = isset($attributes['showPostTagsIcon']) ? filter_var($attributes['showPostTagsIcon'], FILTER_VALIDATE_BOOLEAN) : false;
    $showPostCommentsCountIcon = isset($attributes['showPostCommentsCountIcon']) ? filter_var($attributes['showPostCommentsCountIcon'], FILTER_VALIDATE_BOOLEAN) : false;

    // Order values
    $metaOrder = isset($attributes['metaOrder']) ? absint($attributes['metaOrder']) : '';
    $titleOrder = isset($attributes['titleOrder']) ? absint($attributes['titleOrder']) : '';
    $excerptOrder = isset($attributes['excerptOrder']) ? absint($attributes['excerptOrder']) : '';
    $buttonOrder = isset($attributes['buttonOrder']) ? absint($attributes['buttonOrder']) : '';

    // Post title settings
    $titleTag               = isset($attributes['titleTag']) ? sanitize_text_field($attributes['titleTag']) : 'h3';
    $titleHoverUnderLine    = isset($attributes['titleHoverUnderLine']) ? sanitize_text_field($attributes['titleHoverUnderLine']) : 'enable';
    $titleCropBy            = isset($attributes['titleCropBy']) ? sanitize_text_field($attributes['titleCropBy']) : 'word';
    $titleLength            = isset($attributes['titleLength']) ? absint($attributes['titleLength']) : 12;
    
    //THUMB sETTINGS
    $thumbnailSize = isset($attributes['thumbnailSize']) ? sanitize_text_field($attributes['thumbnailSize']) : '';
    $hoverAnimation = isset($attributes['hoverAnimation']) ? sanitize_text_field($attributes['hoverAnimation']) : 'hover-zoom_in';
    // Excerpt Settings
    $excerptType = isset($attributes['excerptType']) ? sanitize_text_field($attributes['excerptType']) : 'word';
    $excerptIndicator = isset($attributes['excerptIndicator']) ? sanitize_text_field($attributes['excerptIndicator']) : '...';
    $excerptLimit = isset($attributes['excerptLimit']) ? absint($attributes['excerptLimit']) : 10;
    // Meta data Settings
    $metaAuthorPrefix = isset($attributes['metaAuthorPrefix']) ? sanitize_text_field($attributes['metaAuthorPrefix']) : __('By', 'fancy-post-grid');
    $metaSeperator = isset($attributes['metaSeperator']) ? sanitize_text_field($attributes['metaSeperator']) : '';
    //Button Settings   
    $showButtonIcon = isset($attributes['showButtonIcon']) ? filter_var($attributes['showPostCommentsCountIcon'], FILTER_VALIDATE_BOOLEAN) : true;
    $iconPosition = isset($attributes['iconPosition']) ? sanitize_text_field($attributes['iconPosition']) : 'right';
    $buttonStyle = isset($attributes['buttonStyle']) ? sanitize_text_field($attributes['buttonStyle']) : '';
    $readMoreLabel = isset($attributes['readMoreLabel']) ? sanitize_text_field($attributes['readMoreLabel']) : __('Read More', 'fancy-post-grid');
    // SECTION Area
    $sectionBgColor    = isset($attributes['sectionBgColor']) ? sanitize_hex_color($attributes['sectionBgColor']) : '';
    $sectionMargin = isset($attributes['sectionMargin']) ? $attributes['sectionMargin'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $sectionPadding = isset($attributes['sectionPadding']) ? $attributes['sectionPadding'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    // ITEM Box
    $itemPadding = isset($attributes['itemPadding']) ? $attributes['itemPadding'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $itemMargin = isset($attributes['itemMargin']) ? $attributes['itemMargin'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $itemBorderRadius = isset($attributes['itemBorderRadius']) ? $attributes['itemBorderRadius'] : ['top' => '5', 'right' => '5', 'bottom' => '5', 'left' => '5'];
    $itemBorderWidth = isset($attributes['itemBorderWidth']) ? $attributes['itemBorderWidth'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $itemBoxAlignment   = isset($attributes['itemBoxAlignment']) ? sanitize_text_field($attributes['itemBoxAlignment']) : 'start';
    $itemBorderType     = isset($attributes['itemBorderType']) ? sanitize_text_field($attributes['itemBorderType']) : '';
    $itemBoxShadow = isset($attributes['itemBoxShadow']) ? $attributes['itemBoxShadow'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
    $itemBackgroundColor = isset($attributes['itemBackgroundColor']) ? sanitize_hex_color($attributes['itemBackgroundColor']) : '';
    $itemBorderColor    = isset($attributes['itemBorderColor']) ? sanitize_hex_color($attributes['itemBorderColor']) : '';   
    $itemBoxShadowColor = isset($attributes['itemBoxShadowColor']) ? sanitize_hex_color($attributes['itemBoxShadowColor']) : '';
    $itemGap      = isset($attributes['itemGap']) ? absint($attributes['itemGap']) : 30;

    // Content Box
    $contentitemPaddingNew = isset($attributes['contentitemPaddingNew']) ? $attributes['contentitemPaddingNew'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $contentitemMarginNew = isset($attributes['contentitemMarginNew']) ? $attributes['contentitemMarginNew'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $contentBorderWidth = isset($attributes['contentBorderWidth']) ? $attributes['contentBorderWidth'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $contentNormalBorderType = isset($attributes['contentnormalBorderType']) ? sanitize_text_field($attributes['contentnormalBorderType']) : '';
    $contentBgColor    = isset($attributes['contentBgColor']) ? sanitize_hex_color($attributes['contentBgColor']) : '';   
    $contentBorderColor = isset($attributes['contentBorderColor']) ? sanitize_hex_color($attributes['contentBorderColor']) : '';
    // Thumbnail
    $thumbnailMargin = isset($attributes['thumbnailMargin']) ? $attributes['thumbnailMargin'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $thumbnailPadding = isset($attributes['thumbnailPadding']) ? $attributes['thumbnailPadding'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $thumbnailBorderRadius = isset($attributes['thumbnailBorderRadius']) ? $attributes['thumbnailBorderRadius'] : ['top' => '5', 'right' => '5', 'bottom' => '5', 'left' => '5'];

    // Post Title
    $postTitleFontSize      = isset($attributes['postTitleFontSize']) ? absint($attributes['postTitleFontSize']) : 24;
    $postTitleLineHeight    = isset($attributes['postTitleLineHeight']) ? floatval($attributes['postTitleLineHeight']) : '';
    $postTitleLetterSpacing = isset($attributes['postTitleLetterSpacing']) ? floatval($attributes['postTitleLetterSpacing']) : '';
    $postTitleFontWeight    = isset($attributes['postTitleFontWeight']) ? sanitize_text_field($attributes['postTitleFontWeight']) : '600';
    $postTitleAlignment     = isset($attributes['postTitleAlignment']) ? sanitize_text_field($attributes['postTitleAlignment']) : 'start';
    $postTitleColor         = isset($attributes['postTitleColor']) ? sanitize_hex_color($attributes['postTitleColor']) : '';
    $postTitleBgColor       = isset($attributes['postTitleBgColor']) ? sanitize_hex_color($attributes['postTitleBgColor']) : ''; 
    $postTitleHoverColor    = isset($attributes['postTitleHoverColor']) ? sanitize_hex_color($attributes['postTitleHoverColor']) : '';
    $postTitleHoverBgColor  = isset($attributes['postTitleHoverBgColor']) ? sanitize_hex_color($attributes['postTitleHoverBgColor']) : '';
    $postTitleMargin  = isset($attributes['postTitleMargin']) ? array_map('sanitize_text_field', $attributes['postTitleMargin']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $postTitlePadding = isset($attributes['postTitlePadding']) ? array_map('sanitize_text_field', $attributes['postTitlePadding']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];

    // Excerpt
    $excerptFontSize = isset($attributes['excerptFontSize']) ? absint($attributes['excerptFontSize']) : '';
    $excerptLineHeight = isset($attributes['excerptLineHeight']) ? floatval($attributes['excerptLineHeight']) : '';
    $excerptLetterSpacing = isset($attributes['excerptLetterSpacing']) ? floatval($attributes['excerptLetterSpacing']) : '';
    $excerptFontWeight = isset($attributes['excerptFontWeight']) ? sanitize_text_field($attributes['excerptFontWeight']) : '';
    $excerptAlignment = isset($attributes['excerptAlignment']) ? sanitize_text_field($attributes['excerptAlignment']) : '';
    $excerptMargin = isset($attributes['excerptMargin']) ? array_map('sanitize_text_field', $attributes['excerptMargin']) : ['top' => '10', 'right' => '0', 'bottom' => '10', 'left' => '0'];
    $excerptPadding = isset($attributes['excerptPadding']) ? array_map('sanitize_text_field', $attributes['excerptPadding']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $excerptColor = isset($attributes['excerptColor']) ? sanitize_hex_color($attributes['excerptColor']) : '';
    $excerptBgColor = isset($attributes['excerptBgColor']) ? sanitize_hex_color($attributes['excerptBgColor']) : '';
    $excerptBorderType = isset($attributes['excerptBorderType']) ? sanitize_text_field($attributes['excerptBorderType']) : '';
    $excerptHoverColor = isset($attributes['excerptHoverColor']) ? sanitize_hex_color($attributes['excerptHoverColor']) : '';
    $excerptHoverBgColor = isset($attributes['excerptHoverBgColor']) ? sanitize_hex_color($attributes['excerptHoverBgColor']) : '';
    $excerptHoverBorderColor = isset($attributes['excerptHoverBorderColor']) ? sanitize_hex_color($attributes['excerptHoverBorderColor']) : '';

    // Meta Data Attributes
    $metaAlignment = isset($attributes['metaAlignment']) ? sanitize_text_field($attributes['metaAlignment']) : '';
    $metaMarginNew = isset($attributes['metaMarginNew']) ? $attributes['metaMarginNew'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $metaPadding = isset($attributes['metaPadding']) ? $attributes['metaPadding'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $metaTextColor = isset($attributes['metaTextColor']) ? sanitize_hex_color($attributes['metaTextColor']) : '';
    $separatorColor = isset($attributes['separatorColor']) ? sanitize_hex_color($attributes['separatorColor']) : '';
    $metaFontSize = isset($attributes['metaFontSize']) ? absint($attributes['metaFontSize']) : '15';
    $metaIconColor = isset($attributes['metaIconColor']) ? sanitize_hex_color($attributes['metaIconColor']) : '';
    
    // Button Alignment
    $buttonAlignment = isset($attributes['buttonAlignment']) ? sanitize_text_field($attributes['buttonAlignment']) : 'start';
    $buttonMarginNew = isset($attributes['buttonMarginNew']) ? array_map('sanitize_text_field', $attributes['buttonMarginNew']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $buttonPaddingNew = isset($attributes['buttonPaddingNew']) ? array_map('sanitize_text_field', $attributes['buttonPaddingNew']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $buttonFontSize = isset($attributes['buttonFontSize']) ? absint($attributes['buttonFontSize']) : '';
    $buttonBorderWidth = isset($attributes['buttonBorderWidth']) ? array_map('sanitize_text_field', $attributes['buttonBorderWidth']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $buttonFontWeight = isset($attributes['buttonFontWeight']) ? sanitize_text_field($attributes['buttonFontWeight']) : '';
    $buttonTextColor = isset($attributes['buttonTextColor']) ? sanitize_hex_color($attributes['buttonTextColor']) : '';
    $buttonBackgroundColor = isset($attributes['buttonBackgroundColor']) ? sanitize_hex_color($attributes['buttonBackgroundColor']) : '';
    $buttonBorderType = isset($attributes['buttonBorderType']) ? sanitize_text_field($attributes['buttonBorderType']) : '';
    $buttonBorderRadius = isset($attributes['buttonBorderRadius']) ? array_map('sanitize_text_field', $attributes['buttonBorderRadius']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
    $buttonHoverTextColor = isset($attributes['buttonHoverTextColor']) ? sanitize_hex_color($attributes['buttonHoverTextColor']) : '';
    $buttonHoverBackgroundColor = isset($attributes['buttonHoverBackgroundColor']) ? sanitize_hex_color($attributes['buttonHoverBackgroundColor']) : ''; 
    $buttonBorderColor = isset($attributes['buttonBorderColor']) ? sanitize_hex_color($attributes['buttonBorderColor']) : '';
    $buttonHoverBorderColor = isset($attributes['buttonHoverBorderColor']) ? sanitize_hex_color($attributes['buttonHoverBorderColor']) : '';

    $sliderDots = isset($attributes['sliderDots']) ? sanitize_hex_color($attributes['sliderDots']) : '';
    $sliderDotsActive = isset($attributes['sliderDotsActive']) ? sanitize_hex_color($attributes['sliderDotsActive']) : '';
    $arrowColor = isset($attributes['arrowColor']) ? sanitize_hex_color($attributes['arrowColor']) : '';
    $arrowHoverColor = isset($attributes['arrowHoverColor']) ? sanitize_hex_color($attributes['arrowHoverColor']) : '';
    $arrowBgColorr = isset($attributes['arrowBgColorr']) ? sanitize_hex_color($attributes['arrowBgColorr']) : '';
    $arrowBgHoverColor = isset($attributes['arrowBgHoverColor']) ? sanitize_hex_color($attributes['arrowBgHoverColor']) : '';
    $arrowFontSize = isset($attributes['arrowFontSize']) ? absint($attributes['arrowFontSize']) : '';
    $fractionCurrentColor = isset($attributes['fractionCurrentColor']) ? sanitize_hex_color($attributes['fractionCurrentColor']) : '';
    
    $fractionFontSize = isset($attributes['fractionFontSize']) ? absint($attributes['fractionFontSize']) : '';
    
    
    //END ATTRIBUTES
    
    $paged = (get_query_var('paged')) ? get_query_var('paged') : 1;

    $query_args = array(
        'post_type'      => 'post',
        'posts_per_page' => $postLimit,
        'paged'          => $paged,
        'orderby'        => $orderBy,
        'order'          => 'DESC', // Ensure ordering
    );

    // Filter by category (use 'cat' for category ID)
    if (!empty($selectedCategory) && is_numeric($selectedCategory)) {
        $query_args['cat'] = intval($selectedCategory); 
    }

    // Filter by tag (use 'tag__in' for tag IDs)
    if (!empty($selectedTag) && is_numeric($selectedTag)) {
        $query_args['tag__in'] = array(intval($selectedTag)); 
    }

    // thumbnailSize
    $thumbnailSize1 = ($sliderLayoutStyle === 'style1' && $thumbnailSize == null)
              ? 'fancy_post_custom_size' : $thumbnailSize; 
    $thumbnailSize2 = ($sliderLayoutStyle === 'style2' && $thumbnailSize == null)
              ? 'fancy_post_custom_size' : $thumbnailSize; 
    $thumbnailSize3 = ($sliderLayoutStyle === 'style3' && $thumbnailSize == null)
              ? 'fancy_post_custom_size' : $thumbnailSize; 
    $thumbnailSize4 = ($sliderLayoutStyle === 'style4' && $thumbnailSize == null)
              ? 'fancy_post_landscape' : $thumbnailSize; 
    $thumbnailSize5 = ($sliderLayoutStyle === 'style5' && $thumbnailSize == null)
              ? 'fancy_post_square' : $thumbnailSize; 
    $thumbnailSize6 = ($sliderLayoutStyle === 'style6' && $thumbnailSize == null)
              ? 'fancy_post_square' : $thumbnailSize; 
    $thumbnailSize7 = ($sliderLayoutStyle === 'style7' && $thumbnailSize == null)
              ? 'fancy_post_landscape' : $thumbnailSize;
    // MetaAlignment
    $metaAlignment1 = ($sliderLayoutStyle === 'style1' && $metaAlignment == null)
              ? 'start' : $metaAlignment; 
    $metaAlignment2 = ($sliderLayoutStyle === 'style2' && $metaAlignment == null)
              ? 'start' : $metaAlignment; 
    $metaAlignment3 = ($sliderLayoutStyle === 'style3' && $metaAlignment == null)
              ? 'center' : $metaAlignment; 
    $metaAlignment4 = ($sliderLayoutStyle === 'style4' && $metaAlignment == null)
              ? 'center' : $metaAlignment; 
    $metaAlignment5 = ($sliderLayoutStyle === 'style5' && $metaAlignment == null)
              ? 'start' : $metaAlignment; 
    $metaAlignment6 = ($sliderLayoutStyle === 'style6' && $metaAlignment == null)
              ? 'start' : $metaAlignment; 
    $metaAlignment7 = ($sliderLayoutStyle === 'style7' && $metaAlignment == null)
              ? 'end' : $metaAlignment; 
    // ExcerptAlignment
    $excerptAlignment1 = ($sliderLayoutStyle === 'style1' && $excerptAlignment == null)
              ? 'start' : $excerptAlignment; 
    $excerptAlignment2 = ($sliderLayoutStyle === 'style2' && $excerptAlignment == null)
              ? 'start' : $excerptAlignment; 
    $excerptAlignment3 = ($sliderLayoutStyle === 'style3' && $excerptAlignment == null)
              ? 'center' : $excerptAlignment; 
    $excerptAlignment4 = ($sliderLayoutStyle === 'style4' && $excerptAlignment == null)
              ? 'center' : $excerptAlignment; 
    $excerptAlignment5 = ($sliderLayoutStyle === 'style5' && $excerptAlignment == null)
              ? 'start' : $excerptAlignment; 
    $excerptAlignment6 = ($sliderLayoutStyle === 'style6' && $excerptAlignment == null)
              ? 'start' : $excerptAlignment; 
    $excerptAlignment7 = ($sliderLayoutStyle === 'style7' && $excerptAlignment == null)
              ? 'start' : $excerptAlignment; 
    // buttonStyle
    $buttonStyle1 = ($sliderLayoutStyle === 'style1' && $buttonStyle == null)
              ? 'fpg-border' : $buttonStyle; 
    $buttonStyle2 = ($sliderLayoutStyle === 'style2' && $buttonStyle == null)
              ? 'fpg-flat' : $buttonStyle; 
    $buttonStyle3 = ($sliderLayoutStyle === 'style3' && $buttonStyle == null)
              ? 'fpg-filled' : $buttonStyle; 
    $buttonStyle4 = ($sliderLayoutStyle === 'style4' && $buttonStyle == null)
              ? 'fpg-flat' : $buttonStyle; 
    $buttonStyle5 = ($sliderLayoutStyle === 'style5' && $buttonStyle == null)
              ? 'fpg-flat' : $buttonStyle; 
    $buttonStyle6 = ($sliderLayoutStyle === 'style6' && $buttonStyle == null)
              ? 'fpg-border' : $buttonStyle; 
    $buttonStyle7 = ($sliderLayoutStyle === 'style7' && $buttonStyle == null)
              ? 'fpg-filled' : $buttonStyle; 
    
    // Run the query
    $query = new WP_Query($query_args);

    if (!$query->have_posts()) {
        return '<p>' . esc_html__('No posts found.', 'fancy-post-grid') . '</p>';
    }
    // Build swiper config array
    $swiper_config = array(
        'spaceBetween' => $itemGap,
        'slidesPerView' => $gridColumns, // Single slide
        'loop' => $enableLoop,
        'autoplay' => array(
            'delay' => (int)$autoPlaySpeed,
        ),
        'keyboard' => array(
            'enabled' => $enableKeyboard,
        ),
        'pagination' => array(
            'el'        => '.swiper-pagination-1,.swiper-pagination-2,.swiper-pagination-3,.swiper-pagination-4,.swiper-pagination-18,.swiper-pagination-23',
            'clickable' => $paginationClickable,
            'type'      => $paginationType, // map 'default' to 'bullets'
        ),
        'navigation' => array(
            'nextEl' => '.swiper-button-next',
            'prevEl' => '.swiper-button-prev',
        ),
    );

    // Convert to JSON
    $swiper_data_attr = esc_attr(wp_json_encode($swiper_config));
    $output = ''; // Initialize the variable first

    if ($sliderLayoutStyle === 'style1'){
    $output = '<div class="rs-blog-layout-1">';
    } else if ($sliderLayoutStyle === 'style2'){
        $output = '<div class="rs-blog-layout-2">';
    } else if ($sliderLayoutStyle === 'style3'){
        $output = '<div class="rs-blog-layout-3">';
    } else if ($sliderLayoutStyle === 'style4'){
        $output = '<div class="rs-blog-layout-4">';
    } else if ($sliderLayoutStyle === 'style5'){
        $output = '<div class="rs-blog-layout-18">';
    } else if ($sliderLayoutStyle === 'style6'){
        $output = '<div class="rs-blog-layout-23">';
    } else if ($sliderLayoutStyle === 'style7'){
        $output = '<div class="rs-blog-layout-28">';
    }
    $output .= '<div class="container">';
    $output .= '<div class="row">';
    $output .= '<div class="col-lg-12">';
    $output .= '<div class="swiper_wrap">';

    $style = '';

    if (!empty($sectionBgColor)) {
        $style .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
    }

    if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
        $style .= 'margin: ' . 
            (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
            (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
            (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
            (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
    }
    if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
        $style .= 'padding: ' . 
            (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
            (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
            (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
            (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
    }

    $output .= '<div class="swiper mySwiper" style="' . trim($style) . '" data-swiper=\'' . $swiper_data_attr . '\'>';    

    $output .= '<div class="swiper-wrapper">';

    // Loop through posts and add swiper-slide class
    while ($query->have_posts()) {
        $query->the_post();
        $post_id = get_the_ID();
        $permalink = get_permalink($post_id);
        $title = get_the_title();
        $getdate = get_the_date('M j, Y', $post_id);
        $date = get_the_date();
        $author = get_the_author();
        $categories = get_the_category_list(', ');
        $tags = get_the_tag_list('', ', ');
        $comments_count = get_comments_number();

        $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize, ['class' => 'fancy-post-thumbnail']);
        if ($sliderLayoutStyle === 'style1') {
        $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize1, ['class' => 'fancy-post-thumbnail']);}
        if ($sliderLayoutStyle === 'style2') {
        $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize2, ['class' => 'fancy-post-thumbnail']);}
        if ($sliderLayoutStyle === 'style3') {
        $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize3, ['class' => 'fancy-post-thumbnail']);}
        if ($sliderLayoutStyle === 'style4') {
        $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize4, ['class' => 'fancy-post-thumbnail']);}
        if ($sliderLayoutStyle === 'style5') {
        $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize5, ['class' => 'fancy-post-thumbnail']);}
        if ($sliderLayoutStyle === 'style6') {
        $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize6, ['class' => 'fancy-post-thumbnail']);}
        if ($sliderLayoutStyle === 'style7') {
        $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize7, ['class' => 'fancy-post-thumbnail']);}
        // Title Crop
        if ($titleCropBy === 'word') {
            $titleArray = explode(' ', $title);
            $croppedTitle = implode(' ', array_slice($titleArray, 0, (int) $titleLength));
        } elseif ($titleCropBy === 'cha') {
            $croppedTitle = mb_substr($title, 0, $titleLength);
        } else {
            $croppedTitle = $title; // fallback
        }
        // Fetch full content when 'full_content' is selected
        if ($excerptType === 'full_content') {
            $excerpt = apply_filters('the_content', get_the_content());
        } elseif ($excerptType === 'word') {
            $excerpt = wp_trim_words(get_the_excerpt(), $excerptLimit, $excerptIndicator);
        } else { // 'character'
            $excerpt = mb_substr(get_the_excerpt(), 0, $excerptLimit) . $excerptIndicator;
        }
        if ($sliderLayoutStyle === 'style1') {
            $output .= '<div class="swiper-slide">';
            // Full post layout
            $output .= '<div class="blog-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                // MARGIN    
                if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                    $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                } else { // Default fallback
                    $output .= 'margin: 40px 0px 0px 0px;';
                }

                // Padding
                if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                    $output .= 'padding: ' . 
                        (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                        (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                        (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                        (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                }

                // Border Radius
                if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                    $output .= 'border-radius: ' . 
                        (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                        (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                        (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                        (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                }

                // Border Width
                if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                    $output .= 'border-width: ' . 
                        (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                        (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                        (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                        (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                }

                // Border Style & Color
                if (!empty($itemBorderType)) {
                    $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                }
                if (!empty($itemBorderColor)) {
                    $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                }

                // Background Color
                if (!empty($itemBackgroundColor)) {
                    $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                }

                // Box Shadow
                if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                    $output .= 'box-shadow: ' . 
                        (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                        (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                        (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                        (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                        esc_attr($itemBoxShadowColor) . '; ';
                }

            $output .= '">';
            // Thumbnail
            if ($thumbnail && $showThumbnail) {
                $output .= '<div class="image-wrap shape-show" style="';

                // Margin
                if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                    $output .= 'margin: ' . 
                        (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                        (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                        (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                        (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                }

                // Padding
                if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                    $output .= 'padding: ' . 
                        (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                        (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                        (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                        (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                }

                $output .= '">';

                // Anchor with optional border-radius and overflow
                $output .= '<a href="' . esc_url($permalink) . '" style="';

                    if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                        $output .= ' border-radius: ' .
                            (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                    }

                $output .= '">';
                if ($thumbnailLink) {
                    $output .= '<a href="' . esc_url($permalink) . '">';
                    $output .= $thumbnail;
                    $output .= '</a>';
                } else {
                    $output .= $thumbnail;
                }
                $output .= '</div>';
            }
            // END Thumbnail
            
            // MAIN Content
            $output .= '<div class="blog-content" style="';
                // Margin
                if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                    $output .= 'margin: ' .
                        (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                        (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                        (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                        (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                }
                // Padding
                if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                    $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                } else { // Default fallback
                    $output .= 'padding: 27px 30px 34px 30px;';
                }
                // Check if at least one side is not empty
                if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                    $output .= 'border-width: ' .
                        (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                        (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                        (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                        (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                }
                // Border Style
                if (!empty($contentNormalBorderType)) {
                    $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                }
                // Background Color
                if (!empty($contentBgColor)) {
                    $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                }
                // Border Color
                if (!empty($contentBorderColor)) {
                    $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                }
            $output .= '">';

            // Meta Data
            if ($showMetaData) {
                    $output .= '<ul class="blog-meta align-' . $metaAlignment1 . ' " style="';  
                        // Margin
                        if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                            $output .= 'margin: ' .
                                (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                        }
                        // Padding
                        if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                            $output .= 'padding: ' .
                                (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                        }   
                        
                        // Color
                        if (!empty($metaTextColor)) {
                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                        }
                        // Order
                        if (!empty($metaOrder)) {
                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                        }
                    $output .= '">';

                    $meta_items = [];

                    // Date
                    if ($showPostDate) {
                        $meta = '<li class="meta-date" style="';

                        // Color
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        // Font size
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        // Icon
                        if ($showPostDateIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-calendar-alt" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($getdate) . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Author
                    if ($showPostAuthor) {
                        $meta = '<li class="meta-author" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostAuthorIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-user" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Category
                    if ($showPostCategory) {
                        $meta = '<li class="meta-categories" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCategoryIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-folder" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        // Get category names without links
                        $categories_list = get_the_category($post_id);
                        if (!empty($categories_list)) {
                            $category_names = array();
                            foreach ($categories_list as $category) {
                                $category_names[] = esc_html($category->name);
                            }
                            $meta .= implode(', ', $category_names); // comma-separated plain text categories
                        }

                        $meta .= '</li>';
                        $meta_items[] = $meta;
                    }
                    // Tags
                    if ($showPostTags && !empty($tags)) {
                        $meta = '<li class="meta-tags" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostTagsIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-tags" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Comment Count
                    if ($showPostCommentsCount) {
                        $meta = '<li class="meta-comment-count" style="';
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCommentsCountIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-comments" style="';
                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }
                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Now join meta items with the separator
                    if (!empty($meta_items)) {
                        $separator = '';

                        if ($metaSeperator !== '') {
                            $separator = '';
                            if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                $separatorStyle = '';
                                if (!empty($separatorColor)) {
                                    $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                            }
                        }

                        $output .= implode($separator, $meta_items);
                    }
                    $output .= '</ul>'; // Close meta-data-list               
                }
            // End Meta Data

            // title
            if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }
                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }
                    // Margin
                    if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .
                            (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                            (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                            (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                            (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                    }
                    // Padding
                    if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                            (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                            (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                            (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                    }
                    // Class name
                    $classNames = 'blog-title' 
                        . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                        . ' align-' . esc_attr($postTitleAlignment);
                    // Hover JS (conditionally included)
                    $onmouseover = !empty($postTitleHoverBgColor) 
                        ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                        : '';
                    $onmouseout = !empty($postTitleBgColor) 
                        ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                        : '';
                    // Final output
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                        . $onmouseover 
                        . $onmouseout 
                        . '>';

                    $style = '';
                    $hoverStyle = '';
                    $mouseoutStyle = '';

                    // Build inline styles conditionally
                    if (!empty($postTitleFontSize)) {
                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                    }
                    if (!empty($postTitleLineHeight)) {
                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                    }
                    if (!empty($postTitleLetterSpacing)) {
                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                    }
                    if (!empty($postTitleFontWeight)) {
                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                    }
                    if (!empty($postTitleColor)) {
                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                    }
                    // Build hover color style if set
                    if (!empty($postTitleHoverColor)) {
                        $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                    }
                    // Final output
                    $output .= '<a href="' . esc_url($permalink) . '" 
                        style="' . esc_attr(trim($style)) . '"'
                        . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                        . esc_html($croppedTitle) . '</a>';    
                    $output .= '</' . esc_attr($titleTag) . '>';
                }

            // Excerpt
            if ($showPostExcerpt) {
                $excerptStyles = '';

                // Order
                if (!empty($excerptOrder)) {
                    $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                }

                // Typography
                if (!empty($excerptFontSize)) {
                    $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                }

                if (!empty($excerptLineHeight)) {
                    $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                }

                if (!empty($excerptLetterSpacing)) {
                    $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                }

                if (!empty($excerptFontWeight)) {
                    $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                }

                if (!empty($excerptColor)) {
                    $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                }

                if (!empty($excerptBgColor)) {
                    $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                }

                if (!empty($excerptBorderType)) {
                    $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                }

                // Margin
                if (!empty($excerptMargin['top']) || !empty($excerptMargin['right']) || !empty($excerptMargin['bottom']) || !empty($excerptMargin['left'])) {
                    $excerptStyles .= 'margin: ' .
                        (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) . ' ' .
                        (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) . ' ' .
                        (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) . ' ' .
                        (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) . '; ';
                }

                // Padding
                if (!empty($excerptPadding['top']) || !empty($excerptPadding['right']) || !empty($excerptPadding['bottom']) || !empty($excerptPadding['left'])) {
                    $excerptStyles .= 'padding: ' .
                        (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) . ' ' .
                        (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) . ' ' .
                        (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) . ' ' .
                        (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) . '; ';
                }

                // Handle hover logic conditionally
                $hoverIn = '';
                $hoverOut = '';

                if (!empty($excerptHoverColor)) {
                    $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                    $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                }

                if (!empty($excerptHoverBgColor)) {
                    $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                    $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                }

                if (!empty($excerptHoverBorderColor)) {
                    $hoverIn .= 'this.style.borderColor=\'' . esc_attr($excerptHoverBorderColor) . '\';';
                    $hoverOut .= 'this.style.borderColor=\'inherit\';';
                }

                $output .= '<div class="desc' . ' align-' . esc_attr($excerptAlignment1) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                if (!empty($hoverIn) || !empty($hoverOut)) {
                    $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                    $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                }

                $output .= '>';
                $output .= '<p>' . esc_html($excerpt) . '</p>';
                $output .= '</div>';
            }
            // End Excerpt

            // Button Output                
            if ($showReadMoreButton) {
                // Button wrapper styles
                $buttonWrapperStyle = '';

                // Margin
                if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                    $buttonWrapperStyle .= 'margin: ' .
                        (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                        (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                        (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                        (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                }

                // Order
                if (!empty($buttonOrder)) {
                    $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                }

               
                $output .= '<div class="blog-btn align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                // Button inline styles
                $buttonInlineStyles = '';

                if (!empty($buttonTextColor)) {
                    $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                }
                if (!empty($buttonBackgroundColor)) {
                    $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                }
                if (!empty($buttonFontSize)) {
                    $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                }
                if (!empty($buttonFontWeight)) {
                    $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                }
                if (!empty($buttonBorderColor)) {
                    $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                }
                if (!empty($buttonBorderType)) {
                    $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                }

                // Border width
                
                if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                    $buttonInlineStyles .= 'border-width: ' .
                        (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                        (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                        (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                        (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                }
                if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                    $buttonInlineStyles .= 'border-radius: ' .
                        (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                        (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                        (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                        (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                }
                if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                    $buttonInlineStyles .= 'padding: ' .
                        (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                        (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                        (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                        (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                }

                // Hover styles
                $buttonHoverInlineStyles = '';
                $buttonResetStyles = '';

                if (!empty($buttonHoverTextColor)) {
                    $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                    $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                }
                if (!empty($buttonHoverBorderColor)) {
                    $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                    $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                }
                if (!empty($buttonHoverBackgroundColor)) {
                    $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                    $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                }

                // Button anchor tag
                $output .= '<a class="rs-link read-more ' . esc_attr($buttonStyle1) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                if (!empty($buttonHoverInlineStyles)) {
                    $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                }

                if (!empty($buttonResetStyles)) {
                    $output .= ' onmouseout="' . $buttonResetStyles . '"';
                }

                $output .= '>';

                // Icon handling
                $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                    $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                    $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                if ($iconPosition === 'left' && $showButtonIcon) {
                    $output .= $leftIcon . ' ';
                }

                $output .= esc_html($readMoreLabel);

                if ($iconPosition === 'right' && $showButtonIcon) {
                    $output .= ' ' . $rightIcon;
                }

                $output .= '</a></div>';
            }
            // End Button

            $output .= '</div>';
            // End MAIN Content
            $output .= '</div>';
            // End Full post layout
            $output .= '</div>';
        }
        elseif ($sliderLayoutStyle === 'style2') {
            $output .= '<div class="swiper-slide">';
            // Full post layout
            $output .= '<div class="blog-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                // MARGIN    
                if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                    $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                } else { // Default fallback
                    $output .= 'margin: 40px 0px 0px 0px;';
                }

                // Padding
                if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                    $output .= 'padding: ' . 
                        (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                        (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                        (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                        (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                }

                // Border Radius
                if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                    $output .= 'border-radius: ' . 
                        (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                        (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                        (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                        (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                }

                // Border Width
                if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                    $output .= 'border-width: ' . 
                        (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                        (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                        (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                        (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                }

                // Border Style & Color
                if (!empty($itemBorderType)) {
                    $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                }
                if (!empty($itemBorderColor)) {
                    $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                }

                // Background Color
                if (!empty($itemBackgroundColor)) {
                    $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                }

                // Box Shadow
                if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                    $output .= 'box-shadow: ' . 
                        (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                        (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                        (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                        (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                        esc_attr($itemBoxShadowColor) . '; ';
                }

            $output .= '">';
            // Thumbnail
            if ($thumbnail && $showThumbnail) {
                $output .= '<div class="image-wrap shape-show" style="';

                // Margin
                if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                    $output .= 'margin: ' . 
                        (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                        (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                        (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                        (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                }

                // Padding
                if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                    $output .= 'padding: ' . 
                        (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                        (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                        (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                        (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                }

                $output .= '">';

                // Anchor with optional border-radius and overflow
                $output .= '<a href="' . esc_url($permalink) . '" style="';

                    if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                        $output .= ' border-radius: ' .
                            (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                    }

                $output .= '">';
                $output .= $thumbnail . '</a></div>';
            }
            // END Thumbnail
            
            // MAIN Content
            $output .= '<div class="blog-content" style="';
                // Margin
                if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                    $output .= 'margin: ' .
                        (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                        (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                        (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                        (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                }
                // Padding
                if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                    $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                } else { // Default fallback
                    $output .= 'padding: 20px 20px 20px 20px;';
                }
                // Check if at least one side is not empty
                if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                    $output .= 'border-width: ' .
                        (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                        (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                        (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                        (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                }
                // Border Style
                if (!empty($contentNormalBorderType)) {
                    $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                }
                // Background Color
                if (!empty($contentBgColor)) {
                    $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                }
                // Border Color
                if (!empty($contentBorderColor)) {
                    $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                }
            $output .= '">';
            // Meta Data
            if ($showMetaData) {
                $output .= '<ul class="blog-meta align-' . $metaAlignment2 . ' " style="';  
                    // Margin
                    if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                        $output .= 'margin: ' .
                            (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                            (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                            (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                            (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                    }
                    // Padding
                    if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                        $output .= 'padding: ' .
                            (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                            (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                            (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                            (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                    }   
                    
                    // Color
                    if (!empty($metaTextColor)) {
                        $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                    }
                    // Order
                    if (!empty($metaOrder)) {
                        $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                    }
                $output .= '">';

                $meta_items = [];

                // Date
                if ($showPostDate) {
                    $meta = '<li class="meta-date" style="';

                    // Color
                    if (!empty($metaTextColor)) {
                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                    }

                    // Font size
                    if (!empty($metaFontSize)) {
                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                    }

                    $meta .= '">';

                    // Icon
                    if ($showPostDateIcon && $showMetaIcon) {
                        $meta .= '<i class="fas fa-calendar-alt" style="';

                        if (!empty($metaIconColor)) {
                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '"></i> ';
                    }

                    $meta .= esc_html($getdate) . '</li>';
                    $meta_items[] = $meta;
                }
                // Author
                if ($showPostAuthor) {
                    $meta = '<li class="meta-author" style="';

                    if (!empty($metaTextColor)) {
                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                    }

                    if (!empty($metaFontSize)) {
                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                    }

                    $meta .= '">';

                    if ($showPostAuthorIcon && $showMetaIcon) {
                        $meta .= '<i class="fas fa-user" style="';

                        if (!empty($metaIconColor)) {
                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '"></i> ';
                    }

                    $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                    $meta_items[] = $meta;
                }
                // Category
                if ($showPostCategory) {
                    $meta = '<li class="meta-categories" style="';

                    if (!empty($metaTextColor)) {
                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                    }

                    if (!empty($metaFontSize)) {
                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                    }

                    $meta .= '">';

                    if ($showPostCategoryIcon && $showMetaIcon) {
                        $meta .= '<i class="fas fa-folder" style="';

                        if (!empty($metaIconColor)) {
                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '"></i> ';
                    }

                    // Get category names without links
                    $categories_list = get_the_category($post_id);
                    if (!empty($categories_list)) {
                        $category_names = array();
                        foreach ($categories_list as $category) {
                            $category_names[] = esc_html($category->name);
                        }
                        $meta .= implode(', ', $category_names); // comma-separated plain text categories
                    }

                    $meta .= '</li>';
                    $meta_items[] = $meta;
                }
                // Tags
                if ($showPostTags && !empty($tags)) {
                    $meta = '<li class="meta-tags" style="';

                    if (!empty($metaTextColor)) {
                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                    }

                    if (!empty($metaFontSize)) {
                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                    }

                    $meta .= '">';

                    if ($showPostTagsIcon && $showMetaIcon) {
                        $meta .= '<i class="fas fa-tags" style="';

                        if (!empty($metaIconColor)) {
                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '"></i> ';
                    }

                    $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                    $meta_items[] = $meta;
                }
                // Comment Count
                if ($showPostCommentsCount) {
                    $meta = '<li class="meta-comment-count" style="';
                    if (!empty($metaTextColor)) {
                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                    }
                    if (!empty($metaFontSize)) {
                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                    }

                    $meta .= '">';

                    if ($showPostCommentsCountIcon && $showMetaIcon) {
                        $meta .= '<i class="fas fa-comments" style="';
                        if (!empty($metaIconColor)) {
                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                        }
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }
                        $meta .= '"></i> ';
                    }

                    $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                    $meta_items[] = $meta;
                }
                // Now join meta items with the separator
                if (!empty($meta_items)) {
                    $separator = '';

                    if ($metaSeperator !== '') {
                        $separator = '';
                        if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                            $separatorStyle = '';
                            if (!empty($separatorColor)) {
                                $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                            }
                            if (!empty($metaFontSize)) {
                                $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                        }
                    }

                    $output .= implode($separator, $meta_items);
                }
                $output .= '</ul>'; // Close meta-data-list               
            }
            // End Meta Data

            // title
            if ($showPostTitle) {
                $titleStyles = '';

                // Order
                if (!empty($titleOrder)) {
                    $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                }
                // Background color
                if (!empty($postTitleBgColor)) {
                    $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                }
                // Margin
                if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                    $titleStyles .= 'margin: ' .
                        (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                        (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                        (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                        (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                }
                // Padding
                if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                    $titleStyles .= 'padding: ' .
                        (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                        (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                        (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                        (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                }
                // Class name
                $classNames = 'blog-title' 
                    . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                    . ' align-' . esc_attr($postTitleAlignment);
                // Hover JS (conditionally included)
                $onmouseover = !empty($postTitleHoverBgColor) 
                    ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                    : '';
                $onmouseout = !empty($postTitleBgColor) 
                    ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                    : '';
                // Final output
                $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                    . $onmouseover 
                    . $onmouseout 
                    . '>';

                $style = '';
                $hoverStyle = '';
                $mouseoutStyle = '';

                // Build inline styles conditionally
                if (!empty($postTitleFontSize)) {
                    $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                }
                if (!empty($postTitleLineHeight)) {
                    $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                }
                if (!empty($postTitleLetterSpacing)) {
                    $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                }
                if (!empty($postTitleFontWeight)) {
                    $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                }
                if (!empty($postTitleColor)) {
                    $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                    $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                }
                // Build hover color style if set
                if (!empty($postTitleHoverColor)) {
                    $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                }
                // Final output
                $output .= '<a href="' . esc_url($permalink) . '" 
                    style="' . esc_attr(trim($style)) . '"'
                    . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                    . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                    . esc_html($croppedTitle) . '</a>';    
                $output .= '</' . esc_attr($titleTag) . '>';
            }

            // Excerpt
            if ($showPostExcerpt) {
                $excerptStyles = '';

                // Order
                if (!empty($excerptOrder)) {
                    $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                }

                // Typography
                if (!empty($excerptFontSize)) {
                    $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                }

                if (!empty($excerptLineHeight)) {
                    $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                }

                if (!empty($excerptLetterSpacing)) {
                    $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                }

                if (!empty($excerptFontWeight)) {
                    $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                }

                if (!empty($excerptColor)) {
                    $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                }

                if (!empty($excerptBgColor)) {
                    $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                }

                if (!empty($excerptBorderType)) {
                    $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                }

                // Margin
                if (!empty($excerptMargin['top']) || !empty($excerptMargin['right']) || !empty($excerptMargin['bottom']) || !empty($excerptMargin['left'])) {
                    $excerptStyles .= 'margin: ' .
                        (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) . ' ' .
                        (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) . ' ' .
                        (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) . ' ' .
                        (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) . '; ';
                }

                // Padding
                if (!empty($excerptPadding['top']) || !empty($excerptPadding['right']) || !empty($excerptPadding['bottom']) || !empty($excerptPadding['left'])) {
                    $excerptStyles .= 'padding: ' .
                        (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) . ' ' .
                        (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) . ' ' .
                        (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) . ' ' .
                        (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) . '; ';
                }

                // Handle hover logic conditionally
                $hoverIn = '';
                $hoverOut = '';

                if (!empty($excerptHoverColor)) {
                    $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                    $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                }

                if (!empty($excerptHoverBgColor)) {
                    $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                    $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                }

                if (!empty($excerptHoverBorderColor)) {
                    $hoverIn .= 'this.style.borderColor=\'' . esc_attr($excerptHoverBorderColor) . '\';';
                    $hoverOut .= 'this.style.borderColor=\'inherit\';';
                }

                $output .= '<div class="desc' . ' align-' . esc_attr($excerptAlignment2) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                if (!empty($hoverIn) || !empty($hoverOut)) {
                    $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                    $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                }

                $output .= '>';
                $output .= '<p>' . esc_html($excerpt) . '</p>';
                $output .= '</div>';
            }
            // End Excerpt

            // Button Output                
            if ($showReadMoreButton) {
                // Button wrapper styles
                $buttonWrapperStyle = '';

                // Margin
                if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                    $buttonWrapperStyle .= 'margin: ' .
                        (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                        (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                        (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                        (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                }

                // Order
                if (!empty($buttonOrder)) {
                    $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                }
               
                $output .= '<div class="blog-btn align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                // Button inline styles
                $buttonInlineStyles = '';

                if (!empty($buttonTextColor)) {
                    $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                }
                if (!empty($buttonBackgroundColor)) {
                    $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                }
                if (!empty($buttonFontSize)) {
                    $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                }
                if (!empty($buttonFontWeight)) {
                    $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                }
                if (!empty($buttonBorderColor)) {
                    $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                }
                if (!empty($buttonBorderType)) {
                    $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                }

                // Border width
                if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                    $buttonInlineStyles .= 'border-width: ' .
                        (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                        (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                        (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                        (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                }
                if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                    $buttonInlineStyles .= 'border-radius: ' .
                        (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                        (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                        (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                        (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                }
                if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                    $buttonInlineStyles .= 'padding: ' .
                        (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                        (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                        (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                        (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                }

                // Hover styles
                $buttonHoverInlineStyles = '';
                $buttonResetStyles = '';

                if (!empty($buttonHoverTextColor)) {
                    $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                    $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                }
                if (!empty($buttonHoverBorderColor)) {
                    $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                    $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                }
                if (!empty($buttonHoverBackgroundColor)) {
                    $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                    $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                }

                // Button anchor tag
                $output .= '<a class="rs-link read-more ' . esc_attr($buttonStyle2) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                if (!empty($buttonHoverInlineStyles)) {
                    $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                }

                if (!empty($buttonResetStyles)) {
                    $output .= ' onmouseout="' . $buttonResetStyles . '"';
                }

                $output .= '>';

                // Icon handling
                $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                    $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                    $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                if ($iconPosition === 'left' && $showButtonIcon) {
                    $output .= $leftIcon . ' ';
                }

                $output .= esc_html($readMoreLabel);

                if ($iconPosition === 'right' && $showButtonIcon) {
                    $output .= ' ' . $rightIcon;
                }

                $output .= '</a></div>';
            }
            // End Button

            $output .= '</div>';
            // End MAIN Content
            $output .= '</div>';
            // End Full post layout
            $output .= '</div>';
        }
        elseif ($sliderLayoutStyle === 'style3') {
            $output .= '<div class="swiper-slide">';
            // Full post layout
            $output .= '<div class="rs-blog__single align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                // MARGIN    
                if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                    $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                } else { // Default fallback
                    $output .= 'margin: 40px 0px 0px 0px;';
                }

                // Padding
                if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                    $output .= 'padding: ' . 
                        (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                        (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                        (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                        (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                }

                // Border Radius
                if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                    $output .= 'border-radius: ' . 
                        (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                        (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                        (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                        (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                }

                // Border Width
                if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                    $output .= 'border-width: ' . 
                        (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                        (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                        (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                        (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                }

                // Border Style & Color
                if (!empty($itemBorderType)) {
                    $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                }
                if (!empty($itemBorderColor)) {
                    $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                }

                // Background Color
                if (!empty($itemBackgroundColor)) {
                    $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                }

                // Box Shadow
                if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                    $output .= 'box-shadow: ' . 
                        (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                        (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                        (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                        (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                        esc_attr($itemBoxShadowColor) . '; ';
                }

            $output .= '">';
            // Thumbnail
            if ($thumbnail && $showThumbnail) {
                $output .= '<div class="thumb" style="';

                // Margin
                if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                    $output .= 'margin: ' . 
                        (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                        (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                        (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                        (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                }

                // Padding
                if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                    $output .= 'padding: ' . 
                        (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                        (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                        (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                        (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                }

                $output .= '">';

                // Anchor with optional border-radius and overflow
                $output .= '<a href="' . esc_url($permalink) . '" style="';

                    if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                        $output .= ' border-radius: ' .
                            (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                    }

                $output .= '">';
                $output .= $thumbnail . '</a></div>';
            }
            // END Thumbnail
            
            // MAIN Content
            $output .= '<div class="content" style="';
                    // Margin
                    
                    if ( !empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) ||  !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                        $output .= 'margin: ' .(isset($contentitemMarginNew['top']) && $contentitemMarginNew['top'] !== '' ? (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) : '0px') . ' ' . (isset($contentitemMarginNew['right']) && $contentitemMarginNew['right'] !== '' ? (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) : '0px') . ' ' . (isset($contentitemMarginNew['bottom']) && $contentitemMarginNew['bottom'] !== '' ? (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) : '0px') . ' ' . (isset($contentitemMarginNew['left']) && $contentitemMarginNew['left'] !== '' ? (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'padding: -90px 0px 0px 0px;';
                    }
                    // Padding
                    if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                        $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'padding: 0px 20px 40px 20px;';
                    }
                    // Check if at least one side is not empty
                    if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                            (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                            (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                            (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';
            // Categories

            if ($showPostCategory) {
                $categories = get_the_category($post_id);
                if (!empty($categories)) {
                    $category = $categories[0]; // Show the first category only

                    $output .= '<div class="rs-blog-category">';
                    $output .= '<a href="' . esc_url(get_category_link($category->term_id)) . '">';
                    $output .= '<div class="icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="6" height="6" viewBox="0 0 6 6" fill="none">
                                        <path d="M3 0L5.59808 1.5V4.5L3 6L0.401924 4.5V1.5L3 0Z" fill="#513DE8"></path>
                                        <defs>
                                            <linearGradient x1="-3.93273e-08" y1="0.803572" x2="6.33755" y2="1.30989" gradientUnits="userSpaceOnUse">
                                                <stop stop-color="#513DE8" offset="1"></stop>
                                                <stop offset="1" stop-color="#8366E3"></stop>
                                            </linearGradient>
                                        </defs>
                                    </svg>
                                </div>';
                    $output .= esc_html($category->name);
                    $output .= '</a>';
                    $output .= '</div>';
                }
            }
   
            // title
            if ($showPostTitle) {
                $titleStyles = '';

                // Order
                if (!empty($titleOrder)) {
                    $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                }
                // Background color
                if (!empty($postTitleBgColor)) {
                    $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                }
                // Margin
                if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                    $titleStyles .= 'margin: ' .
                        (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                        (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                        (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                        (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                }
                // Padding
                if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                    $titleStyles .= 'padding: ' .
                        (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                        (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                        (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                        (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                }
                // Class name
                $classNames = 'title' 
                    . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                    . ' align-' . esc_attr($postTitleAlignment);
                // Hover JS (conditionally included)
                $onmouseover = !empty($postTitleHoverBgColor) 
                    ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                    : '';
                $onmouseout = !empty($postTitleBgColor) 
                    ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                    : '';
                // Final output
                $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                    . $onmouseover 
                    . $onmouseout 
                    . '>';

                $style = '';
                $hoverStyle = '';
                $mouseoutStyle = '';

                // Build inline styles conditionally
                if (!empty($postTitleFontSize)) {
                    $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                }
                if (!empty($postTitleLineHeight)) {
                    $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                }
                if (!empty($postTitleLetterSpacing)) {
                    $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                }
                if (!empty($postTitleFontWeight)) {
                    $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                }
                if (!empty($postTitleColor)) {
                    $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                    $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                }
                // Build hover color style if set
                if (!empty($postTitleHoverColor)) {
                    $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                }
                // Final output
                $output .= '<a href="' . esc_url($permalink) . '" 
                    style="' . esc_attr(trim($style)) . '"'
                    . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                    . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                    . esc_html($croppedTitle) . '</a>';    
                $output .= '</' . esc_attr($titleTag) . '>';
            }
            // Meta Data
            if ($showMetaData) {
                $output .= '<ul class="blog-meta align-' . $metaAlignment3 . ' " style="';  
                    // Margin
                    if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                        $output .= 'margin: ' .
                            (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                            (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                            (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                            (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                    }
                    // Padding
                    if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                        $output .= 'padding: ' .
                            (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                            (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                            (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                            (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                    }   
                    
                    // Color
                    if (!empty($metaTextColor)) {
                        $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                    }
                    // Order
                    if (!empty($metaOrder)) {
                        $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                    }
                $output .= '">';

                $meta_items = [];

                // Date
                if ($showPostDate) {
                    $meta = '<li class="meta-date" style="';

                    // Color
                    if (!empty($metaTextColor)) {
                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                    }

                    // Font size
                    if (!empty($metaFontSize)) {
                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                    }

                    $meta .= '">';

                    // Icon
                    if ($showPostDateIcon && $showMetaIcon) {
                        $meta .= '<i class="fas fa-calendar-alt" style="';

                        if (!empty($metaIconColor)) {
                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '"></i> ';
                    }

                    $meta .= esc_html($getdate) . '</li>';
                    $meta_items[] = $meta;
                }
                
                // Now join meta items with the separator
                if (!empty($meta_items)) {
                    $separator = '';

                    if ($metaSeperator !== '') {
                        $separator = '';
                        if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                            $separatorStyle = '';
                            if (!empty($separatorColor)) {
                                $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                            }
                            if (!empty($metaFontSize)) {
                                $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                        }
                    }

                    $output .= implode($separator, $meta_items);
                }
                $output .= '</ul>'; // Close meta-data-list               
            }
            // End Meta Data

            // Excerpt
            if ($showPostExcerpt) {
                $excerptStyles = '';

                // Order
                if (!empty($excerptOrder)) {
                    $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                }

                // Typography
                if (!empty($excerptFontSize)) {
                    $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                }

                if (!empty($excerptLineHeight)) {
                    $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                }

                if (!empty($excerptLetterSpacing)) {
                    $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                }

                if (!empty($excerptFontWeight)) {
                    $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                }

                if (!empty($excerptColor)) {
                    $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                }

                if (!empty($excerptBgColor)) {
                    $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                }

                if (!empty($excerptBorderType)) {
                    $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                }

                // Margin
                if (!empty($excerptMargin['top']) || !empty($excerptMargin['right']) || !empty($excerptMargin['bottom']) || !empty($excerptMargin['left'])) {
                    $excerptStyles .= 'margin: ' .
                        (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) . ' ' .
                        (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) . ' ' .
                        (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) . ' ' .
                        (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) . '; ';
                }

                // Padding
                if (!empty($excerptPadding['top']) || !empty($excerptPadding['right']) || !empty($excerptPadding['bottom']) || !empty($excerptPadding['left'])) {
                    $excerptStyles .= 'padding: ' .
                        (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) . ' ' .
                        (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) . ' ' .
                        (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) . ' ' .
                        (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) . '; ';
                }

                // Handle hover logic conditionally
                $hoverIn = '';
                $hoverOut = '';

                if (!empty($excerptHoverColor)) {
                    $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                    $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                }

                if (!empty($excerptHoverBgColor)) {
                    $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                    $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                }

                if (!empty($excerptHoverBorderColor)) {
                    $hoverIn .= 'this.style.borderColor=\'' . esc_attr($excerptHoverBorderColor) . '\';';
                    $hoverOut .= 'this.style.borderColor=\'inherit\';';
                }

                $output .= '<div class="desc' . ' align-' . esc_attr($excerptAlignment1) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                if (!empty($hoverIn) || !empty($hoverOut)) {
                    $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                    $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                }

                $output .= '>';
                $output .= '<p>' . esc_html($excerpt) . '</p>';
                $output .= '</div>';
            }
            // End Excerpt
            //Footer
            $output .= '<div class="rs-blog-author">';

                if ($showPostAuthor) {
                    $output .= '<div class="user">';
                    $output .= '<a href="' . esc_url(get_author_posts_url(get_the_author_meta('ID'))) . '">';
                    $output .= '<div class="author-thumb">';
                    $output .= get_avatar(get_the_author_meta('ID'), 32);
                    $output .= '</div>';
                    $output .= '<span>' . esc_html__('by', 'fancy-post-grid') . ' ' . get_the_author() . '</span>';
                    $output .= '</a>';
                    $output .= '</div>';
                }

                if ($showReadMoreButton) {
                    // Button wrapper styles
                    $buttonWrapperStyle = '';

                    // Margin
                    if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                        $buttonWrapperStyle .= 'margin: ' .
                            (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                            (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                            (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                            (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                    }

                    // Order
                    if (!empty($buttonOrder)) {
                        $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                    }

                   
                    $output .= '<div class="rs-link align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                    // Button inline styles
                    $buttonInlineStyles = '';

                    if (!empty($buttonTextColor)) {
                        $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                    }
                    if (!empty($buttonBackgroundColor)) {
                        $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                    }
                    if (!empty($buttonFontSize)) {
                        $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                    }
                    if (!empty($buttonFontWeight)) {
                        $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                    }
                    if (!empty($buttonBorderColor)) {
                        $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                    }
                    if (!empty($buttonBorderType)) {
                        $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                    }

                    // Border width
                    
                    if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                        $buttonInlineStyles .= 'border-width: ' .
                            (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                            (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                            (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                            (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                    }
                    if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                        $buttonInlineStyles .= 'border-radius: ' .
                            (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                            (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                            (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                            (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                    }
                    if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                        $buttonInlineStyles .= 'padding: ' .
                            (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                            (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                            (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                            (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                    }

                    // Hover styles
                    $buttonHoverInlineStyles = '';
                    $buttonResetStyles = '';

                    if (!empty($buttonHoverTextColor)) {
                        $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                        $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                    }
                    if (!empty($buttonHoverBorderColor)) {
                        $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                        $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                    }
                    if (!empty($buttonHoverBackgroundColor)) {
                        $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                        $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                    }

                    // Button anchor tag
                    $output .= '<a class="read-more ' . esc_attr($buttonStyle3) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                    if (!empty($buttonHoverInlineStyles)) {
                        $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                    }

                    if (!empty($buttonResetStyles)) {
                        $output .= ' onmouseout="' . $buttonResetStyles . '"';
                    }

                    $output .= '>';

                    // Icon handling
                    $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                    $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                    $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                    if ($iconPosition === 'left' && $showButtonIcon) {
                        $output .= $leftIcon . ' ';
                    }

                    $output .= esc_html($readMoreLabel);

                    if ($iconPosition === 'right' && $showButtonIcon) {
                        $output .= ' ' . $rightIcon;
                    }

                    $output .= '</a></div>';
                }

            $output .= '</div>';
            //end Footer
            $output .= '</div>';
            // End MAIN Content
            $output .= '</div>';
            // End Full post layout
            $output .= '</div>';
        }
        elseif ($sliderLayoutStyle === 'style4') {
            $output .= '<div class="swiper-slide">';
            // Full post layout
            $output .= '<div class="rs-blog__item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                // MARGIN    
                if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                    $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                } else { // Default fallback
                    $output .= 'margin: 40px 0px 0px 0px;';
                }

                // Padding
                if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                    $output .= 'padding: ' . 
                        (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                        (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                        (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                        (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                }

                // Border Radius
                if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                    $output .= 'border-radius: ' . 
                        (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                        (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                        (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                        (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                }

                // Border Width
                if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                    $output .= 'border-width: ' . 
                        (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                        (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                        (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                        (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                }

                // Border Style & Color
                if (!empty($itemBorderType)) {
                    $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                }
                if (!empty($itemBorderColor)) {
                    $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                }

                // Background Color
                if (!empty($itemBackgroundColor)) {
                    $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                }

                // Box Shadow
                if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                    $output .= 'box-shadow: ' . 
                        (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                        (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                        (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                        (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                        esc_attr($itemBoxShadowColor) . '; ';
                }

            $output .= '">';
            // Thumbnail
            if ($thumbnail && $showThumbnail) {
                $output .= '<div class="rs-thumb" style="';

                // Margin
                if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                    $output .= 'margin: ' . 
                        (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                        (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                        (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                        (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                }

                // Padding
                if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                    $output .= 'padding: ' . 
                        (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                        (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                        (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                        (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                }

                $output .= '">';

                // Anchor with optional border-radius and overflow
                $output .= '<a href="' . esc_url($permalink) . '" style="';

                    if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                        $output .= ' border-radius: ' .
                            (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                    }

                $output .= '">';
                $output .= $thumbnail . '</a></div>';
            }
            // END Thumbnail
            
            // MAIN Content
            $output .= '<div class="rs-content" style="';
                // Margin
                if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                    $output .= 'margin: ' .
                        (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                        (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                        (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                        (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                }
                // Padding
                if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                    $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                } else { // Default fallback
                    $output .= 'padding: 22px 30px 20px 30px;';
                }
                // Check if at least one side is not empty
                if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                    $output .= 'border-width: ' .
                        (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                        (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                        (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                        (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                }
                // Border Style
                if (!empty($contentNormalBorderType)) {
                    $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                }
                // Background Color
                if (!empty($contentBgColor)) {
                    $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                }
                // Border Color
                if (!empty($contentBorderColor)) {
                    $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                }
            $output .= '">';

            // Categories
            if ($showPostCategory) {
                $categories = get_the_category($post_id);
                if (!empty($categories)) {
                    $category = $categories[0]; // Show the first category only

                    $output .= '<div class="rs-category">';
                    $output .= '<a href="' . esc_url(get_category_link($category->term_id)) . '">';
                    
                    $output .= esc_html($category->name);
                    $output .= '</a>';
                    $output .= '</div>';
                }
            }
   
            // title
            if ($showPostTitle) {
                $titleStyles = '';

                // Order
                if (!empty($titleOrder)) {
                    $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                }
                // Background color
                if (!empty($postTitleBgColor)) {
                    $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                }
                // Margin
                if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                    $titleStyles .= 'margin: ' .
                        (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                        (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                        (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                        (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                }
                // Padding
                if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                    $titleStyles .= 'padding: ' .
                        (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                        (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                        (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                        (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                }
                // Class name
                $classNames = 'title' 
                    . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                    . ' align-' . esc_attr($postTitleAlignment);
                // Hover JS (conditionally included)
                $onmouseover = !empty($postTitleHoverBgColor) 
                    ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                    : '';
                $onmouseout = !empty($postTitleBgColor) 
                    ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                    : '';
                // Final output
                $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                    . $onmouseover 
                    . $onmouseout 
                    . '>';

                $style = '';
                $hoverStyle = '';
                $mouseoutStyle = '';

                // Build inline styles conditionally
                if (!empty($postTitleFontSize)) {
                    $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                }
                if (!empty($postTitleLineHeight)) {
                    $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                }
                if (!empty($postTitleLetterSpacing)) {
                    $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                }
                if (!empty($postTitleFontWeight)) {
                    $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                }
                if (!empty($postTitleColor)) {
                    $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                    $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                }
                // Build hover color style if set
                if (!empty($postTitleHoverColor)) {
                    $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                }
                // Final output
                $output .= '<a href="' . esc_url($permalink) . '" 
                    style="' . esc_attr(trim($style)) . '"'
                    . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                    . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                    . esc_html($croppedTitle) . '</a>';    
                $output .= '</' . esc_attr($titleTag) . '>';
            }

            // Excerpt
            if ($showPostExcerpt) {
                $excerptStyles = '';

                // Order
                if (!empty($excerptOrder)) {
                    $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                }

                // Typography
                if (!empty($excerptFontSize)) {
                    $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                }

                if (!empty($excerptLineHeight)) {
                    $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                }

                if (!empty($excerptLetterSpacing)) {
                    $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                }

                if (!empty($excerptFontWeight)) {
                    $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                }

                if (!empty($excerptColor)) {
                    $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                }

                if (!empty($excerptBgColor)) {
                    $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                }

                if (!empty($excerptBorderType)) {
                    $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                }

                // Margin
                if (!empty($excerptMargin['top']) || !empty($excerptMargin['right']) || !empty($excerptMargin['bottom']) || !empty($excerptMargin['left'])) {
                    $excerptStyles .= 'margin: ' .
                        (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) . ' ' .
                        (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) . ' ' .
                        (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) . ' ' .
                        (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) . '; ';
                }

                // Padding
                if (!empty($excerptPadding['top']) || !empty($excerptPadding['right']) || !empty($excerptPadding['bottom']) || !empty($excerptPadding['left'])) {
                    $excerptStyles .= 'padding: ' .
                        (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) . ' ' .
                        (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) . ' ' .
                        (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) . ' ' .
                        (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) . '; ';
                }

                // Handle hover logic conditionally
                $hoverIn = '';
                $hoverOut = '';

                if (!empty($excerptHoverColor)) {
                    $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                    $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                }

                if (!empty($excerptHoverBgColor)) {
                    $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                    $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                }

                if (!empty($excerptHoverBorderColor)) {
                    $hoverIn .= 'this.style.borderColor=\'' . esc_attr($excerptHoverBorderColor) . '\';';
                    $hoverOut .= 'this.style.borderColor=\'inherit\';';
                }

                $output .= '<div class="desc' . ' align-' . esc_attr($excerptAlignment1) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                if (!empty($hoverIn) || !empty($hoverOut)) {
                    $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                    $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                }

                $output .= '>';
                $output .= '<p>' . esc_html($excerpt) . '</p>';
                $output .= '</div>';
            }
            // End Excerpt
            
            //Footer
            $output .= '<div class="rs-blog-footer" style="order: ' . esc_attr($buttonOrder) . ';">';
                $meta = '<span class="meta-comment-count" style="';

                if (!empty($metaTextColor)) {
                    $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                }
                if (!empty($metaFontSize)) {
                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                }

                $meta .= '">';

                    // meta icon
                    $meta .= '<i class="fas fa-comments" style="';
                    if (!empty($metaIconColor)) {
                        $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                    }
                    if (!empty($metaFontSize)) {
                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                    }
                    $meta .= '"></i> ';
                

                $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</span>';
                $output .= $meta;

                

                if ($showReadMoreButton) {
                    // Button wrapper styles
                    $buttonWrapperStyle = '';

                    // Margin
                    if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                        $buttonWrapperStyle .= 'margin: ' .
                            (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                            (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                            (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                            (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                    }

                    // Order
                    if (!empty($buttonOrder)) {
                        $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                    }

                   
                    $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                    // Button inline styles
                    $buttonInlineStyles = '';

                    if (!empty($buttonTextColor)) {
                        $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                    }
                    if (!empty($buttonBackgroundColor)) {
                        $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                    }
                    if (!empty($buttonFontSize)) {
                        $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                    }
                    if (!empty($buttonFontWeight)) {
                        $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                    }
                    if (!empty($buttonBorderColor)) {
                        $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                    }
                    if (!empty($buttonBorderType)) {
                        $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                    }

                    // Border width
                    
                    if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                        $buttonInlineStyles .= 'border-width: ' .
                            (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                            (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                            (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                            (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                    }
                    if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                        $buttonInlineStyles .= 'border-radius: ' .
                            (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                            (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                            (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                            (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                    }
                    if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                        $buttonInlineStyles .= 'padding: ' .
                            (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                            (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                            (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                            (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                    }

                    // Hover styles
                    $buttonHoverInlineStyles = '';
                    $buttonResetStyles = '';

                    if (!empty($buttonHoverTextColor)) {
                        $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                        $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                    }
                    if (!empty($buttonHoverBorderColor)) {
                        $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                        $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                    }
                    if (!empty($buttonHoverBackgroundColor)) {
                        $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                        $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                    }

                    // Button anchor tag
                    $output .= '<a class="btn-link read-more ' . esc_attr($buttonStyle4) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                    if (!empty($buttonHoverInlineStyles)) {
                        $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                    }

                    if (!empty($buttonResetStyles)) {
                        $output .= ' onmouseout="' . $buttonResetStyles . '"';
                    }

                    $output .= '>';

                    // Icon handling
                    $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                    $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                    $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                    if ($iconPosition === 'left' && $showButtonIcon) {
                        $output .= $leftIcon . ' ';
                    }

                    $output .= esc_html($readMoreLabel);

                    if ($iconPosition === 'right' && $showButtonIcon) {
                        $output .= ' ' . $rightIcon;
                    }

                    $output .= '</a></div>';
                }

            $output .= '</div>';
            //end Footer
            $output .= '</div>';
            // End MAIN Content
            $output .= '</div>';
            // End Full post layout
            $output .= '</div>';
        }
        elseif ($sliderLayoutStyle === 'style5') {
            $output .= '<div class="swiper-slide">';
            // Full post layout
            $output .= '<div class="rs-blog-layout-18-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                // MARGIN    
                if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                    $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                } else { // Default fallback
                    $output .= 'margin: 40px 0px 0px 0px;';
                }

                // Padding
                if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                    $output .= 'padding: ' . 
                        (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                        (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                        (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                        (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                }

                // Border Radius
                if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                    $output .= 'border-radius: ' . 
                        (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                        (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                        (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                        (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                }

                // Border Width
                if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                    $output .= 'border-width: ' . 
                        (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                        (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                        (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                        (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                }

                // Border Style & Color
                if (!empty($itemBorderType)) {
                    $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                }
                if (!empty($itemBorderColor)) {
                    $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                }

                // Background Color
                if (!empty($itemBackgroundColor)) {
                    $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                }

                // Box Shadow
                if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                    $output .= 'box-shadow: ' . 
                        (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                        (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                        (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                        (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                        esc_attr($itemBoxShadowColor) . '; ';
                }

            $output .= '">';
            // Thumbnail
            if ($thumbnail && $showThumbnail) {
                $output .= '<div class="rs-thumb" style="';

                // Margin
                if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                    $output .= 'margin: ' . 
                        (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                        (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                        (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                        (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                }

                // Padding
                if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                    $output .= 'padding: ' . 
                        (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                        (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                        (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                        (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                }

                $output .= '">';

                // Anchor with optional border-radius and overflow
                $output .= '<a href="' . esc_url($permalink) . '" style="';

                    if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                        $output .= ' border-radius: ' .
                            (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                    }


                $output .= '">';
                $output .= $thumbnail . '</a></div>';
            }
            // END Thumbnail
            
            // MAIN Content
            $output .= '<div class="rs-content" style="';
                // Margin
                if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                    $output .= 'margin: ' .
                        (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                        (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                        (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                        (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                }
                // Padding
                if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                    $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                } else { // Default fallback
                    $output .= 'padding: 60px 25px 25px 25px;';
                }
                // Check if at least one side is not empty
                if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                    $output .= 'border-width: ' .
                        (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                        (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                        (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                        (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                }
                // Border Style
                if (!empty($contentNormalBorderType)) {
                    $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                }
                // Background Color
                if (!empty($contentBgColor)) {
                    $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                }
                // Border Color
                if (!empty($contentBorderColor)) {
                    $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                }
            $output .= '">';
            // Meta Data
            if ($showMetaData) {
                $output .='<div class="rs-meta">';  
                $output .= '<ul class="blog-meta align-' . $metaAlignment5 . ' " style="';  
                    // Margin
                    if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                        $output .= 'margin: ' .
                            (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                            (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                            (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                            (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                    }
                    // Padding
                    if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                        $output .= 'padding: ' .
                            (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                            (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                            (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                            (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                    }   
                    
                    // Color
                    if (!empty($metaTextColor)) {
                        $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                    }
                    // Order
                    if (!empty($metaOrder)) {
                        $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                    }
                $output .= '">';

                $meta_items = [];

                
                // Author
                if ($showPostAuthor) {
                    $meta = '<li class="meta-author" style="';

                    if (!empty($metaTextColor)) {
                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                    }

                    if (!empty($metaFontSize)) {
                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                    }

                    $meta .= '">';

                    if ($showPostAuthorIcon && $showMetaIcon) {
                        $meta .= '<i class="fas fa-user" style="';

                        if (!empty($metaIconColor)) {
                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '"></i> ';
                    }

                    $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                    $meta_items[] = $meta;
                }
                // Category
                if ($showPostCategory) {
                    $meta = '<li class="meta-categories" style="';

                    if (!empty($metaTextColor)) {
                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                    }

                    if (!empty($metaFontSize)) {
                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                    }

                    $meta .= '">';

                    if ($showPostCategoryIcon && $showMetaIcon) {
                        $meta .= '<i class="fas fa-folder" style="';

                        if (!empty($metaIconColor)) {
                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '"></i> ';
                    }

                    // Get category names without links
                    $categories_list = get_the_category($post_id);
                    if (!empty($categories_list)) {
                        $category_names = array();
                        foreach ($categories_list as $category) {
                            $category_names[] = esc_html($category->name);
                        }
                        $meta .= implode(', ', $category_names); // comma-separated plain text categories
                    }

                    $meta .= '</li>';
                    $meta_items[] = $meta;
                }
                
                // Now join meta items with the separator
                if (!empty($meta_items)) {
                    $separator = '';

                    if ($metaSeperator !== '') {
                        $separator = '';
                        if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                            $separatorStyle = '';
                            if (!empty($separatorColor)) {
                                $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                            }
                            if (!empty($metaFontSize)) {
                                $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                        }
                    }

                    $output .= implode($separator, $meta_items);
                }
                $output .= '</ul>'; // Close meta-data-list
                $output .= '</div>';               
            }
            // End Meta Data

            // title
            if ($showPostTitle) {
                $titleStyles = '';

                // Order
                if (!empty($titleOrder)) {
                    $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                }
                // Background color
                if (!empty($postTitleBgColor)) {
                    $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                }
                // Margin
                if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                    $titleStyles .= 'margin: ' .
                        (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                        (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                        (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                        (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                }
                // Padding
                if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                    $titleStyles .= 'padding: ' .
                        (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                        (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                        (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                        (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                }
                // Class name
                $classNames = 'title' 
                    . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                    . ' align-' . esc_attr($postTitleAlignment);
                // Hover JS (conditionally included)
                $onmouseover = !empty($postTitleHoverBgColor) 
                    ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                    : '';
                $onmouseout = !empty($postTitleBgColor) 
                    ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                    : '';
                // Final output
                $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                    . $onmouseover 
                    . $onmouseout 
                    . '>';

                $style = '';
                $hoverStyle = '';
                $mouseoutStyle = '';

                // Build inline styles conditionally
                if (!empty($postTitleFontSize)) {
                    $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                }
                if (!empty($postTitleLineHeight)) {
                    $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                }
                if (!empty($postTitleLetterSpacing)) {
                    $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                }
                if (!empty($postTitleFontWeight)) {
                    $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                }
                if (!empty($postTitleColor)) {
                    $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                    $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                }
                // Build hover color style if set
                if (!empty($postTitleHoverColor)) {
                    $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                }
                // Final output
                $output .= '<a href="' . esc_url($permalink) . '" 
                    style="' . esc_attr(trim($style)) . '"'
                    . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                    . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                    . esc_html($croppedTitle) . '</a>';    
                $output .= '</' . esc_attr($titleTag) . '>';
            }
            
            //Button
            if ($showReadMoreButton) {
                // Button wrapper styles
                $buttonWrapperStyle = '';

                // Margin
                if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                    $buttonWrapperStyle .= 'margin: ' .
                        (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                        (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                        (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                        (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                }

                // Order
                if (!empty($buttonOrder)) {
                    $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                }

               
                $output .= '<div class="blgo-btn-box align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                // Button inline styles
                $buttonInlineStyles = '';

                if (!empty($buttonTextColor)) {
                    $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                }
                if (!empty($buttonBackgroundColor)) {
                    $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                }
                if (!empty($buttonFontSize)) {
                    $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                }
                if (!empty($buttonFontWeight)) {
                    $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                }
                if (!empty($buttonBorderColor)) {
                    $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                }
                if (!empty($buttonBorderType)) {
                    $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                }

                // Border width
                
                if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                    $buttonInlineStyles .= 'border-width: ' .
                        (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                        (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                        (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                        (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                }
                if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                    $buttonInlineStyles .= 'border-radius: ' .
                        (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                        (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                        (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                        (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                }
                if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                    $buttonInlineStyles .= 'padding: ' .
                        (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                        (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                        (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                        (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                }

                // Hover styles
                $buttonHoverInlineStyles = '';
                $buttonResetStyles = '';

                if (!empty($buttonHoverTextColor)) {
                    $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                    $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                }
                if (!empty($buttonHoverBorderColor)) {
                    $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                    $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                }
                if (!empty($buttonHoverBackgroundColor)) {
                    $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                    $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                }

                // Button anchor tag
                $output .= '<a class="rs-btn ' . esc_attr($buttonStyle5) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                if (!empty($buttonHoverInlineStyles)) {
                    $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                }

                if (!empty($buttonResetStyles)) {
                    $output .= ' onmouseout="' . $buttonResetStyles . '"';
                }

                $output .= '>';

                // Icon handling
                $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                if ($iconPosition === 'left' && $showButtonIcon) {
                    $output .= $leftIcon . ' ';
                }

                $output .= esc_html($readMoreLabel);

                if ($iconPosition === 'right' && $showButtonIcon) {
                    $output .= ' ' . $rightIcon;
                }

                $output .= '</a></div>';
            }
            //end Footer
            $output .= '</div>';
            // End MAIN Content
            $output .= '</div>';
            // End Full post layout
            $output .= '</div>';
        }
        elseif ($sliderLayoutStyle === 'style6') {
            $output .= '<div class="swiper-slide">';
            // Full post layout
            $output .= '<div class="rs-blog-layout-23-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                // MARGIN    
                if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                    $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                } else { // Default fallback
                    $output .= 'margin: 40px 0px 0px 0px;';
                }

                // Padding
                if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                    $output .= 'padding: ' . 
                        (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                        (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                        (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                        (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                }

                // Border Radius
                if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                    $output .= 'border-radius: ' . 
                        (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                        (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                        (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                        (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                }

                // Border Width
                if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                    $output .= 'border-width: ' . 
                        (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                        (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                        (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                        (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                }

                // Border Style & Color
                if (!empty($itemBorderType)) {
                    $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                }
                if (!empty($itemBorderColor)) {
                    $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                }

                // Background Color
                if (!empty($itemBackgroundColor)) {
                    $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                }

                // Box Shadow
                if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                    $output .= 'box-shadow: ' . 
                        (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                        (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                        (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                        (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                        esc_attr($itemBoxShadowColor) . '; ';
                }

            $output .= '">';
            // Thumbnail
            if ($thumbnail && $showThumbnail) {
                $output .= '<div class="rs-thumb" style="';

                // Margin
                if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                    $output .= 'margin: ' . 
                        (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                        (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                        (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                        (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                }

                // Padding
                if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                    $output .= 'padding: ' . 
                        (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                        (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                        (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                        (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                }

                $output .= '">';

                // Anchor with optional border-radius and overflow
                $output .= '<a href="' . esc_url($permalink) . '" style="';

                    if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                        $output .= ' border-radius: ' .
                            (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                    }

                $output .= '">';
                $output .= $thumbnail . '</a></div>';
            }
            // END Thumbnail
            
            // MAIN Content
            $output .= '<div class="rs-blog-layout-23-overlay" style="';
                // Margin
                if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                    $output .= 'margin: ' .
                        (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                        (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                        (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                        (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                }
                // Padding
                if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                    $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                } else { // Default fallback
                    $output .= 'padding: 20px 20px 20px 20px;';
                }
                // Check if at least one side is not empty
                if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                    $output .= 'border-width: ' .
                        (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                        (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                        (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                        (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                }
                // Border Style
                if (!empty($contentNormalBorderType)) {
                    $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                }
                // Background Color
                if (!empty($contentBgColor)) {
                    $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                }
                // Border Color
                if (!empty($contentBorderColor)) {
                    $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                }
            $output .= '">';
            
            // title
            if ($showPostTitle) {
                $titleStyles = '';

                // Order
                if (!empty($titleOrder)) {
                    $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                }
                // Background color
                if (!empty($postTitleBgColor)) {
                    $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                }
                // Margin
                if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                    $titleStyles .= 'margin: ' .
                        (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                        (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                        (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                        (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                }
                // Padding
                if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                    $titleStyles .= 'padding: ' .
                        (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                        (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                        (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                        (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                }
                // Class name
                $classNames = 'title' 
                    . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                    . ' align-' . esc_attr($postTitleAlignment);
                // Hover JS (conditionally included)
                $onmouseover = !empty($postTitleHoverBgColor) 
                    ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                    : '';
                $onmouseout = !empty($postTitleBgColor) 
                    ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                    : '';
                // Final output
                $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                    . $onmouseover 
                    . $onmouseout 
                    . '>';

                $style = '';
                $hoverStyle = '';
                $mouseoutStyle = '';

                // Build inline styles conditionally
                if (!empty($postTitleFontSize)) {
                    $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                }
                if (!empty($postTitleLineHeight)) {
                    $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                }
                if (!empty($postTitleLetterSpacing)) {
                    $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                }
                if (!empty($postTitleFontWeight)) {
                    $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                }
                if (!empty($postTitleColor)) {
                    $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                    $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                }
                // Build hover color style if set
                if (!empty($postTitleHoverColor)) {
                    $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                }
                // Final output
                $output .= '<a href="' . esc_url($permalink) . '" 
                    style="' . esc_attr(trim($style)) . '"'
                    . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                    . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                    . esc_html($croppedTitle) . '</a>';    
                $output .= '</' . esc_attr($titleTag) . '>';
            }

            
            //Button
            if ($showReadMoreButton) {
                // Button wrapper styles
                $buttonWrapperStyle = '';

                // Margin
                if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                    $buttonWrapperStyle .= 'margin: ' .
                        (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                        (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                        (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                        (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                }

                // Order
                if (!empty($buttonOrder)) {
                    $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                }
               
                $output .= '<div class="rs-btn-box align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                // Button inline styles
                $buttonInlineStyles = '';

                if (!empty($buttonTextColor)) {
                    $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                }
                if (!empty($buttonBackgroundColor)) {
                    $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                }
                if (!empty($buttonFontSize)) {
                    $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                }
                if (!empty($buttonFontWeight)) {
                    $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                }
                if (!empty($buttonBorderColor)) {
                    $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                }
                if (!empty($buttonBorderType)) {
                    $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                }

                // Border width
                
                if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                    $buttonInlineStyles .= 'border-width: ' .
                        (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                        (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                        (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                        (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                }
                if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                    $buttonInlineStyles .= 'border-radius: ' .
                        (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                        (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                        (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                        (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                }
                if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                    $buttonInlineStyles .= 'padding: ' .
                        (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                        (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                        (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                        (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                }

                // Hover styles
                $buttonHoverInlineStyles = '';
                $buttonResetStyles = '';

                if (!empty($buttonHoverTextColor)) {
                    $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                    $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                }
                if (!empty($buttonHoverBorderColor)) {
                    $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                    $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                }
                if (!empty($buttonHoverBackgroundColor)) {
                    $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                    $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                }

                // Button anchor tag
                $output .= '<a class="rs-btn read-more ' . esc_attr($buttonStyle6) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                if (!empty($buttonHoverInlineStyles)) {
                    $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                }

                if (!empty($buttonResetStyles)) {
                    $output .= ' onmouseout="' . $buttonResetStyles . '"';
                }

                $output .= '>';

                // Icon handling
                $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                if ($iconPosition === 'left' && $showButtonIcon) {
                    $output .= $leftIcon . ' ';
                }

                $output .= esc_html($readMoreLabel);

                if ($iconPosition === 'right' && $showButtonIcon) {
                    $output .= ' ' . $rightIcon;
                }

                $output .= '</a></div>';
            }
            //end Footer
            $output .= '</div>';
            // End MAIN Content
            $output .= '</div>';
            // End Full post layout
            $output .= '</div>';
        }
        elseif ($sliderLayoutStyle === 'style7') {
            // Swiper Slide
            $output .= '<div class="swiper-slide">';
            // Full post layout
            $output .= '<div class="rs-blog-layout-28-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                // MARGIN    
                if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                    $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                } else { // Default fallback
                    $output .= 'margin: 40px 0px 0px 0px;';
                }

                // Padding
                if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                    $output .= 'padding: ' . 
                        (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                        (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                        (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                        (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                }

                // Border Radius
                if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                    $output .= 'border-radius: ' . 
                        (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                        (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                        (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                        (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                }

                // Border Width
                if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                    $output .= 'border-width: ' . 
                        (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                        (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                        (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                        (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                }

                // Border Style & Color
                if (!empty($itemBorderType)) {
                    $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                }
                if (!empty($itemBorderColor)) {
                    $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                }

                // Background Color
                if (!empty($itemBackgroundColor)) {
                    $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                }

                // Box Shadow
                if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                    $output .= 'box-shadow: ' . 
                        (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                        (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                        (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                        (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                        esc_attr($itemBoxShadowColor) . '; ';
                }

            $output .= '">';

            // Thumbnail
            if ($thumbnail && $showThumbnail) {

                $output .= '<div class="rs-thumb" style="';
                    // Margin
                    if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                        $output .= 'margin: ' . 
                            (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                            (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                            (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                            (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                            (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                            (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                            (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                    }
                $output .= '">';
                        
                // Anchor with optional border-radius and overflow
                $output .= '<a href="' . esc_url($permalink) . '" style="';

                    if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                        $output .= ' border-radius: ' .
                            (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                            (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                    }

                $output .= '">';
                $output .= $thumbnail . '</a>';

                // Now Insert Meta Data inside the Thumbnail
                if ($showMetaData) {
                    $output .= '<div class="rs-meta align-' . $metaAlignment3 . '">';
                        $output .= '<ul class="meta-data-list align-' . $metaAlignment3 . ' " style="';  
                            // Margin
                            if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                                $output .= 'margin: ' .
                                    (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                    (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                    (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                    (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                            }
                            // Padding
                            if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                                $output .= 'padding: ' .
                                    (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                    (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                    (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                    (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                            }   
                            
                            // Color
                            if (!empty($metaTextColor)) {
                                $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                            }
                            // Order
                            if (!empty($metaOrder)) {
                                $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                            }
                        $output .= '">';

                            $meta_items = [];

                            // Date
                            if ($showPostDate) {
                                $meta = '<li class="meta-date" style="';

                                // Color
                                if (!empty($metaTextColor)) {
                                    $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                }

                                // Font size
                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '">';

                                // Icon
                                if ($showPostDateIcon && $showMetaIcon) {
                                    $meta .= '<i class="fas fa-calendar-alt" style="';

                                    if (!empty($metaIconColor)) {
                                        $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                    }

                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '"></i> ';
                                }

                                $meta .= esc_html($getdate) . '</li>';
                                $meta_items[] = $meta;
                            }
                            // Author
                            if ($showPostAuthor) {
                                $meta = '<li class="meta-author" style="';

                                if (!empty($metaTextColor)) {
                                    $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '">';

                                if ($showPostAuthorIcon && $showMetaIcon) {
                                    $meta .= '<i class="fas fa-user" style="';

                                    if (!empty($metaIconColor)) {
                                        $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                    }

                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '"></i> ';
                                }

                                $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                                $meta_items[] = $meta;
                            }
                            // Category
                            if ($showPostCategory) {
                                $meta = '<li class="meta-categories" style="';

                                if (!empty($metaTextColor)) {
                                    $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '">';

                                if ($showPostCategoryIcon && $showMetaIcon) {
                                    $meta .= '<i class="fas fa-folder" style="';

                                    if (!empty($metaIconColor)) {
                                        $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                    }

                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '"></i> ';
                                }

                                // Get category names without links
                                $categories_list = get_the_category($post_id);
                                if (!empty($categories_list)) {
                                    $category_names = array();
                                    foreach ($categories_list as $category) {
                                        $category_names[] = esc_html($category->name);
                                    }
                                    $meta .= implode(', ', $category_names); // comma-separated plain text categories
                                }

                                $meta .= '</li>';
                                $meta_items[] = $meta;
                            }
                            // Tags
                            if ($showPostTags && !empty($tags)) {
                                $meta = '<li class="meta-tags" style="';

                                if (!empty($metaTextColor)) {
                                    $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                }

                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '">';

                                if ($showPostTagsIcon && $showMetaIcon) {
                                    $meta .= '<i class="fas fa-tags" style="';

                                    if (!empty($metaIconColor)) {
                                        $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                    }

                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '"></i> ';
                                }

                                $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                                $meta_items[] = $meta;
                            }
                            // Comment Count
                            if ($showPostCommentsCount) {
                                $meta = '<li class="meta-comment-count" style="';
                                if (!empty($metaTextColor)) {
                                    $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $meta .= '">';

                                if ($showPostCommentsCountIcon && $showMetaIcon) {
                                    $meta .= '<i class="fas fa-comments" style="';
                                    if (!empty($metaIconColor)) {
                                        $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                    }
                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }
                                    $meta .= '"></i> ';
                                }

                                $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                                $meta_items[] = $meta;
                            }
                            // Now join meta items with the separator
                            if (!empty($meta_items)) {
                                $separator = '';

                                if ($metaSeperator !== '') {
                                    $separator = '';
                                    if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                        $separatorStyle = '';
                                        if (!empty($separatorColor)) {
                                            $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                        }
                                        if (!empty($metaFontSize)) {
                                            $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                                    }
                                }

                                $output .= implode($separator, $meta_items);
                            }
                        $output .= '</ul>'; // ul Close 
                    $output .= '</div>'; // Close meta-data-list
                }

                $output .= '</div>'; // Close fancy-post-image rs-thumb
            }
            // END Thumbnail
            
            // MAIN Content
            $output .= '<div class="rs-content" style="';
                // Margin
                if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                    $output .= 'margin: ' .
                        (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                        (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                        (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                        (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                }
                // Padding
                if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                    $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                } else { // Default fallback
                    $output .= 'padding: 20px 30px 30px 30px;';
                }
                // Check if at least one side is not empty
                if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                    $output .= 'border-width: ' .
                        (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                        (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                        (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                        (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                }
                // Border Style
                if (!empty($contentNormalBorderType)) {
                    $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                }
                // Background Color
                if (!empty($contentBgColor)) {
                    $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                }
                // Border Color
                if (!empty($contentBorderColor)) {
                    $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                }
            $output .= '">';

                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }
                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }
                    // Margin
                    if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .
                            (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                            (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                            (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                            (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                    }
                    // Padding
                    if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                            (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                            (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                            (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                    }
                    // Class name
                    $classNames = 'title' 
                        . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                        . ' align-' . esc_attr($postTitleAlignment);
                    // Hover JS (conditionally included)
                    $onmouseover = !empty($postTitleHoverBgColor) 
                        ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                        : '';
                    $onmouseout = !empty($postTitleBgColor) 
                        ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                        : '';
                    // Final output
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                        . $onmouseover 
                        . $onmouseout 
                        . '>';

                    $style = '';
                    $hoverStyle = '';
                    $mouseoutStyle = '';

                    // Build inline styles conditionally
                    if (!empty($postTitleFontSize)) {
                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                    }
                    if (!empty($postTitleLineHeight)) {
                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                    }
                    if (!empty($postTitleLetterSpacing)) {
                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                    }
                    if (!empty($postTitleFontWeight)) {
                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                    }
                    if (!empty($postTitleColor)) {
                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                    }
                    // Build hover color style if set
                    if (!empty($postTitleHoverColor)) {
                        $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                    }
                    // Final output
                    $output .= '<a href="' . esc_url($permalink) . '" 
                        style="' . esc_attr(trim($style)) . '"'
                        . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                        . esc_html($croppedTitle) . '</a>';    
                    $output .= '</' . esc_attr($titleTag) . '>';
                }

                // Excerpt
                if ($showPostExcerpt) {
                    $excerptStyles = '';

                    // Order
                    if (!empty($excerptOrder)) {
                        $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                    }

                    // Typography
                    if (!empty($excerptFontSize)) {
                        $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                    }

                    if (!empty($excerptLineHeight)) {
                        $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                    }

                    if (!empty($excerptLetterSpacing)) {
                        $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                    }

                    if (!empty($excerptFontWeight)) {
                        $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                    }

                    if (!empty($excerptColor)) {
                        $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                    }

                    if (!empty($excerptBgColor)) {
                        $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                    }

                    if (!empty($excerptBorderType)) {
                        $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                    }

                    // Margin
                    if (!empty($excerptMargin['top']) || !empty($excerptMargin['right']) || !empty($excerptMargin['bottom']) || !empty($excerptMargin['left'])) {
                        $excerptStyles .= 'margin: ' .
                            (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) . ' ' .
                            (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) . ' ' .
                            (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) . ' ' .
                            (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($excerptPadding['top']) || !empty($excerptPadding['right']) || !empty($excerptPadding['bottom']) || !empty($excerptPadding['left'])) {
                        $excerptStyles .= 'padding: ' .
                            (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) . ' ' .
                            (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) . ' ' .
                            (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) . ' ' .
                            (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) . '; ';
                    }

                    // Handle hover logic conditionally
                    $hoverIn = '';
                    $hoverOut = '';

                    if (!empty($excerptHoverColor)) {
                        $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                        $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                    }

                    if (!empty($excerptHoverBgColor)) {
                        $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                        $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                    }

                    if (!empty($excerptHoverBorderColor)) {
                        $hoverIn .= 'this.style.borderColor=\'' . esc_attr($excerptHoverBorderColor) . '\';';
                        $hoverOut .= 'this.style.borderColor=\'inherit\';';
                    }

                    $output .= '<div class="fpg-excerpt' . ' align-' . esc_attr($excerptAlignment7) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                    if (!empty($hoverIn) || !empty($hoverOut)) {
                        $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                        $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                    }

                    $output .= '>';
                    $output .= '<p>' . esc_html($excerpt) . '</p>';
                    $output .= '</div>';
                }
                // End Excerpt
                
                // Button Output                
                if ($showReadMoreButton) {
                    // Button wrapper styles
                    $buttonWrapperStyle = '';

                    // Margin
                    if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                        $buttonWrapperStyle .= 'margin: ' .
                            (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                            (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                            (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                            (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                    }

                    // Order
                    if (!empty($buttonOrder)) {
                        $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                    }

                   
                    $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                    // Button inline styles
                    $buttonInlineStyles = '';

                    if (!empty($buttonTextColor)) {
                        $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                    }
                    if (!empty($buttonBackgroundColor)) {
                        $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                    }
                    if (!empty($buttonFontSize)) {
                        $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                    }
                    if (!empty($buttonFontWeight)) {
                        $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                    }
                    if (!empty($buttonBorderColor)) {
                        $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                    }
                    if (!empty($buttonBorderType)) {
                        $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                    }

                    // Border width
                    
                    if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                        $buttonInlineStyles .= 'border-width: ' .
                            (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                            (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                            (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                            (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                    }
                    if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                        $buttonInlineStyles .= 'border-radius: ' .
                            (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                            (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                            (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                            (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                    }
                    if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                        $buttonInlineStyles .= 'padding: ' .
                            (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                            (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                            (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                            (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                    }

                    // Hover styles
                    $buttonHoverInlineStyles = '';
                    $buttonResetStyles = '';

                    if (!empty($buttonHoverTextColor)) {
                        $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                        $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                    }
                    if (!empty($buttonHoverBorderColor)) {
                        $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                        $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                    }
                    if (!empty($buttonHoverBackgroundColor)) {
                        $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                        $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                    }

                    // Button anchor tag
                    $output .= '<a class="rs-btn read-more ' . esc_attr($buttonStyle7) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                    if (!empty($buttonHoverInlineStyles)) {
                        $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                    }

                    if (!empty($buttonResetStyles)) {
                        $output .= ' onmouseout="' . $buttonResetStyles . '"';
                    }

                    $output .= '>';

                    // Icon handling
                    $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                    $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                    $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                    if ($iconPosition === 'left' && $showButtonIcon) {
                        $output .= $leftIcon . ' ';
                    }

                    $output .= esc_html($readMoreLabel);

                    if ($iconPosition === 'right' && $showButtonIcon) {
                        $output .= ' ' . $rightIcon;
                    }

                    $output .= '</a></div>';
                }
                // End Button
            
            $output .= '</div>';
            // End MAIN Content
            $output .= '</div>';
            // End Full post layout
            $output .= '</div>';
            // Swiper Slide
        }
        
    }

    $output .= '</div>'; // close swiper-wrapper
    $output .= '</div>'; //close mySwiper
    // Add Swiper pagination if enabled
    if ($enablePagination && $sliderLayoutStyle === 'style1') {
        $output .= '<div class="swiper-pagination swiper-pagination-1"></div>';
    }
    if ($enablePagination && $sliderLayoutStyle === 'style2') {
        $output .= '<div class="swiper-pagination swiper-pagination-2"></div>';
    }
    if ($enablePagination && $sliderLayoutStyle === 'style3') {
        $output .= '<div class="swiper-pagination swiper-pagination-3"></div>';
    }
    if ($enablePagination && $sliderLayoutStyle === 'style4') {
        $output .= '<div class="swiper-pagination swiper-pagination-4"></div>';
    }
    if ($enablePagination && $sliderLayoutStyle === 'style5') {
        $output .= '<div class="swiper-pagination swiper-pagination-18"></div>';
    }
    if ($enablePagination && $sliderLayoutStyle === 'style6') {
        $output .= '<div class="swiper-pagination swiper-pagination-23"></div>';
    }
    if ($enablePagination && $sliderLayoutStyle === 'style7') {
        $output .= '<div class="swiper-pagination swiper-pagination-1"></div>';
    }

    // Add Swiper arrows if enabled
    if ($enableArrow) {
        // Inline background and size for visible button
        $arrowStyle = 'style="background: ' . esc_attr($arrowBgColorr) . ';"';

        // Inline JS hover/reset styles
        $hoverStyle = 'this.style.backgroundColor=\'' . esc_attr($arrowBgHoverColor) . '\';';
        $resetBgStyle = 'this.style.backgroundColor=\'' . esc_attr($arrowBgColorr) . '\';';

        // Output buttons with mouse events
        $output .= '<div class="swiper-button-prev" ' . $arrowStyle . '
            onmouseover="' . $hoverStyle . '" 
            onmouseout="' . $resetBgStyle . '"></div>';

        $output .= '<div class="swiper-button-next" ' . $arrowStyle . '
            onmouseover="' . $hoverStyle . '" 
            onmouseout="' . $resetBgStyle . '"></div>';

        // Output style for pseudo-elements (for arrows themselves)
        $output .= '<style>
            .swiper-button-prev::after,
            .swiper-button-next::after {
                color: ' . esc_attr($arrowColor) . ' !important;
                font-size: ' . esc_attr($arrowFontSize) . 'px !important;
            }
            .swiper-button-prev:hover::after,
            .swiper-button-next:hover::after {
                color: ' . esc_attr($arrowHoverColor) . ' !important;
            }
        </style>';
    }

    $output .= '</div>'; //close swiper_wrap
    $output .= '</div>'; // close col-lg-12
    $output .= '</div>'; //close row
    $output .= '</div>'; //close container

    // Pagination & navigation
    
    $output .= '<style>
        .swiper-pagination-1 .swiper-pagination-bullet {
            background-color: ' . esc_attr($sliderDots) . ';
            opacity: 1;
        }
        .swiper-pagination-1 .swiper-pagination-bullet-active {
            background-color: ' . esc_attr($sliderDotsActive) . ';
        }
        .swiper-pagination-1 .swiper-pagination-fraction .swiper-pagination-current {
            background-color: ' . esc_attr($sliderDots) . ';
            opacity: 1;
        }
        
        
    </style>';

    
    $output .= '</div>'; // main Style
    wp_reset_postdata();
    return $output;
}

function fancy_post_list_render_callback($attributes) {
    
    // Content Layout
    $listLayoutStyle = isset($attributes['listLayoutStyle']) ? $attributes['listLayoutStyle'] : 'style1';
    
    //Query Builder
    $selectedCategory = isset($attributes['selectedCategory']) ? sanitize_text_field($attributes['selectedCategory']) : '';
    $selectedTag = isset($attributes['selectedTag']) ? sanitize_text_field($attributes['selectedTag']) : '';
    $orderBy = isset($attributes['orderBy']) ? sanitize_text_field($attributes['orderBy']) : 'title';
    $postLimit = isset($attributes['postLimit']) ? absint($attributes['postLimit']) : 3;
      
    // Links
    $postLinkTarget = isset($attributes['postLinkTarget']) ? sanitize_text_field($attributes['postLinkTarget']) : 'newWindow';
    $thumbnailLink = isset($attributes['thumbnailLink']) ? filter_var($attributes['thumbnailLink'], FILTER_VALIDATE_BOOLEAN) : true;
    $postLinkType = isset($attributes['postLinkType']) ? sanitize_text_field($attributes['postLinkType']) : 'yeslink';

    // Field Selector
    $showPostTitle = isset($attributes['showPostTitle']) ? filter_var($attributes['showPostTitle'], FILTER_VALIDATE_BOOLEAN) : true;
    $showThumbnail = isset($attributes['showThumbnail']) ? filter_var($attributes['showThumbnail'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostExcerpt = isset($attributes['showPostExcerpt']) ? filter_var($attributes['showPostExcerpt'], FILTER_VALIDATE_BOOLEAN) : true;
    $showReadMoreButton = isset($attributes['showReadMoreButton']) ? filter_var($attributes['showReadMoreButton'], FILTER_VALIDATE_BOOLEAN) : true;
    $showMetaData = isset($attributes['showMetaData']) ? filter_var($attributes['showMetaData'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostDate = isset($attributes['showPostDate']) ? filter_var($attributes['showPostDate'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostAuthor = isset($attributes['showPostAuthor']) ? filter_var($attributes['showPostAuthor'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostCategory = isset($attributes['showPostCategory']) ? filter_var($attributes['showPostCategory'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostTags = isset($attributes['showPostTags']) ? filter_var($attributes['showPostTags'], FILTER_VALIDATE_BOOLEAN) : false;
    $showPostCommentsCount = isset($attributes['showPostCommentsCount']) ? filter_var($attributes['showPostCommentsCount'], FILTER_VALIDATE_BOOLEAN) : false;
    $showMetaIcon = isset($attributes['showMetaIcon']) ? filter_var($attributes['showMetaIcon'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostDateIcon = isset($attributes['showPostDateIcon']) ? filter_var($attributes['showPostDateIcon'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostAuthorIcon = isset($attributes['showPostAuthorIcon']) ? filter_var($attributes['showPostAuthorIcon'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostCategoryIcon = isset($attributes['showPostCategoryIcon']) ? filter_var($attributes['showPostCategoryIcon'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostTagsIcon = isset($attributes['showPostTagsIcon']) ? filter_var($attributes['showPostTagsIcon'], FILTER_VALIDATE_BOOLEAN) : false;
    $showPostCommentsCountIcon = isset($attributes['showPostCommentsCountIcon']) ? filter_var($attributes['showPostCommentsCountIcon'], FILTER_VALIDATE_BOOLEAN) : false;

    // Order values
    $metaOrder = isset($attributes['metaOrder']) ? absint($attributes['metaOrder']) : '';
    $titleOrder = isset($attributes['titleOrder']) ? absint($attributes['titleOrder']) : '';
    $excerptOrder = isset($attributes['excerptOrder']) ? absint($attributes['excerptOrder']) : '';
    $buttonOrder = isset($attributes['buttonOrder']) ? absint($attributes['buttonOrder']) : '';

    // Post title settings
    $titleTag               = isset($attributes['titleTag']) ? sanitize_text_field($attributes['titleTag']) : 'h3';
    $titleHoverUnderLine    = isset($attributes['titleHoverUnderLine']) ? sanitize_text_field($attributes['titleHoverUnderLine']) : 'enable';
    $titleCropBy            = isset($attributes['titleCropBy']) ? sanitize_text_field($attributes['titleCropBy']) : 'word';
    $titleLength            = isset($attributes['titleLength']) ? absint($attributes['titleLength']) : 12;
    
    //THUMB sETTINGS
    $thumbnailSize = isset($attributes['thumbnailSize']) ? sanitize_text_field($attributes['thumbnailSize']) : '';
    $leftThumbnailSize = isset($attributes['leftThumbnailSize']) ? sanitize_text_field($attributes['leftThumbnailSize']) : '';
    $rightThumbnailSize = isset($attributes['rightThumbnailSize']) ? sanitize_text_field($attributes['rightThumbnailSize']) : '';
    $hoverAnimation = isset($attributes['hoverAnimation']) ? sanitize_text_field($attributes['hoverAnimation']) : 'hover-zoom_in';

    // Excerpt Settings
    $excerptType = isset($attributes['excerptType']) ? sanitize_text_field($attributes['excerptType']) : 'word';
    $excerptIndicator = isset($attributes['excerptIndicator']) ? sanitize_text_field($attributes['excerptIndicator']) : '...';
    $excerptLimit = isset($attributes['excerptLimit']) ? absint($attributes['excerptLimit']) : 10;
    // Meta data Settings
    $metaAuthorPrefix = isset($attributes['metaAuthorPrefix']) ? sanitize_text_field($attributes['metaAuthorPrefix']) : __('By', 'fancy-post-grid');
    $metaSeperator = isset($attributes['metaSeperator']) ? sanitize_text_field($attributes['metaSeperator']) : '';
    //Button Settings   
    $showButtonIcon = isset($attributes['showButtonIcon']) ? filter_var($attributes['showPostCommentsCountIcon'], FILTER_VALIDATE_BOOLEAN) : true;
    $iconPosition = isset($attributes['iconPosition']) ? sanitize_text_field($attributes['iconPosition']) : 'right';
    $buttonStyle = isset($attributes['buttonStyle']) ? sanitize_text_field($attributes['buttonStyle']) : '';
    $readMoreLabel = isset($attributes['readMoreLabel']) ? sanitize_text_field($attributes['readMoreLabel']) : __('Read More', 'fancy-post-grid');
    // SECTION Area
    $sectionBgColor    = isset($attributes['sectionBgColor']) ? sanitize_hex_color($attributes['sectionBgColor']) : '';
    $sectionMargin = isset($attributes['sectionMargin']) ? $attributes['sectionMargin'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $sectionPadding = isset($attributes['sectionPadding']) ? $attributes['sectionPadding'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    // ITEM Box
    $itemPadding = isset($attributes['itemPadding']) ? $attributes['itemPadding'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $itemMargin = isset($attributes['itemMargin']) ? $attributes['itemMargin'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $itemBorderRadius = isset($attributes['itemBorderRadius']) ? $attributes['itemBorderRadius'] : ['top' => '5', 'right' => '5', 'bottom' => '5', 'left' => '5'];
    $itemBorderWidth = isset($attributes['itemBorderWidth']) ? $attributes['itemBorderWidth'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $itemBoxAlignment   = isset($attributes['itemBoxAlignment']) ? sanitize_text_field($attributes['itemBoxAlignment']) : 'start';
    $itemBorderType     = isset($attributes['itemBorderType']) ? sanitize_text_field($attributes['itemBorderType']) : '';
    $itemBoxShadow = isset($attributes['itemBoxShadow']) ? $attributes['itemBoxShadow'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
    $itemBackgroundColor = isset($attributes['itemBackgroundColor']) ? sanitize_hex_color($attributes['itemBackgroundColor']) : '';
    $itemBorderColor    = isset($attributes['itemBorderColor']) ? sanitize_hex_color($attributes['itemBorderColor']) : '';   
    $itemBoxShadowColor = isset($attributes['itemBoxShadowColor']) ? sanitize_hex_color($attributes['itemBoxShadowColor']) : '';
    $itemGap      = isset($attributes['itemGap']) ? absint($attributes['itemGap']) : 30;

    // Content Box
    $contentitemPaddingNew = isset($attributes['contentitemPaddingNew']) ? $attributes['contentitemPaddingNew'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $contentitemMarginNew = isset($attributes['contentitemMarginNew']) ? $attributes['contentitemMarginNew'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $contentBorderWidth = isset($attributes['contentBorderWidth']) ? $attributes['contentBorderWidth'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $contentNormalBorderType = isset($attributes['contentnormalBorderType']) ? sanitize_text_field($attributes['contentnormalBorderType']) : '';
    $contentBgColor    = isset($attributes['contentBgColor']) ? sanitize_hex_color($attributes['contentBgColor']) : '';   
    $contentBorderColor = isset($attributes['contentBorderColor']) ? sanitize_hex_color($attributes['contentBorderColor']) : '';
    // Thumbnail
    $thumbnailMargin = isset($attributes['thumbnailMargin']) ? $attributes['thumbnailMargin'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
    $thumbnailPadding = isset($attributes['thumbnailPadding']) ? $attributes['thumbnailPadding'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
    $thumbnailBorderRadius = isset($attributes['thumbnailBorderRadius']) ? $attributes['thumbnailBorderRadius'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];

    // Post Title
    $postTitleFontSize      = isset($attributes['postTitleFontSize']) ? absint($attributes['postTitleFontSize']) : '';
    $postTitleLineHeight    = isset($attributes['postTitleLineHeight']) ? floatval($attributes['postTitleLineHeight']) : '';
    $postTitleLetterSpacing = isset($attributes['postTitleLetterSpacing']) ? floatval($attributes['postTitleLetterSpacing']) : '';
    $postTitleFontWeight    = isset($attributes['postTitleFontWeight']) ? sanitize_text_field($attributes['postTitleFontWeight']) : '';
    $postTitleAlignment     = isset($attributes['postTitleAlignment']) ? sanitize_text_field($attributes['postTitleAlignment']) : 'start';
    $postTitleColor         = isset($attributes['postTitleColor']) ? sanitize_hex_color($attributes['postTitleColor']) : '';
    $postTitleBgColor       = isset($attributes['postTitleBgColor']) ? sanitize_hex_color($attributes['postTitleBgColor']) : ''; 
    $postTitleHoverColor    = isset($attributes['postTitleHoverColor']) ? sanitize_hex_color($attributes['postTitleHoverColor']) : '';
    $postTitleHoverBgColor  = isset($attributes['postTitleHoverBgColor']) ? sanitize_hex_color($attributes['postTitleHoverBgColor']) : '';
    $postTitleMargin  = isset($attributes['postTitleMargin']) ? array_map('sanitize_text_field', $attributes['postTitleMargin']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $postTitlePadding = isset($attributes['postTitlePadding']) ? array_map('sanitize_text_field', $attributes['postTitlePadding']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];

    // Excerpt
    $excerptFontSize = isset($attributes['excerptFontSize']) ? absint($attributes['excerptFontSize']) : '';
    $excerptLineHeight = isset($attributes['excerptLineHeight']) ? floatval($attributes['excerptLineHeight']) : '';
    $excerptLetterSpacing = isset($attributes['excerptLetterSpacing']) ? floatval($attributes['excerptLetterSpacing']) : '';
    $excerptFontWeight = isset($attributes['excerptFontWeight']) ? sanitize_text_field($attributes['excerptFontWeight']) : '';
    $excerptAlignment = isset($attributes['excerptAlignment']) ? sanitize_text_field($attributes['excerptAlignment']) : '';
    $excerptMargin = isset($attributes['excerptMargin']) ? array_map('sanitize_text_field', $attributes['excerptMargin']) : ['top' => '10', 'right' => '0', 'bottom' => '10', 'left' => '0'];
    $excerptPadding = isset($attributes['excerptPadding']) ? array_map('sanitize_text_field', $attributes['excerptPadding']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $excerptColor = isset($attributes['excerptColor']) ? sanitize_hex_color($attributes['excerptColor']) : '';
    $excerptBgColor = isset($attributes['excerptBgColor']) ? sanitize_hex_color($attributes['excerptBgColor']) : '';
    $excerptBorderType = isset($attributes['excerptBorderType']) ? sanitize_text_field($attributes['excerptBorderType']) : '';
    $excerptHoverColor = isset($attributes['excerptHoverColor']) ? sanitize_hex_color($attributes['excerptHoverColor']) : '';
    $excerptHoverBgColor = isset($attributes['excerptHoverBgColor']) ? sanitize_hex_color($attributes['excerptHoverBgColor']) : '';
    $excerptHoverBorderColor = isset($attributes['excerptHoverBorderColor']) ? sanitize_hex_color($attributes['excerptHoverBorderColor']) : '';

    // Meta Data Attributes
    $metaAlignment = isset($attributes['metaAlignment']) ? sanitize_text_field($attributes['metaAlignment']) : '';
    $metaMarginNew = isset($attributes['metaMarginNew']) ? $attributes['metaMarginNew'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $metaPadding = isset($attributes['metaPadding']) ? $attributes['metaPadding'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $metaTextColor = isset($attributes['metaTextColor']) ? sanitize_hex_color($attributes['metaTextColor']) : '';
    $separatorColor = isset($attributes['separatorColor']) ? sanitize_hex_color($attributes['separatorColor']) : '';
    $metaFontSize = isset($attributes['metaFontSize']) ? absint($attributes['metaFontSize']) : '15';
    $metaIconColor = isset($attributes['metaIconColor']) ? sanitize_hex_color($attributes['metaIconColor']) : '';
    
    // Button Alignment
    $buttonAlignment = isset($attributes['buttonAlignment']) ? sanitize_text_field($attributes['buttonAlignment']) : 'start';
    $buttonMarginNew = isset($attributes['buttonMarginNew']) ? array_map('sanitize_text_field', $attributes['buttonMarginNew']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $buttonPaddingNew = isset($attributes['buttonPaddingNew']) ? array_map('sanitize_text_field', $attributes['buttonPaddingNew']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $buttonFontSize = isset($attributes['buttonFontSize']) ? absint($attributes['buttonFontSize']) : '';
    $buttonBorderWidth = isset($attributes['buttonBorderWidth']) ? array_map('sanitize_text_field', $attributes['buttonBorderWidth']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $buttonFontWeight = isset($attributes['buttonFontWeight']) ? sanitize_text_field($attributes['buttonFontWeight']) : '';
    $buttonTextColor = isset($attributes['buttonTextColor']) ? sanitize_hex_color($attributes['buttonTextColor']) : '';
    $buttonBackgroundColor = isset($attributes['buttonBackgroundColor']) ? sanitize_hex_color($attributes['buttonBackgroundColor']) : '';
    $buttonBorderType = isset($attributes['buttonBorderType']) ? sanitize_text_field($attributes['buttonBorderType']) : '';
    $buttonBorderRadius = isset($attributes['buttonBorderRadius']) ? array_map('sanitize_text_field', $attributes['buttonBorderRadius']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
    $buttonHoverTextColor = isset($attributes['buttonHoverTextColor']) ? sanitize_hex_color($attributes['buttonHoverTextColor']) : '';
    $buttonHoverBackgroundColor = isset($attributes['buttonHoverBackgroundColor']) ? sanitize_hex_color($attributes['buttonHoverBackgroundColor']) : ''; 
    $buttonBorderColor = isset($attributes['buttonBorderColor']) ? sanitize_hex_color($attributes['buttonBorderColor']) : '';
    $buttonHoverBorderColor = isset($attributes['buttonHoverBorderColor']) ? sanitize_hex_color($attributes['buttonHoverBorderColor']) : '';

    //END ATTRIBUTES
    
    $paged = (get_query_var('paged')) ? get_query_var('paged') : 1;

    $query_args = array(
        'post_type'      => 'post',
        'posts_per_page' => $postLimit, // Adjust as needed
        'paged'          => $paged,
        'orderby'        => $orderBy,
        'order'          => 'DESC', // Ensure ordering
    );

    // Filter by category (use 'cat' for category ID)
    if (!empty($selectedCategory) && is_numeric($selectedCategory)) {
        $query_args['cat'] = intval($selectedCategory); 
    }

    // Filter by tag (use 'tag__in' for tag IDs)
    if (!empty($selectedTag) && is_numeric($selectedTag)) {
        $query_args['tag__in'] = array(intval($selectedTag)); 
    }
    //Thumbnail
    $thumbnailSize1L = ($listLayoutStyle === 'style1' && $leftThumbnailSize == null)
              ? 'fancy_post_custom_size' : $leftThumbnailSize; 
    $thumbnailSize1R = ($listLayoutStyle === 'style1' && $rightThumbnailSize == null)
              ? 'fancy_post_square' : $rightThumbnailSize; 
    $thumbnailSize2L = ($listLayoutStyle === 'style2' && $leftThumbnailSize == null)
              ? 'fancy_post_custom_size' : $leftThumbnailSize; 
    $thumbnailSize2R = ($listLayoutStyle === 'style2' && $rightThumbnailSize == null)
              ? 'fancy_post_square' : $rightThumbnailSize;
    $thumbnailSize3L = ($listLayoutStyle === 'style3' && $leftThumbnailSize == null)
              ? 'fancy_post_custom_size' : $leftThumbnailSize; 
    $thumbnailSize3R = ($listLayoutStyle === 'style3' && $rightThumbnailSize == null)
              ? 'fancy_post_square' : $rightThumbnailSize; 
    $thumbnailSize4 = ($listLayoutStyle === 'style4' && $thumbnailSize == null)
              ? 'fancy_post_square' : $thumbnailSize; 
    $thumbnailSize5 = ($listLayoutStyle === 'style5' && $thumbnailSize == null)
              ? 'fancy_post_portrait' : $thumbnailSize; 
    $thumbnailSize6 = ($listLayoutStyle === 'style6' && $thumbnailSize == null)
              ? 'thumbnail' : $thumbnailSize; 
    $thumbnailSize7 = ($listLayoutStyle === 'style7' && $thumbnailSize == null)
              ? 'fancy_post_square' : $thumbnailSize; 
    $thumbnailSize8L = ($listLayoutStyle === 'style8' && $leftThumbnailSize == null)
              ? 'fancy_post_custom_size' : $leftThumbnailSize; 
    $thumbnailSize8R = ($listLayoutStyle === 'style8' && $rightThumbnailSize == null)
              ? 'fancy_post_custom_size' : $rightThumbnailSize; 

    // MetaAlignment
    $metaAlignment1 = ($listLayoutStyle === 'style1' && $metaAlignment == null)
              ? 'start' : $metaAlignment; 
    $metaAlignment2 = ($listLayoutStyle === 'style2' && $metaAlignment == null)
              ? 'start' : $metaAlignment; 
    $metaAlignment3 = ($listLayoutStyle === 'style3' && $metaAlignment == null)
              ? 'start' : $metaAlignment; 
    $metaAlignment4 = ($listLayoutStyle === 'style4' && $metaAlignment == null)
              ? 'center' : $metaAlignment; 
    $metaAlignment5 = ($listLayoutStyle === 'style5' && $metaAlignment == null)
              ? 'start' : $metaAlignment; 
    $metaAlignment6 = ($listLayoutStyle === 'style6' && $metaAlignment == null)
              ? 'start' : $metaAlignment; 
    $metaAlignment7 = ($listLayoutStyle === 'style7' && $metaAlignment == null)
              ? 'start' : $metaAlignment; 
    $metaAlignment8 = ($listLayoutStyle === 'style8' && $metaAlignment == null)
              ? 'start' : $metaAlignment;

    // ExcerptAlignment
    $excerptAlignment1 = ($listLayoutStyle === 'style1' && $excerptAlignment == null)
              ? 'start' : $excerptAlignment; 
    $excerptAlignment2 = ($listLayoutStyle === 'style2' && $excerptAlignment == null)
              ? 'start' : $excerptAlignment; 
    $excerptAlignment3 = ($listLayoutStyle === 'style3' && $excerptAlignment == null)
              ? 'start' : $excerptAlignment; 
    $excerptAlignment4 = ($listLayoutStyle === 'style4' && $excerptAlignment == null)
              ? 'center' : $excerptAlignment; 
    $excerptAlignment5 = ($listLayoutStyle === 'style5' && $excerptAlignment == null)
              ? 'start' : $excerptAlignment; 
    $excerptAlignment6 = ($listLayoutStyle === 'style6' && $excerptAlignment == null)
              ? 'start' : $excerptAlignment; 
    $excerptAlignment7 = ($listLayoutStyle === 'style7' && $excerptAlignment == null)
              ? 'start' : $excerptAlignment; 
    $excerptAlignment8 = ($listLayoutStyle === 'style8' && $excerptAlignment == null)
              ? 'start' : $excerptAlignment;   

    // buttonStyle
    $buttonStyle1 = ($listLayoutStyle === 'style1' && $buttonStyle == null)
              ? 'fpg-flat' : $buttonStyle; 
    $buttonStyle2 = ($listLayoutStyle === 'style2' && $buttonStyle == null)
              ? 'fpg-flat' : $buttonStyle; 
    $buttonStyle3 = ($listLayoutStyle === 'style3' && $buttonStyle == null)
              ? 'fpg-flat' : $buttonStyle; 
    $buttonStyle4 = ($listLayoutStyle === 'style4' && $buttonStyle == null)
              ? 'fpg-filled' : $buttonStyle; 
    $buttonStyle5 = ($listLayoutStyle === 'style5' && $buttonStyle == null)
              ? 'fpg-filled' : $buttonStyle; 
    $buttonStyle6 = ($listLayoutStyle === 'style6' && $buttonStyle == null)
              ? 'fpg-flat' : $buttonStyle; 
    $buttonStyle7 = ($listLayoutStyle === 'style7' && $buttonStyle == null)
              ? 'fpg-flat' : $buttonStyle; 
    $buttonStyle8 = ($listLayoutStyle === 'style8' && $buttonStyle == null)
              ? 'fpg-flat' : $buttonStyle;  

    // Run the query
    $query = new WP_Query($query_args);

    if (!$query->have_posts()) {
        return '<p>' . esc_html__('No posts found.', 'fancy-post-grid') . '</p>';
    }
    if ($listLayoutStyle === 'style1') {
        
        $output = '<div class="rs-blog-layout-8" style="';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }
        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';    
    } else if ($listLayoutStyle === 'style2') {
        
        $output = '<div class="rs-blog-layout-1 rs-blog-layout-9 " style="';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }
        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';     
    } else if ($listLayoutStyle === 'style3') {
        
        $output = '<div class="rs-blog-layout-17" style="';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }
        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';     
    } else if ($listLayoutStyle === 'style4') {
        
        $output = '<div class="rs-blog-layout-20" style="';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }
        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';     
    } else if ($listLayoutStyle === 'style5') {
        
        $output = '<div class="rs-blog-layout-22" style="';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }
        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';     
    } else if ($listLayoutStyle === 'style6') {
        
        $output = '<div class="rs-blog-layout-24" style="';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }
        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';     
    } else if ($listLayoutStyle === 'style7') {
        
        $output = '<div class="rs-blog-layout-25" style="';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }
        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';     
    } else if ($listLayoutStyle === 'style8') {
        
        $output = '<div class="rs-blog-layout-27" style="';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }
        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';     
    }

        $output .= '<div class="container">';    
        
        if ($listLayoutStyle === 'style7'){
            $output .= '<div class="col-lg-12">';
                $output .= '<div class="rs-blog-25-topbar">';
                $output .= '<h3 class="title">' . esc_html__('Blog & article', 'fancy-post-grid') . '</h3>';
                $output .= '<a href="' . esc_url(get_post_type_archive_link('post')) . '">';
                $output .= esc_html__('See All Posts', 'fancy-post-grid') . ' <i class="ri-arrow-right-up-line"></i>';
                $output .= '</a>';
                $output .= '</div>';
                $output .= '</div>'; 
        }  
        $output .= '<div class="row">'; 
        $post_count = 0;
     
        while ($query->have_posts()) {
            
            $query->the_post();
            $post_id = get_the_ID();
            $post_count++;
            $permalink = get_permalink($post_id);
            $title = get_the_title();
            $date = get_the_date();
            $getdate = get_the_date('M j, Y', $post_id);
            $author = get_the_author();
            $categories = get_the_category_list(', ');
            $tags = get_the_tag_list('', ', ');
            $comments_count = get_comments_number();

            if ($listLayoutStyle === 'style1') {
                $leftThumbnailSize = get_the_post_thumbnail($post_id, $thumbnailSize1L, ['class' => 'fancy-post-thumbnail']);
                $rightThumbnailSize = get_the_post_thumbnail($post_id, $thumbnailSize1R, ['class' => 'fancy-post-thumbnail']);
            }
            
            if ($listLayoutStyle === 'style2') {
                $leftThumbnailSize = get_the_post_thumbnail($post_id, $thumbnailSize2L, ['class' => 'fancy-post-thumbnail']);
                $rightThumbnailSize = get_the_post_thumbnail($post_id, $thumbnailSize2R, ['class' => 'fancy-post-thumbnail']);
            }
            
            if ($listLayoutStyle === 'style3') {
                $leftThumbnailSize = get_the_post_thumbnail($post_id, $thumbnailSize3L, ['class' => 'fancy-post-thumbnail']);
                $rightThumbnailSize = get_the_post_thumbnail($post_id, $thumbnailSize3R, ['class' => 'fancy-post-thumbnail']);
            }
            
            if ($listLayoutStyle === 'style4') {
                $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize4, ['class' => 'fancy-post-thumbnail']);
            }
            if ($listLayoutStyle === 'style5') {
                $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize5, ['class' => 'fancy-post-thumbnail']);
            }
            if ($listLayoutStyle === 'style6') {
                $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize6, ['class' => 'fancy-post-thumbnail']);
            }
            if ($listLayoutStyle === 'style7') {
                $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize7, ['class' => 'fancy-post-thumbnail']);
            }
            if ($listLayoutStyle === 'style8') {
                $leftThumbnailSize = get_the_post_thumbnail($post_id, $thumbnailSize8L, ['class' => 'fancy-post-thumbnail']);
                $rightThumbnailSize = get_the_post_thumbnail($post_id, $thumbnailSize8R, ['class' => 'fancy-post-thumbnail']);
            }

            // Title Crop
            if ($titleCropBy === 'word') {
                $titleArray = explode(' ', $title);
                $croppedTitle = implode(' ', array_slice($titleArray, 0, (int) $titleLength));
            } elseif ($titleCropBy === 'cha') {
                $croppedTitle = mb_substr($title, 0, $titleLength);
            } else {
                $croppedTitle = $title; // fallback
            }
            // Fetch full content when 'full_content' is selected
            if ($excerptType === 'full_content') {
                $excerpt = apply_filters('the_content', get_the_content());
            } elseif ($excerptType === 'word') {
                $excerpt = wp_trim_words(get_the_excerpt(), $excerptLimit, $excerptIndicator);
            } else { // 'character'
                $excerpt = mb_substr(get_the_excerpt(), 0, $excerptLimit) . $excerptIndicator;
            }

            // Style-based output
            if ($listLayoutStyle === 'style1') {
                if ($post_count === 1) {
                    // LEFT SIDE - Only the first post
                    $output .= '<div class="col-lg-5">';
                        $output .= '<div class="rs-blog__left-blog align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                            // MARGIN    
                            if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                                $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                            } else { // Default fallback
                                $output .= 'margin: 40px 0px 0px 0px;';
                            }

                            // Padding
                            if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                                $output .= 'padding: ' . 
                                    (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                                    (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                                    (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                                    (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                            }

                            // Border Radius
                            if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                                $output .= 'border-radius: ' . 
                                    (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                                    (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                                    (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                                    (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                            }

                            // Border Width
                            if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                                $output .= 'border-width: ' . 
                                    (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                                    (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                                    (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                                    (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                            }

                            // Border Style & Color
                            if (!empty($itemBorderType)) {
                                $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                            }
                            if (!empty($itemBorderColor)) {
                                $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                            }

                            // Background Color
                            if (!empty($itemBackgroundColor)) {
                                $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                            }

                            // Box Shadow
                            if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                                $output .= 'box-shadow: ' . 
                                    (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                                    (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                                    (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                                    (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                                    esc_attr($itemBoxShadowColor) . '; ';
                            }

                        $output .= '">';

                            // Thumbnail
                            if ($leftThumbnailSize && $showThumbnail) {
                                $output .= '<div class="rs-blog__thumb" style="';

                                // Margin
                                if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                                    $output .= 'margin: ' . 
                                        (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                                        (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                                        (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                                        (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                                }

                                // Padding
                                if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                                    $output .= 'padding: ' . 
                                        (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                                        (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                                        (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                                        (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                                }

                                $output .= '">';

                                // Anchor with optional border-radius and overflow
                                $output .= '<a href="' . esc_url($permalink) . '" style="';

                                    if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                                        $output .= ' border-radius: ' .
                                            (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                                            (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                                            (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                                            (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                                    }

                                $output .= '">';
                                $output .= $leftThumbnailSize . '</a>';
                                if ($showPostCategory) {
                                        
                                    $output .= '<div class="rs-category" style="color:' . esc_attr($metaTextColor) . ';">';
                                        if ($showPostCategoryIcon && $showMetaIcon) {
                                            $output .= '<i class="ri-folder-line" style="color:' . esc_attr($metaIconColor) . '; font-size:' . esc_attr($metaFontSize) . 'px;"></i> ';
                                        }

                                        // Get category names without links
                                        $categories_list = get_the_category($post_id);
                                        if (!empty($categories_list)) {
                                            $category_names = array();
                                            foreach ($categories_list as $category) {
                                                $category_names[] = esc_html($category->name);
                                            }
                                            $output .= implode(', ', $category_names); // comma-separated plain text categories
                                        }
                                    $output .= '</div>';
                                }
                                $output .= '</div>';
                            }
                            // END Thumbnail
                            // MAIN Content
                            $output .= '<div class="rs-blog__content" style="';
                                // Margin
                                if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                                    $output .= 'margin: ' .
                                        (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                                        (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                                        (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                                        (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                                }
                                // Padding
                                if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                                    $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                                } else { // Default fallback
                                    $output .= 'padding: 20px 0px 0px 0px;';
                                }
                                // Check if at least one side is not empty
                                if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                                    $output .= 'border-width: ' .
                                        (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                                        (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                                        (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                                        (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                                }
                                // Border Style
                                if (!empty($contentNormalBorderType)) {
                                    $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                                }
                                // Background Color
                                if (!empty($contentBgColor)) {
                                    $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                                }
                                // Border Color
                                if (!empty($contentBorderColor)) {
                                    $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                                }
                            $output .= '">';

                            // Meta Data
                            if ($showMetaData) {
                                $output .= '<ul class="meta-data-list align-' . $metaAlignment1 . ' " style="';  
                                    // Margin
                                    if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                                        $output .= 'margin: ' .
                                            (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                            (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                            (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                            (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                                    }
                                    // Padding
                                    if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                                        $output .= 'padding: ' .
                                            (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                            (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                            (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                            (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                                    }   
                                    
                                    // Color
                                    if (!empty($metaTextColor)) {
                                        $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                    }
                                    // Order
                                    if (!empty($metaOrder)) {
                                        $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                    }
                                $output .= '">';

                                $meta_items = [];

                                
                                // Author
                                if ($showPostAuthor) {
                                    $meta = '<li class="meta-author" style="';

                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostAuthorIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-user" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Date
                                if ($showPostDate) {
                                    $meta = '<li class="meta-date" style="';

                                    // Color
                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    // Font size
                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    // Icon
                                    if ($showPostDateIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-calendar-alt" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($getdate) . '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Tags
                                if ($showPostTags && !empty($tags)) {
                                    $meta = '<li class="meta-tags" style="';

                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostTagsIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-tags" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Comment Count
                                if ($showPostCommentsCount) {
                                    $meta = '<li class="meta-comment-count" style="';
                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }
                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostCommentsCountIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-comments" style="';
                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }
                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }
                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Now join meta items with the separator
                                if (!empty($meta_items)) {
                                    $separator = '';

                                    if ($metaSeperator !== '') {
                                        $separator = '';
                                        if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                            $separatorStyle = '';
                                            if (!empty($separatorColor)) {
                                                $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                            }
                                            if (!empty($metaFontSize)) {
                                                $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                                        }
                                    }

                                    $output .= implode($separator, $meta_items);
                                }
                                $output .= '</ul>'; // Close meta-data-list               
                            }
                            // End Meta Data

                            // title
                            if ($showPostTitle) {
                                $titleStyles = '';

                                // Order
                                if (!empty($titleOrder)) {
                                    $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                                }
                                // Background color
                                if (!empty($postTitleBgColor)) {
                                    $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                                }
                                // Margin
                                if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                                    $titleStyles .= 'margin: ' .
                                        (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                                        (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                                        (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                                        (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                                }
                                // Padding
                                if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                                    $titleStyles .= 'padding: ' .
                                        (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                                        (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                                        (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                                        (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                                }
                                // Class name
                                $classNames = 'title' 
                                    . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                                    . ' align-' . esc_attr($postTitleAlignment);
                                // Hover JS (conditionally included)
                                $onmouseover = !empty($postTitleHoverBgColor) 
                                    ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                                    : '';
                                $onmouseout = !empty($postTitleBgColor) 
                                    ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                                    : '';
                                // Final output
                                $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                                    . $onmouseover 
                                    . $onmouseout 
                                    . '>';

                                $style = '';
                                $hoverStyle = '';
                                $mouseoutStyle = '';

                                // Build inline styles conditionally
                                if (!empty($postTitleFontSize)) {
                                    $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                }
                                if (!empty($postTitleLineHeight)) {
                                    $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                }
                                if (!empty($postTitleLetterSpacing)) {
                                    $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                }
                                if (!empty($postTitleFontWeight)) {
                                    $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                }
                                if (!empty($postTitleColor)) {
                                    $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                    $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                }
                                // Build hover color style if set
                                if (!empty($postTitleHoverColor)) {
                                    $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                }
                                // Final output
                                $output .= '<a href="' . esc_url($permalink) . '" 
                                    style="' . esc_attr(trim($style)) . '"'
                                    . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                                    . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                    . esc_html($croppedTitle) . '</a>';    
                                $output .= '</' . esc_attr($titleTag) . '>';
                            }

                            // Excerpt
                            if ($showPostExcerpt) {
                                $excerptStyles = '';

                                // Order
                                if (!empty($excerptOrder)) {
                                    $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                                }

                                // Typography
                                if (!empty($excerptFontSize)) {
                                    $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                                }

                                if (!empty($excerptLineHeight)) {
                                    $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                                }

                                if (!empty($excerptLetterSpacing)) {
                                    $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                                }

                                if (!empty($excerptFontWeight)) {
                                    $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                                }

                                if (!empty($excerptColor)) {
                                    $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                                }

                                if (!empty($excerptBgColor)) {
                                    $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                                }

                                if (!empty($excerptBorderType)) {
                                    $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                                }

                                // Margin
                                if (!empty($excerptMargin['top']) || !empty($excerptMargin['right']) || !empty($excerptMargin['bottom']) || !empty($excerptMargin['left'])) {
                                    $excerptStyles .= 'margin: ' .
                                        (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) . ' ' .
                                        (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) . ' ' .
                                        (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) . ' ' .
                                        (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) . '; ';
                                }

                                // Padding
                                if (!empty($excerptPadding['top']) || !empty($excerptPadding['right']) || !empty($excerptPadding['bottom']) || !empty($excerptPadding['left'])) {
                                    $excerptStyles .= 'padding: ' .
                                        (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) . ' ' .
                                        (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) . ' ' .
                                        (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) . ' ' .
                                        (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) . '; ';
                                }

                                // Handle hover logic conditionally
                                $hoverIn = '';
                                $hoverOut = '';

                                if (!empty($excerptHoverColor)) {
                                    $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                                    $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                                }

                                if (!empty($excerptHoverBgColor)) {
                                    $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                                    $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                                }

                                if (!empty($excerptHoverBorderColor)) {
                                    $hoverIn .= 'this.style.borderColor=\'' . esc_attr($excerptHoverBorderColor) . '\';';
                                    $hoverOut .= 'this.style.borderColor=\'inherit\';';
                                }

                                $output .= '<div class="fpg-excerpt' . ' align-' . esc_attr($excerptAlignment1) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                                if (!empty($hoverIn) || !empty($hoverOut)) {
                                    $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                                    $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                                }

                                $output .= '>';
                                $output .= '<p>' . esc_html($excerpt) . '</p>';
                                $output .= '</div>';
                            }
                            // End Excerpt

                            // Button Output                
                            if ($showReadMoreButton) {
                                // Button wrapper styles
                                $buttonWrapperStyle = '';

                                // Margin
                                if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                                    $buttonWrapperStyle .= 'margin: ' .
                                        (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                                        (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                                        (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                                        (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                                }

                                // Order
                                if (!empty($buttonOrder)) {
                                    $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                                }

                               
                                $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                                // Button inline styles
                                $buttonInlineStyles = '';

                                if (!empty($buttonTextColor)) {
                                    $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                                }
                                if (!empty($buttonBackgroundColor)) {
                                    $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                                }
                                if (!empty($buttonFontSize)) {
                                    $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                                }
                                if (!empty($buttonFontWeight)) {
                                    $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                                }
                                if (!empty($buttonBorderColor)) {
                                    $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                                }
                                if (!empty($buttonBorderType)) {
                                    $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                                }

                                // Border width
                                
                                if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                                    $buttonInlineStyles .= 'border-width: ' .
                                        (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                                        (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                                        (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                                        (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                                }
                                if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                                    $buttonInlineStyles .= 'border-radius: ' .
                                        (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                                        (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                                        (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                                        (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                                }
                                if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                                    $buttonInlineStyles .= 'padding: ' .
                                        (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                                        (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                                        (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                                        (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                                }

                                // Hover styles
                                $buttonHoverInlineStyles = '';
                                $buttonResetStyles = '';

                                if (!empty($buttonHoverTextColor)) {
                                    $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                                    $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                                }
                                if (!empty($buttonHoverBorderColor)) {
                                    $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                                    $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                                }
                                if (!empty($buttonHoverBackgroundColor)) {
                                    $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                                    $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                                }

                                // Button anchor tag
                                $output .= '<a class="rs-link read-more ' . esc_attr($buttonStyle1) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                                if (!empty($buttonHoverInlineStyles)) {
                                    $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                                }

                                if (!empty($buttonResetStyles)) {
                                    $output .= ' onmouseout="' . $buttonResetStyles . '"';
                                }

                                $output .= '>';

                                // Icon handling
                                $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                                $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                                $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                                if ($iconPosition === 'left' && $showButtonIcon) {
                                    $output .= $leftIcon . ' ';
                                }

                                $output .= esc_html($readMoreLabel);

                                if ($iconPosition === 'right' && $showButtonIcon) {
                                    $output .= ' ' . $rightIcon;
                                }

                                $output .= '</a></div>';
                            }
                            // End Button

                            $output .= '</div>';
                            // Add any other post content here (title, meta, etc.)
                        $output .= '</div>'; // .fancy-post-item
                    $output .= '</div>'; // .col-lg-5

                    // START RIGHT SIDE WRAPPER for remaining posts
                    $output .= '<div class="col-lg-7">';
                } else {
                    // RIGHT SIDE - All other posts
                    $output .= '<div class="rs-blog__left-blog right-blog align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                        // MARGIN    
                        if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                            $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                        } else { // Default fallback
                            $output .= 'margin: 40px 0px 0px 0px;';
                        }

                        // Padding
                        if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                            $output .= 'padding: ' . 
                                (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                                (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                                (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                                (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                        }

                        // Border Radius
                        if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                            $output .= 'border-radius: ' . 
                                (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                                (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                                (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                                (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                        }

                        // Border Width
                        if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                            $output .= 'border-width: ' . 
                                (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                                (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                                (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                                (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                        }

                        // Border Style & Color
                        if (!empty($itemBorderType)) {
                            $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                        }
                        if (!empty($itemBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                        }

                        // Background Color
                        if (!empty($itemBackgroundColor)) {
                            $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                        }

                        // Box Shadow
                        if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                            $output .= 'box-shadow: ' . 
                                (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                                (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                                (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                                (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                                esc_attr($itemBoxShadowColor) . '; ';
                        }

                    $output .= '">';
                            // Thumbnail
                            if ($rightThumbnailSize && $showThumbnail) {
                                $output .= '<div class="rs-blog__thumb" style="';

                                // Margin
                                if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                                    $output .= 'margin: ' . 
                                        (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                                        (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                                        (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                                        (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                                }

                                // Padding
                                if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                                    $output .= 'padding: ' . 
                                        (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                                        (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                                        (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                                        (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                                }

                                $output .= '">';

                                // Anchor with optional border-radius and overflow
                                $output .= '<a href="' . esc_url($permalink) . '" style="';

                                    if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                                        $output .= ' border-radius: ' .
                                            (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                                            (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                                            (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                                            (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                                    }

                                $output .= '">';
                                $output .= $rightThumbnailSize . '</a>';
                                if ($showPostCategory) {
                                        
                                    $output .= '<div class="rs-category" style="color:' . esc_attr($metaTextColor) . ';">';
                                        if ($showPostCategoryIcon && $showMetaIcon) {
                                            $output .= '<i class="ri-folder-line" style="color:' . esc_attr($metaIconColor) . '; font-size:' . esc_attr($metaFontSize) . 'px;"></i> ';
                                        }

                                        // Get category names without links
                                        $categories_list = get_the_category($post_id);
                                        if (!empty($categories_list)) {
                                            $category_names = array();
                                            foreach ($categories_list as $category) {
                                                $category_names[] = esc_html($category->name);
                                            }
                                            $output .= implode(', ', $category_names); // comma-separated plain text categories
                                        }
                                    $output .= '</div>';
                                }
                                $output .= '</div>';
                            }
                            // END Thumbnail
                            // MAIN Content
                            $output .= '<div class="rs-blog__content" style="';
                                // Margin
                                if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                                    $output .= 'margin: ' .
                                        (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                                        (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                                        (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                                        (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                                }
                                // Padding
                                if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                                    $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                                } else { // Default fallback
                                    $output .= 'padding: 20px 0px 0px 0px;';
                                }
                                // Check if at least one side is not empty
                                if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                                    $output .= 'border-width: ' .
                                        (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                                        (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                                        (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                                        (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                                }
                                // Border Style
                                if (!empty($contentNormalBorderType)) {
                                    $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                                }
                                // Background Color
                                if (!empty($contentBgColor)) {
                                    $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                                }
                                // Border Color
                                if (!empty($contentBorderColor)) {
                                    $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                                }
                            $output .= '">';

                            // Meta Data
                            if ($showMetaData) {
                                $output .= '<ul class="meta-data-list align-' . $metaAlignment1 . ' " style="';  
                                    // Margin
                                    if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                                        $output .= 'margin: ' .
                                            (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                            (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                            (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                            (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                                    }
                                    // Padding
                                    if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                                        $output .= 'padding: ' .
                                            (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                            (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                            (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                            (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                                    }   
                                    
                                    // Color
                                    if (!empty($metaTextColor)) {
                                        $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                    }
                                    // Order
                                    if (!empty($metaOrder)) {
                                        $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                    }
                                $output .= '">';

                                $meta_items = [];
                                // Author
                                if ($showPostAuthor) {
                                    $meta = '<li class="meta-author" style="';

                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostAuthorIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-user" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Date
                                if ($showPostDate) {
                                    $meta = '<li class="meta-date" style="';

                                    // Color
                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    // Font size
                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    // Icon
                                    if ($showPostDateIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-calendar-alt" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($getdate) . '</li>';
                                    $meta_items[] = $meta;
                                }
                                
                                
                                // Tags
                                if ($showPostTags && !empty($tags)) {
                                    $meta = '<li class="meta-tags" style="';

                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostTagsIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-tags" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Comment Count
                                if ($showPostCommentsCount) {
                                    $meta = '<li class="meta-comment-count" style="';
                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }
                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostCommentsCountIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-comments" style="';
                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }
                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }
                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Now join meta items with the separator
                                if (!empty($meta_items)) {
                                    $separator = '';

                                    if ($metaSeperator !== '') {
                                        $separator = '';
                                        if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                            $separatorStyle = '';
                                            if (!empty($separatorColor)) {
                                                $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                            }
                                            if (!empty($metaFontSize)) {
                                                $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                                        }
                                    }

                                    $output .= implode($separator, $meta_items);
                                }
                                $output .= '</ul>'; // Close meta-data-list               
                            }
                            // End Meta Data

                            // title
                            if ($showPostTitle) {
                                $titleStyles = '';

                                // Order
                                if (!empty($titleOrder)) {
                                    $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                                }
                                // Background color
                                if (!empty($postTitleBgColor)) {
                                    $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                                }
                                // Margin
                                if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                                    $titleStyles .= 'margin: ' .
                                        (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                                        (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                                        (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                                        (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                                }
                                // Padding
                                if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                                    $titleStyles .= 'padding: ' .
                                        (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                                        (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                                        (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                                        (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                                }
                                // Class name
                                $classNames = 'title' 
                                    . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                                    . ' align-' . esc_attr($postTitleAlignment);
                                // Hover JS (conditionally included)
                                $onmouseover = !empty($postTitleHoverBgColor) 
                                    ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                                    : '';
                                $onmouseout = !empty($postTitleBgColor) 
                                    ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                                    : '';
                                // Final output
                                $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                                    . $onmouseover 
                                    . $onmouseout 
                                    . '>';

                                $style = '';
                                $hoverStyle = '';
                                $mouseoutStyle = '';

                                // Build inline styles conditionally
                                if (!empty($postTitleFontSize)) {
                                    $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                }
                                if (!empty($postTitleLineHeight)) {
                                    $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                }
                                if (!empty($postTitleLetterSpacing)) {
                                    $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                }
                                if (!empty($postTitleFontWeight)) {
                                    $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                }
                                if (!empty($postTitleColor)) {
                                    $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                    $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                }
                                // Build hover color style if set
                                if (!empty($postTitleHoverColor)) {
                                    $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                }
                                // Final output
                                $output .= '<a href="' . esc_url($permalink) . '" 
                                    style="' . esc_attr(trim($style)) . '"'
                                    . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                                    . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                    . esc_html($croppedTitle) . '</a>';    
                                $output .= '</' . esc_attr($titleTag) . '>';
                            }

                            // Button Output                
                            if ($showReadMoreButton) {
                                // Button wrapper styles
                                $buttonWrapperStyle = '';

                                // Margin
                                if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                                    $buttonWrapperStyle .= 'margin: ' .
                                        (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                                        (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                                        (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                                        (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                                }

                                // Order
                                if (!empty($buttonOrder)) {
                                    $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                                }

                               
                                $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                                // Button inline styles
                                $buttonInlineStyles = '';

                                if (!empty($buttonTextColor)) {
                                    $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                                }
                                if (!empty($buttonBackgroundColor)) {
                                    $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                                }
                                if (!empty($buttonFontSize)) {
                                    $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                                }
                                if (!empty($buttonFontWeight)) {
                                    $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                                }
                                if (!empty($buttonBorderColor)) {
                                    $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                                }
                                if (!empty($buttonBorderType)) {
                                    $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                                }

                                // Border width
                                
                                if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                                    $buttonInlineStyles .= 'border-width: ' .
                                        (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                                        (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                                        (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                                        (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                                }
                                if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                                    $buttonInlineStyles .= 'border-radius: ' .
                                        (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                                        (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                                        (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                                        (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                                }
                                if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                                    $buttonInlineStyles .= 'padding: ' .
                                        (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                                        (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                                        (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                                        (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                                }

                                // Hover styles
                                $buttonHoverInlineStyles = '';
                                $buttonResetStyles = '';

                                if (!empty($buttonHoverTextColor)) {
                                    $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                                    $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                                }
                                if (!empty($buttonHoverBorderColor)) {
                                    $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                                    $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                                }
                                if (!empty($buttonHoverBackgroundColor)) {
                                    $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                                    $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                                }

                                // Button anchor tag
                                $output .= '<a class="rs-link read-more ' . esc_attr($buttonStyle1) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                                if (!empty($buttonHoverInlineStyles)) {
                                    $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                                }

                                if (!empty($buttonResetStyles)) {
                                    $output .= ' onmouseout="' . $buttonResetStyles . '"';
                                }

                                $output .= '>';

                                // Icon handling
                                $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                                $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                                $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                                if ($iconPosition === 'left' && $showButtonIcon) {
                                    $output .= $leftIcon . ' ';
                                }

                                $output .= esc_html($readMoreLabel);

                                if ($iconPosition === 'right' && $showButtonIcon) {
                                    $output .= ' ' . $rightIcon;
                                }

                                $output .= '</a></div>';
                            }
                            // End Button

                            $output .= '</div>';
                            // Add any other post content here (title, meta, etc.)
                        $output .= '</div>'; // .fancy-post-item
                    // DO NOT close .col-lg-7 here, it should be closed after the loop ends
                }
            } else if ($listLayoutStyle === 'style2') {
                if ($post_count === 1) {
                    // LEFT SIDE - Only the first post
                    $output .= '<div class="col-lg-6">';
                        $output .= '<div class="blog-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                            // MARGIN    
                            if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                                $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                            } else { // Default fallback
                                $output .= 'margin: 40px 0px 0px 0px;';
                            }

                            // Padding
                            if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                                $output .= 'padding: ' . 
                                    (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                                    (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                                    (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                                    (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                            }

                            // Border Radius
                            if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                                $output .= 'border-radius: ' . 
                                    (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                                    (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                                    (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                                    (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                            }

                            // Border Width
                            if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                                $output .= 'border-width: ' . 
                                    (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                                    (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                                    (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                                    (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                            }

                            // Border Style & Color
                            if (!empty($itemBorderType)) {
                                $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                            }
                            if (!empty($itemBorderColor)) {
                                $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                            }

                            // Background Color
                            if (!empty($itemBackgroundColor)) {
                                $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                            }

                            // Box Shadow
                            if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                                $output .= 'box-shadow: ' . 
                                    (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                                    (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                                    (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                                    (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                                    esc_attr($itemBoxShadowColor) . '; ';
                            }

                        $output .= '">';

                            // Thumbnail
                            if ($leftThumbnailSize && $showThumbnail) {
                                $output .= '<div class="image-wrap" style="';

                                // Margin
                                if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                                    $output .= 'margin: ' . 
                                        (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                                        (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                                        (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                                        (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                                }

                                // Padding
                                if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                                    $output .= 'padding: ' . 
                                        (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                                        (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                                        (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                                        (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                                }

                                $output .= '">';

                                // Anchor with optional border-radius and overflow
                                $output .= '<a href="' . esc_url($permalink) . '" style="';

                                    if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                                        $output .= ' border-radius: ' .
                                            (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                                            (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                                            (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                                            (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                                    }

                                $output .= '">';
                                $output .= $leftThumbnailSize . '</a>';
                                
                                $output .= '</div>';
                            }
                            // END Thumbnail
                            // MAIN Content
                            $output .= '<div class="blog-content" style="';
                                // Margin
                                if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                                    $output .= 'margin: ' .
                                        (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                                        (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                                        (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                                        (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                                }
                                // Padding
                                if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                                    $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                                } else { // Default fallback
                                    $output .= 'padding: 20px 20px 20px 20px;';
                                }
                                // Check if at least one side is not empty
                                if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                                    $output .= 'border-width: ' .
                                        (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                                        (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                                        (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                                        (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                                }
                                // Border Style
                                if (!empty($contentNormalBorderType)) {
                                    $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                                }
                                // Background Color
                                if (!empty($contentBgColor)) {
                                    $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                                }
                                // Border Color
                                if (!empty($contentBorderColor)) {
                                    $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                                }
                            $output .= '">';

                            // Meta Data
                            if ($showMetaData) {
                                $output .= '<ul class="blog-meta align-' . $metaAlignment2 . ' " style="';  
                                    // Margin
                                    if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                                        $output .= 'margin: ' .
                                            (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                            (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                            (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                            (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                                    }
                                    // Padding
                                    if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                                        $output .= 'padding: ' .
                                            (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                            (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                            (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                            (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                                    }   
                                    
                                    // Color
                                    if (!empty($metaTextColor)) {
                                        $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                    }
                                    // Order
                                    if (!empty($metaOrder)) {
                                        $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                    }
                                $output .= '">';

                                $meta_items = [];
                                // Author
                                if ($showPostAuthor) {
                                    $meta = '<li class="admin" style="';

                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostAuthorIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-user" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Date
                                if ($showPostDate) {
                                    $meta = '<li class="meta-date" style="';

                                    // Color
                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    // Font size
                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    // Icon
                                    if ($showPostDateIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-calendar-alt" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($getdate) . '</li>';
                                    $meta_items[] = $meta;
                                }
                                
                                // Category
                                if ($showPostCategory) {
                                    $meta = '<li class="meta-categories" style="';

                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostCategoryIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-folder" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    // Get category names without links
                                    $categories_list = get_the_category($post_id);
                                    if (!empty($categories_list)) {
                                        $category_names = array();
                                        foreach ($categories_list as $category) {
                                            $category_names[] = esc_html($category->name);
                                        }
                                        $meta .= implode(', ', $category_names); // comma-separated plain text categories
                                    }

                                    $meta .= '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Tags
                                if ($showPostTags && !empty($tags)) {
                                    $meta = '<li class="meta-tags" style="';

                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostTagsIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-tags" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Comment Count
                                if ($showPostCommentsCount) {
                                    $meta = '<li class="meta-comment-count" style="';
                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }
                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostCommentsCountIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-comments" style="';
                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }
                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }
                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Now join meta items with the separator
                                if (!empty($meta_items)) {
                                    $separator = '';

                                    if ($metaSeperator !== '') {
                                        $separator = '';
                                        if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                            $separatorStyle = '';
                                            if (!empty($separatorColor)) {
                                                $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                            }
                                            if (!empty($metaFontSize)) {
                                                $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                                        }
                                    }

                                    $output .= implode($separator, $meta_items);
                                }
                                $output .= '</ul>'; // Close meta-data-list               
                            }
                            // End Meta Data

                            // title
                            if ($showPostTitle) {
                                $titleStyles = '';

                                // Order
                                if (!empty($titleOrder)) {
                                    $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                                }
                                // Background color
                                if (!empty($postTitleBgColor)) {
                                    $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                                }
                                // Margin
                                if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                                    $titleStyles .= 'margin: ' .
                                        (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                                        (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                                        (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                                        (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                                }
                                // Padding
                                if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                                    $titleStyles .= 'padding: ' .
                                        (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                                        (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                                        (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                                        (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                                }
                                // Class name
                                $classNames = 'blog-title' 
                                    . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                                    . ' align-' . esc_attr($postTitleAlignment);
                                // Hover JS (conditionally included)
                                $onmouseover = !empty($postTitleHoverBgColor) 
                                    ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                                    : '';
                                $onmouseout = !empty($postTitleBgColor) 
                                    ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                                    : '';
                                // Final output
                                $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                                    . $onmouseover 
                                    . $onmouseout 
                                    . '>';

                                $style = '';
                                $hoverStyle = '';
                                $mouseoutStyle = '';

                                // Build inline styles conditionally
                                if (!empty($postTitleFontSize)) {
                                    $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                }
                                if (!empty($postTitleLineHeight)) {
                                    $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                }
                                if (!empty($postTitleLetterSpacing)) {
                                    $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                }
                                if (!empty($postTitleFontWeight)) {
                                    $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                }
                                if (!empty($postTitleColor)) {
                                    $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                    $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                }
                                // Build hover color style if set
                                if (!empty($postTitleHoverColor)) {
                                    $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                }
                                // Final output
                                $output .= '<a href="' . esc_url($permalink) . '" 
                                    style="' . esc_attr(trim($style)) . '"'
                                    . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                                    . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                    . esc_html($croppedTitle) . '</a>';    
                                $output .= '</' . esc_attr($titleTag) . '>';
                            }

                            // Excerpt
                            if ($showPostExcerpt) {
                                $excerptStyles = '';

                                // Order
                                if (!empty($excerptOrder)) {
                                    $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                                }

                                // Typography
                                if (!empty($excerptFontSize)) {
                                    $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                                }

                                if (!empty($excerptLineHeight)) {
                                    $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                                }

                                if (!empty($excerptLetterSpacing)) {
                                    $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                                }

                                if (!empty($excerptFontWeight)) {
                                    $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                                }

                                if (!empty($excerptColor)) {
                                    $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                                }

                                if (!empty($excerptBgColor)) {
                                    $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                                }

                                if (!empty($excerptBorderType)) {
                                    $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                                }

                                // Margin
                                if (!empty($excerptMargin['top']) || !empty($excerptMargin['right']) || !empty($excerptMargin['bottom']) || !empty($excerptMargin['left'])) {
                                    $excerptStyles .= 'margin: ' .
                                        (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) . ' ' .
                                        (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) . ' ' .
                                        (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) . ' ' .
                                        (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) . '; ';
                                }

                                // Padding
                                if (!empty($excerptPadding['top']) || !empty($excerptPadding['right']) || !empty($excerptPadding['bottom']) || !empty($excerptPadding['left'])) {
                                    $excerptStyles .= 'padding: ' .
                                        (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) . ' ' .
                                        (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) . ' ' .
                                        (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) . ' ' .
                                        (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) . '; ';
                                }

                                // Handle hover logic conditionally
                                $hoverIn = '';
                                $hoverOut = '';

                                if (!empty($excerptHoverColor)) {
                                    $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                                    $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                                }

                                if (!empty($excerptHoverBgColor)) {
                                    $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                                    $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                                }

                                if (!empty($excerptHoverBorderColor)) {
                                    $hoverIn .= 'this.style.borderColor=\'' . esc_attr($excerptHoverBorderColor) . '\';';
                                    $hoverOut .= 'this.style.borderColor=\'inherit\';';
                                }

                                $output .= '<div class="desc' . ' align-' . esc_attr($excerptAlignment2) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                                if (!empty($hoverIn) || !empty($hoverOut)) {
                                    $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                                    $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                                }

                                $output .= '>';
                                $output .= '<p>' . esc_html($excerpt) . '</p>';
                                $output .= '</div>';
                            }
                            // End Excerpt

                            // Button Output                
                            if ($showReadMoreButton) {
                                // Button wrapper styles
                                $buttonWrapperStyle = '';

                                // Margin
                                if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                                    $buttonWrapperStyle .= 'margin: ' .
                                        (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                                        (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                                        (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                                        (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                                }

                                // Order
                                if (!empty($buttonOrder)) {
                                    $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                                }

                               
                                $output .= '<div class="blog-btn align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                                // Button inline styles
                                $buttonInlineStyles = '';

                                if (!empty($buttonTextColor)) {
                                    $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                                }
                                if (!empty($buttonBackgroundColor)) {
                                    $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                                }
                                if (!empty($buttonFontSize)) {
                                    $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                                }
                                if (!empty($buttonFontWeight)) {
                                    $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                                }
                                if (!empty($buttonBorderColor)) {
                                    $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                                }
                                if (!empty($buttonBorderType)) {
                                    $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                                }

                                // Border width
                                
                                if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                                    $buttonInlineStyles .= 'border-width: ' .
                                        (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                                        (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                                        (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                                        (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                                }
                                if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                                    $buttonInlineStyles .= 'border-radius: ' .
                                        (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                                        (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                                        (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                                        (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                                }
                                if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                                    $buttonInlineStyles .= 'padding: ' .
                                        (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                                        (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                                        (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                                        (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                                }

                                // Hover styles
                                $buttonHoverInlineStyles = '';
                                $buttonResetStyles = '';

                                if (!empty($buttonHoverTextColor)) {
                                    $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                                    $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                                }
                                if (!empty($buttonHoverBorderColor)) {
                                    $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                                    $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                                }
                                if (!empty($buttonHoverBackgroundColor)) {
                                    $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                                    $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                                }

                                // Button anchor tag
                                $output .= '<a class="rs-link read-more ' . esc_attr($buttonStyle2) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                                if (!empty($buttonHoverInlineStyles)) {
                                    $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                                }

                                if (!empty($buttonResetStyles)) {
                                    $output .= ' onmouseout="' . $buttonResetStyles . '"';
                                }

                                $output .= '>';

                                // Icon handling
                                $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                                $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                                $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                                if ($iconPosition === 'left' && $showButtonIcon) {
                                    $output .= $leftIcon . ' ';
                                }

                                $output .= esc_html($readMoreLabel);

                                if ($iconPosition === 'right' && $showButtonIcon) {
                                    $output .= ' ' . $rightIcon;
                                }

                                $output .= '</a></div>';
                            }
                            // End Button

                            $output .= '</div>';
                            // Add any other post content here (title, meta, etc.)
                        $output .= '</div>'; // .fancy-post-item
                    $output .= '</div>'; // .col-lg-6

                    // START RIGHT SIDE WRAPPER for remaining posts
                    $output .= '<div class="col-lg-6">';
                    $output .= '<div class="blog-horizontal">';
                } else {
                    // RIGHT SIDE - All other posts
                    $output .= '<div class="blog-meta mb-30 align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                        // MARGIN    
                        if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                            $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                        } else { // Default fallback
                            $output .= 'margin: 40px 0px 0px 0px;';
                        }

                        // Padding
                        if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                            $output .= 'padding: ' . 
                                (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                                (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                                (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                                (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                        }

                        // Border Radius
                        if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                            $output .= 'border-radius: ' . 
                                (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                                (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                                (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                                (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                        }

                        // Border Width
                        if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                            $output .= 'border-width: ' . 
                                (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                                (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                                (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                                (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                        }

                        // Border Style & Color
                        if (!empty($itemBorderType)) {
                            $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                        }
                        if (!empty($itemBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                        }

                        // Background Color
                        if (!empty($itemBackgroundColor)) {
                            $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                        }

                        // Box Shadow
                        if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                            $output .= 'box-shadow: ' . 
                                (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                                (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                                (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                                (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                                esc_attr($itemBoxShadowColor) . '; ';
                        }

                    $output .= '">';
                            $output .= '<div class="blog-item-wrap ">';
                            // Thumbnail
                            if ($rightThumbnailSize && $showThumbnail) {
                                $output .= '<div class="image-wrap" style="';

                                // Margin
                                if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                                    $output .= 'margin: ' . 
                                        (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                                        (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                                        (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                                        (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                                }

                                // Padding
                                if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                                    $output .= 'padding: ' . 
                                        (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                                        (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                                        (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                                        (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                                }

                                $output .= '">';

                                // Anchor with optional border-radius and overflow
                                $output .= '<a href="' . esc_url($permalink) . '" style="';

                                    if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                                        $output .= ' border-radius: ' .
                                            (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                                            (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                                            (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                                            (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                                    }

                                $output .= '">';
                                $output .= $rightThumbnailSize . '</a>';
                                
                                $output .= '</div>';
                            }
                            // END Thumbnail

                            // MAIN Content
                            $output .= '<div class="blog-content" style="';
                                // Margin
                                if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                                    $output .= 'margin: ' .
                                        (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                                        (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                                        (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                                        (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                                }
                                // Padding
                                if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                                    $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                                } else { // Default fallback
                                    $output .= 'padding: 20px 20px 20px 20px;';
                                }
                                // Check if at least one side is not empty
                                if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                                    $output .= 'border-width: ' .
                                        (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                                        (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                                        (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                                        (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                                }
                                // Border Style
                                if (!empty($contentNormalBorderType)) {
                                    $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                                }
                                // Background Color
                                if (!empty($contentBgColor)) {
                                    $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                                }
                                // Border Color
                                if (!empty($contentBorderColor)) {
                                    $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                                }
                            $output .= '">';

                            // Meta Data
                            if ($showMetaData) {
                                $output .= '<ul class="blog-meta align-' . $metaAlignment2 . ' " style="';  
                                    // Margin
                                    if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                                        $output .= 'margin: ' .
                                            (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                            (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                            (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                            (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                                    }
                                    // Padding
                                    if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                                        $output .= 'padding: ' .
                                            (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                            (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                            (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                            (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                                    }   
                                    
                                    // Color
                                    if (!empty($metaTextColor)) {
                                        $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                    }
                                    // Order
                                    if (!empty($metaOrder)) {
                                        $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                    }
                                $output .= '">';

                                $meta_items = [];
                                // Author
                                if ($showPostAuthor) {
                                    $meta = '<li class="admin" style="';

                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostAuthorIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-user" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                                    $meta_items[] = $meta;
                                }
                                
                                // Date
                                if ($showPostDate) {
                                    $meta = '<li class="meta-date" style="';

                                    // Color
                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    // Font size
                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    // Icon
                                    if ($showPostDateIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-calendar-alt" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($getdate) . '</li>';
                                    $meta_items[] = $meta;
                                }
                                
                                
                                // Now join meta items with the separator
                                if (!empty($meta_items)) {
                                    $separator = '';

                                    if ($metaSeperator !== '') {
                                        $separator = '';
                                        if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                            $separatorStyle = '';
                                            if (!empty($separatorColor)) {
                                                $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                            }
                                            if (!empty($metaFontSize)) {
                                                $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                                        }
                                    }

                                    $output .= implode($separator, $meta_items);
                                }
                                $output .= '</ul>'; // Close meta-data-list               
                            }
                            // End Meta Data

                            // title
                            if ($showPostTitle) {
                                $titleStyles = '';

                                // Order
                                if (!empty($titleOrder)) {
                                    $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                                }
                                // Background color
                                if (!empty($postTitleBgColor)) {
                                    $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                                }
                                // Margin
                                if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                                    $titleStyles .= 'margin: ' .
                                        (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                                        (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                                        (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                                        (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                                }
                                // Padding
                                if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                                    $titleStyles .= 'padding: ' .
                                        (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                                        (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                                        (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                                        (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                                }
                                // Class name
                                $classNames = 'blog-title' 
                                    . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                                    . ' align-' . esc_attr($postTitleAlignment);
                                // Hover JS (conditionally included)
                                $onmouseover = !empty($postTitleHoverBgColor) 
                                    ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                                    : '';
                                $onmouseout = !empty($postTitleBgColor) 
                                    ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                                    : '';
                                // Final output
                                $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                                    . $onmouseover 
                                    . $onmouseout 
                                    . '>';

                                $style = '';
                                $hoverStyle = '';
                                $mouseoutStyle = '';

                                // Build inline styles conditionally
                                if (!empty($postTitleFontSize)) {
                                    $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                }
                                if (!empty($postTitleLineHeight)) {
                                    $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                }
                                if (!empty($postTitleLetterSpacing)) {
                                    $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                }
                                if (!empty($postTitleFontWeight)) {
                                    $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                }
                                if (!empty($postTitleColor)) {
                                    $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                    $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                }
                                // Build hover color style if set
                                if (!empty($postTitleHoverColor)) {
                                    $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                }
                                // Final output
                                $output .= '<a href="' . esc_url($permalink) . '" 
                                    style="' . esc_attr(trim($style)) . '"'
                                    . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                                    . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                    . esc_html($croppedTitle) . '</a>';    
                                $output .= '</' . esc_attr($titleTag) . '>';
                            }

                            $output .= '</div>';
                            // Add any other post content here (title, meta, etc.)
                        $output .= '</div>'; // blog-item-wrap 
                        $output .= '</div>'; // .fancy-post-item
                        
                        
                    // DO NOT close .col-lg-7 here, it should be closed after the loop ends
                }
            } else if ($listLayoutStyle === 'style3') {
                if ($post_count === 1) {
                    // LEFT SIDE - Only the first post
                    $output .= '<div class="col-lg-6">';
                        $output .= '<div class="rs-blog-layout-17-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                            // MARGIN    
                            if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                                $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                            } else { // Default fallback
                                $output .= 'margin: 40px 0px 0px 0px;';
                            }

                            // Padding
                            if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                                $output .= 'padding: ' . 
                                    (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                                    (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                                    (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                                    (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                            }

                            // Border Radius
                            if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                                $output .= 'border-radius: ' . 
                                    (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                                    (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                                    (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                                    (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                            }

                            // Border Width
                            if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                                $output .= 'border-width: ' . 
                                    (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                                    (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                                    (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                                    (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                            }

                            // Border Style & Color
                            if (!empty($itemBorderType)) {
                                $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                            }
                            if (!empty($itemBorderColor)) {
                                $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                            }

                            // Background Color
                            if (!empty($itemBackgroundColor)) {
                                $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                            }

                            // Box Shadow
                            if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                                $output .= 'box-shadow: ' . 
                                    (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                                    (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                                    (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                                    (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                                    esc_attr($itemBoxShadowColor) . '; ';
                            }

                        $output .= '">';

                            // Thumbnail
                            if ($leftThumbnailSize && $showThumbnail) {
                                $output .= '<div class="rs-thumb" style="';

                                // Margin
                                if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                                    $output .= 'margin: ' . 
                                        (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                                        (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                                        (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                                        (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                                }

                                // Padding
                                if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                                    $output .= 'padding: ' . 
                                        (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                                        (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                                        (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                                        (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                                }

                                $output .= '">';

                                // Anchor with optional border-radius and overflow
                                $output .= '<a href="' . esc_url($permalink) . '" style="';

                                    if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                                        $output .= ' border-radius: ' .
                                            (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                                            (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                                            (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                                            (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                                    }

                                $output .= '">';
                                $output .= $leftThumbnailSize . '</a>';
                                
                                $output .= '</div>';
                            }

                            // END Thumbnail
                            // MAIN Content
                            $output .= '<div class="rs-content" style="';
                                // Margin
                                if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                                    $output .= 'margin: ' .
                                        (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                                        (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                                        (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                                        (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                                }
                                // Padding
                                if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                                    $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                                } 
                                // Check if at least one side is not empty
                                if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                                    $output .= 'border-width: ' .
                                        (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                                        (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                                        (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                                        (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                                }
                                // Border Style
                                if (!empty($contentNormalBorderType)) {
                                    $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                                }
                                // Background Color
                                if (!empty($contentBgColor)) {
                                    $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                                }
                                // Border Color
                                if (!empty($contentBorderColor)) {
                                    $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                                }
                            $output .= '">';

                            // Meta Data
                            if ($showMetaData) {
                                $output .= '<div class="rs-meta">';        
                                $output .= '<ul class="blog-meta align-' . $metaAlignment3 . ' " style="';  
                                    // Margin
                                    if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                                        $output .= 'margin: ' .
                                            (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                            (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                            (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                            (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                                    }
                                    // Padding
                                    if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                                        $output .= 'padding: ' .
                                            (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                            (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                            (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                            (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                                    }   
                                    
                                    // Color
                                    if (!empty($metaTextColor)) {
                                        $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                    }
                                    // Order
                                    if (!empty($metaOrder)) {
                                        $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                    }
                                $output .= '">';

                                $meta_items = [];

                                // Date
                                if ($showPostDate) {
                                    $meta = '<li class="meta-date" style="';

                                    // Color
                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    // Font size
                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    // Icon
                                    if ($showPostDateIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-calendar-alt" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($getdate) . '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Author
                                if ($showPostAuthor) {
                                    $meta = '<li class="meta-author" style="';

                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostAuthorIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-user" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Category
                                if ($showPostCategory) {
                                    $meta = '<li class="meta-categories" style="';

                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostCategoryIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-folder" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    // Get category names without links
                                    $categories_list = get_the_category($post_id);
                                    if (!empty($categories_list)) {
                                        $category_names = array();
                                        foreach ($categories_list as $category) {
                                            $category_names[] = esc_html($category->name);
                                        }
                                        $meta .= implode(', ', $category_names); // comma-separated plain text categories
                                    }

                                    $meta .= '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Tags
                                if ($showPostTags && !empty($tags)) {
                                    $meta = '<li class="meta-tags" style="';

                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostTagsIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-tags" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Comment Count
                                if ($showPostCommentsCount) {
                                    $meta = '<li class="meta-comment-count" style="';
                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }
                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostCommentsCountIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-comments" style="';
                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }
                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }
                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                                    $meta_items[] = $meta;
                                }

                                // Now join meta items with the separator
                                $output .= implode('<span class="meta-separator" style="color:' . esc_attr($metaIconColor) . '; font-size:' . esc_attr($metaFontSize) . 'px;">' . esc_html($metaSeperator) . '</span>', $meta_items);

                                $output .= '</ul>'; // Close meta-data-list
                                $output .= '</div>'; // Close meta-data-list
                                
                            }
                            // End Meta Data

                            // title
                            if ($showPostTitle) {
                                $titleStyles = '';

                                // Order
                                if (!empty($titleOrder)) {
                                    $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                                }
                                // Background color
                                if (!empty($postTitleBgColor)) {
                                    $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                                }
                                // Margin
                                if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                                    $titleStyles .= 'margin: ' .
                                        (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                                        (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                                        (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                                        (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                                }
                                // Padding
                                if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                                    $titleStyles .= 'padding: ' .
                                        (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                                        (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                                        (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                                        (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                                }
                                // Class name
                                $classNames = 'blog-title' 
                                    . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                                    . ' align-' . esc_attr($postTitleAlignment);
                                // Hover JS (conditionally included)
                                $onmouseover = !empty($postTitleHoverBgColor) 
                                    ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                                    : '';
                                $onmouseout = !empty($postTitleBgColor) 
                                    ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                                    : '';
                                // Final output
                                $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                                    . $onmouseover 
                                    . $onmouseout 
                                    . '>';

                                $style = '';
                                $hoverStyle = '';
                                $mouseoutStyle = '';

                                // Build inline styles conditionally
                                if (!empty($postTitleFontSize)) {
                                    $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                }
                                if (!empty($postTitleLineHeight)) {
                                    $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                }
                                if (!empty($postTitleLetterSpacing)) {
                                    $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                }
                                if (!empty($postTitleFontWeight)) {
                                    $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                }
                                if (!empty($postTitleColor)) {
                                    $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                    $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                }
                                // Build hover color style if set
                                if (!empty($postTitleHoverColor)) {
                                    $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                }
                                // Final output
                                $output .= '<a href="' . esc_url($permalink) . '" 
                                    style="' . esc_attr(trim($style)) . '"'
                                    . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                                    . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                    . esc_html($croppedTitle) . '</a>';    
                                $output .= '</' . esc_attr($titleTag) . '>';
                            }

                            // Button Output                
                            if ($showReadMoreButton) {
                                // Button wrapper styles
                                $buttonWrapperStyle = '';

                                // Margin
                                if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                                    $buttonWrapperStyle .= 'margin: ' .
                                        (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                                        (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                                        (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                                        (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                                }

                                // Order
                                if (!empty($buttonOrder)) {
                                    $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                                }

                               
                                $output .= '<div class="blog-btn align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                                // Button inline styles
                                $buttonInlineStyles = '';

                                if (!empty($buttonTextColor)) {
                                    $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                                }
                                if (!empty($buttonBackgroundColor)) {
                                    $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                                }
                                if (!empty($buttonFontSize)) {
                                    $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                                }
                                if (!empty($buttonFontWeight)) {
                                    $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                                }
                                if (!empty($buttonBorderColor)) {
                                    $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                                }
                                if (!empty($buttonBorderType)) {
                                    $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                                }

                                // Border width
                                
                                if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                                    $buttonInlineStyles .= 'border-width: ' .
                                        (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                                        (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                                        (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                                        (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                                }
                                if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                                    $buttonInlineStyles .= 'border-radius: ' .
                                        (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                                        (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                                        (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                                        (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                                }
                                if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                                    $buttonInlineStyles .= 'padding: ' .
                                        (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                                        (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                                        (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                                        (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                                }

                                // Hover styles
                                $buttonHoverInlineStyles = '';
                                $buttonResetStyles = '';

                                if (!empty($buttonHoverTextColor)) {
                                    $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                                    $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                                }
                                if (!empty($buttonHoverBorderColor)) {
                                    $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                                    $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                                }
                                if (!empty($buttonHoverBackgroundColor)) {
                                    $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                                    $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                                }

                                // Button anchor tag
                                $output .= '<a class="rs-btn read-more ' . esc_attr($buttonStyle3) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                                if (!empty($buttonHoverInlineStyles)) {
                                    $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                                }

                                if (!empty($buttonResetStyles)) {
                                    $output .= ' onmouseout="' . $buttonResetStyles . '"';
                                }

                                $output .= '>';

                                // Icon handling
                                $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                                $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                                $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                                if ($iconPosition === 'left' && $showButtonIcon) {
                                    $output .= $leftIcon . ' ';
                                }

                                $output .= esc_html($readMoreLabel);

                                if ($iconPosition === 'right' && $showButtonIcon) {
                                    $output .= ' ' . $rightIcon;
                                }

                                $output .= '</a></div>';
                            }
                            // End Button

                            $output .= '</div>';
                            // Add any other post content here (title, meta, etc.)
                        $output .= '</div>'; // .fancy-post-item
                    $output .= '</div>'; // .col-lg-6

                    // START RIGHT SIDE WRAPPER for remaining posts
                    $output .= '<div class="col-lg-6">';
                    
                } else {

                    // RIGHT SIDE - All other posts
                    $output .= '<div class="rs-blog-layout-17-item rs-blog-layout-17-item-list align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                        // MARGIN    
                        if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                            $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                        } else { // Default fallback
                            $output .= 'margin: 40px 0px 0px 0px;';
                        }

                        // Padding
                        if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                            $output .= 'padding: ' . 
                                (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                                (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                                (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                                (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                        }

                        // Border Radius
                        if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                            $output .= 'border-radius: ' . 
                                (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                                (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                                (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                                (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                        }

                        // Border Width
                        if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                            $output .= 'border-width: ' . 
                                (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                                (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                                (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                                (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                        }

                        // Border Style & Color
                        if (!empty($itemBorderType)) {
                            $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                        }
                        if (!empty($itemBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                        }

                        // Background Color
                        if (!empty($itemBackgroundColor)) {
                            $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                        }

                        // Box Shadow
                        if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                            $output .= 'box-shadow: ' . 
                                (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                                (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                                (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                                (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                                esc_attr($itemBoxShadowColor) . '; ';
                        }

                    $output .= '">';
                            
                            // Thumbnail
                            if ($rightThumbnailSize && $showThumbnail) {
                                $output .= '<div class="rs-thumb" style="';

                                // Margin
                                if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                                    $output .= 'margin: ' . 
                                        (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                                        (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                                        (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                                        (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                                }

                                // Padding
                                if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                                    $output .= 'padding: ' . 
                                        (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                                        (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                                        (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                                        (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                                }

                                $output .= '">';

                                // Anchor with optional border-radius and overflow
                                $output .= '<a href="' . esc_url($permalink) . '" style="';

                                    if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                                        $output .= ' border-radius: ' .
                                            (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                                            (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                                            (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                                            (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                                    }

                                $output .= '">';
                                $output .= $rightThumbnailSize . '</a>';
                                
                                $output .= '</div>';
                            }
                            // END Thumbnail

                            // MAIN Content
                            $output .= '<div class="rs-content" style="';
                                // Margin
                                if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                                    $output .= 'margin: ' .
                                        (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                                        (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                                        (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                                        (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                                }
                                // Padding
                                if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                                    $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                                } else { // Default fallback
                                    $output .= 'padding: 20px 20px 20px 20px;';
                                }
                                // Check if at least one side is not empty
                                if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                                    $output .= 'border-width: ' .
                                        (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                                        (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                                        (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                                        (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                                }
                                // Border Style
                                if (!empty($contentNormalBorderType)) {
                                    $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                                }
                                // Background Color
                                if (!empty($contentBgColor)) {
                                    $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                                }
                                // Border Color
                                if (!empty($contentBorderColor)) {
                                    $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                                }
                            $output .= '">';

                            // Meta Data
                            if ($showMetaData) {
                                $output .= '<div class="rs-meta">';        
                                $output .= '<ul class="blog-meta align-' . $metaAlignment3 . ' " style="';  
                                    // Margin
                                    if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                                        $output .= 'margin: ' .
                                            (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                            (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                            (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                            (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                                    }
                                    // Padding
                                    if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                                        $output .= 'padding: ' .
                                            (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                            (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                            (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                            (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                                    }   
                                    
                                    // Color
                                    if (!empty($metaTextColor)) {
                                        $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                    }
                                    // Order
                                    if (!empty($metaOrder)) {
                                        $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                    }
                                $output .= '">';

                                $meta_items = [];

                                // Date
                                if ($showPostDate) {
                                    $meta = '<li class="meta-date" style="';

                                    // Color
                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    // Font size
                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    // Icon
                                    if ($showPostDateIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-calendar-alt" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($getdate) . '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Author
                                if ($showPostAuthor) {
                                    $meta = '<li class="meta-author" style="';

                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostAuthorIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-user" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Now join meta items with the separator
                                $output .= implode('<span class="meta-separator" style="color:' . esc_attr($metaIconColor) . '; font-size:' . esc_attr($metaFontSize) . 'px;">' . esc_html($metaSeperator) . '</span>', $meta_items);

                                $output .= '</ul>'; // Close meta-data-list
                                $output .= '</div>'; // Close meta-data-list
                                
                            }
                            // End Meta Data

                            // title
                            if ($showPostTitle) {
                                $titleStyles = '';

                                // Order
                                if (!empty($titleOrder)) {
                                    $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                                }
                                // Background color
                                if (!empty($postTitleBgColor)) {
                                    $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                                }
                                // Margin
                                if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                                    $titleStyles .= 'margin: ' .
                                        (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                                        (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                                        (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                                        (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                                }
                                // Padding
                                if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                                    $titleStyles .= 'padding: ' .
                                        (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                                        (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                                        (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                                        (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                                }
                                // Class name
                                $classNames = 'blog-title' 
                                    . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                                    . ' align-' . esc_attr($postTitleAlignment);
                                // Hover JS (conditionally included)
                                $onmouseover = !empty($postTitleHoverBgColor) 
                                    ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                                    : '';
                                $onmouseout = !empty($postTitleBgColor) 
                                    ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                                    : '';
                                // Final output
                                $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                                    . $onmouseover 
                                    . $onmouseout 
                                    . '>';

                                $style = '';
                                $hoverStyle = '';
                                $mouseoutStyle = '';

                                // Build inline styles conditionally
                                if (!empty($postTitleFontSize)) {
                                    $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                }
                                if (!empty($postTitleLineHeight)) {
                                    $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                }
                                if (!empty($postTitleLetterSpacing)) {
                                    $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                }
                                if (!empty($postTitleFontWeight)) {
                                    $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                }
                                if (!empty($postTitleColor)) {
                                    $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                    $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                }
                                // Build hover color style if set
                                if (!empty($postTitleHoverColor)) {
                                    $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                }
                                // Final output
                                $output .= '<a href="' . esc_url($permalink) . '" 
                                    style="' . esc_attr(trim($style)) . '"'
                                    . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                                    . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                    . esc_html($croppedTitle) . '</a>';    
                                $output .= '</' . esc_attr($titleTag) . '>';
                            }
                            // Excerpt
                            if ($showPostExcerpt) {
                                $excerptStyles = '';

                                // Order
                                if (!empty($excerptOrder)) {
                                    $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                                }

                                // Typography
                                if (!empty($excerptFontSize)) {
                                    $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                                }

                                if (!empty($excerptLineHeight)) {
                                    $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                                }

                                if (!empty($excerptLetterSpacing)) {
                                    $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                                }

                                if (!empty($excerptFontWeight)) {
                                    $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                                }

                                if (!empty($excerptColor)) {
                                    $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                                }

                                if (!empty($excerptBgColor)) {
                                    $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                                }

                                if (!empty($excerptBorderType)) {
                                    $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                                }

                                // Margin
                                if (!empty($excerptMargin['top']) || !empty($excerptMargin['right']) || !empty($excerptMargin['bottom']) || !empty($excerptMargin['left'])) {
                                    $excerptStyles .= 'margin: ' .
                                        (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) . ' ' .
                                        (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) . ' ' .
                                        (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) . ' ' .
                                        (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) . '; ';
                                }

                                // Padding
                                if (!empty($excerptPadding['top']) || !empty($excerptPadding['right']) || !empty($excerptPadding['bottom']) || !empty($excerptPadding['left'])) {
                                    $excerptStyles .= 'padding: ' .
                                        (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) . ' ' .
                                        (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) . ' ' .
                                        (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) . ' ' .
                                        (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) . '; ';
                                }

                                // Handle hover logic conditionally
                                $hoverIn = '';
                                $hoverOut = '';

                                if (!empty($excerptHoverColor)) {
                                    $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                                    $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                                }

                                if (!empty($excerptHoverBgColor)) {
                                    $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                                    $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                                }

                                if (!empty($excerptHoverBorderColor)) {
                                    $hoverIn .= 'this.style.borderColor=\'' . esc_attr($excerptHoverBorderColor) . '\';';
                                    $hoverOut .= 'this.style.borderColor=\'inherit\';';
                                }

                                $output .= '<div class="fpg-excerpt' . ' align-' . esc_attr($excerptAlignment3) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                                if (!empty($hoverIn) || !empty($hoverOut)) {
                                    $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                                    $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                                }

                                $output .= '>';
                                $output .= '<p>' . esc_html($excerpt) . '</p>';
                                $output .= '</div>';
                            }
                            // End Excerpt

                            // Button Output                
                            if ($showReadMoreButton) {
                                // Button wrapper styles
                                $buttonWrapperStyle = '';

                                // Margin
                                if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                                    $buttonWrapperStyle .= 'margin: ' .
                                        (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                                        (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                                        (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                                        (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                                }

                                // Order
                                if (!empty($buttonOrder)) {
                                    $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                                }

                               
                                $output .= '<div class="blog-btn align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                                // Button inline styles
                                $buttonInlineStyles = '';

                                if (!empty($buttonTextColor)) {
                                    $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                                }
                                if (!empty($buttonBackgroundColor)) {
                                    $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                                }
                                if (!empty($buttonFontSize)) {
                                    $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                                }
                                if (!empty($buttonFontWeight)) {
                                    $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                                }
                                if (!empty($buttonBorderColor)) {
                                    $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                                }
                                if (!empty($buttonBorderType)) {
                                    $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                                }

                                // Border width
                                
                                if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                                    $buttonInlineStyles .= 'border-width: ' .
                                        (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                                        (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                                        (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                                        (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                                }
                                if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                                    $buttonInlineStyles .= 'border-radius: ' .
                                        (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                                        (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                                        (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                                        (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                                }
                                if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                                    $buttonInlineStyles .= 'padding: ' .
                                        (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                                        (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                                        (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                                        (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                                }

                                // Hover styles
                                $buttonHoverInlineStyles = '';
                                $buttonResetStyles = '';

                                if (!empty($buttonHoverTextColor)) {
                                    $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                                    $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                                }
                                if (!empty($buttonHoverBorderColor)) {
                                    $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                                    $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                                }
                                if (!empty($buttonHoverBackgroundColor)) {
                                    $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                                    $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                                }

                                // Button anchor tag
                                $output .= '<a class="rs-btn read-more ' . esc_attr($buttonStyle3) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                                if (!empty($buttonHoverInlineStyles)) {
                                    $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                                }

                                if (!empty($buttonResetStyles)) {
                                    $output .= ' onmouseout="' . $buttonResetStyles . '"';
                                }

                                $output .= '>';

                                // Icon handling
                                $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                                $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                                $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                                if ($iconPosition === 'left' && $showButtonIcon) {
                                    $output .= $leftIcon . ' ';
                                }

                                $output .= esc_html($readMoreLabel);

                                if ($iconPosition === 'right' && $showButtonIcon) {
                                    $output .= ' ' . $rightIcon;
                                }

                                $output .= '</a></div>';
                            }
                            // End Button

                            // Add any other post content here (title, meta, etc.)
                        $output .= '</div>'; // blog-item-wrap 
                        $output .= '</div>'; // .fancy-post-item
                        
                        
                    // DO NOT close .col-lg-7 here, it should be closed after the loop ends
                }
            } else if ($listLayoutStyle === 'style4') {
                
                // LEFT SIDE - Only the first post
                $output .= '<div class="col-lg-6">';
                    $output .= '<div class="rs-blog-layout-20-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                        // MARGIN    
                        if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                            $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                        } else { // Default fallback
                            $output .= 'margin: 40px 0px 0px 0px;';
                        }

                        // Padding
                        if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                            $output .= 'padding: ' . 
                                (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                                (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                                (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                                (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                        }

                        // Border Radius
                        if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                            $output .= 'border-radius: ' . 
                                (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                                (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                                (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                                (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                        }

                        // Border Width
                        if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                            $output .= 'border-width: ' . 
                                (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                                (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                                (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                                (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                        }

                        // Border Style & Color
                        if (!empty($itemBorderType)) {
                            $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                        }
                        if (!empty($itemBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                        }

                        // Background Color
                        if (!empty($itemBackgroundColor)) {
                            $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                        }

                        // Box Shadow
                        if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                            $output .= 'box-shadow: ' . 
                                (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                                (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                                (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                                (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                                esc_attr($itemBoxShadowColor) . '; ';
                        }

                    $output .= '">';

                        // Thumbnail
                        if ($thumbnail && $showThumbnail) {
                            $output .= '<div class="rs-thumb" style="';

                            // Margin
                            if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                                $output .= 'margin: ' . 
                                    (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                                    (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                                    (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                                    (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                            }

                            // Padding
                            if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                                $output .= 'padding: ' . 
                                    (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                                    (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                                    (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                                    (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                            }

                            $output .= '">';

                            // Anchor with optional border-radius and overflow
                            $output .= '<a href="' . esc_url($permalink) . '" style="';

                                if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                                    $output .= ' border-radius: ' .
                                        (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                                        (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                                        (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                                        (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                                }

                            $output .= '">';
                            $output .= $thumbnail . '</a></div>';
                        }

                        // END Thumbnail
                        // MAIN Content
                        $output .= '<div class="rs-content" style="';
                            // Margin
                            if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                                $output .= 'margin: ' .
                                    (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                                    (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                                    (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                                    (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                            }
                            // Padding
                            if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                                $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                            } else { // Default fallback
                                $output .= 'padding: 0px 0px 0px 0px;';
                            }
                            // Check if at least one side is not empty
                            if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                                $output .= 'border-width: ' .
                                    (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                                    (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                                    (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                                    (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                            }
                            // Border Style
                            if (!empty($contentNormalBorderType)) {
                                $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                            }
                            // Background Color
                            if (!empty($contentBgColor)) {
                                $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                            }
                            // Border Color
                            if (!empty($contentBorderColor)) {
                                $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                            }
                        $output .= '">';

                        // Meta Data
                        if ($showMetaData) {
                            $output .= '<div class="rs-meta">';        
                                $output .= '<ul class="blog-meta align-' . $metaAlignment3 . ' " style="';  
                                    // Margin
                                    if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                                        $output .= 'margin: ' .
                                            (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                            (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                            (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                            (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                                    }
                                    // Padding
                                    if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                                        $output .= 'padding: ' .
                                            (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                            (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                            (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                            (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                                    }   
                                    
                                    // Color
                                    if (!empty($metaTextColor)) {
                                        $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                    }
                                    // Order
                                    if (!empty($metaOrder)) {
                                        $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                    }
                                $output .= '">';

                                $meta_items = [];

                                // Date
                                if ($showPostDate) {
                                    $meta = '<li class="meta-date" style="';

                                    // Color
                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    // Font size
                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    // Icon
                                    if ($showPostDateIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-calendar-alt" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($getdate) . '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Author
                                if ($showPostAuthor) {
                                    $meta = '<li class="meta-author" style="';

                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostAuthorIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-user" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                                    $meta_items[] = $meta;
                                }
                                // Now join meta items with the separator
                                $output .= implode('<span class="meta-separator" style="color:' . esc_attr($metaIconColor) . '; font-size:' . esc_attr($metaFontSize) . 'px;">' . esc_html($metaSeperator) . '</span>', $meta_items);

                                $output .= '</ul>';  
                            $output .= '</div>';   
                        }
                        // End Meta Data

                        // title
                        if ($showPostTitle) {
                            $titleStyles = '';

                            // Order
                            if (!empty($titleOrder)) {
                                $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                            }
                            // Background color
                            if (!empty($postTitleBgColor)) {
                                $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                            }
                            // Margin
                            if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                                $titleStyles .= 'margin: ' .
                                    (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                                    (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                                    (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                                    (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                            }
                            // Padding
                            if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                                $titleStyles .= 'padding: ' .
                                    (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                                    (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                                    (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                                    (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                            }
                            // Class name
                            $classNames = 'title' 
                                . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                                . ' align-' . esc_attr($postTitleAlignment);
                            // Hover JS (conditionally included)
                            $onmouseover = !empty($postTitleHoverBgColor) 
                                ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                                : '';
                            $onmouseout = !empty($postTitleBgColor) 
                                ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                                : '';
                            // Final output
                            $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                                . $onmouseover 
                                . $onmouseout 
                                . '>';

                            $style = '';
                            $hoverStyle = '';
                            $mouseoutStyle = '';

                            // Build inline styles conditionally
                            if (!empty($postTitleFontSize)) {
                                $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }
                            if (!empty($postTitleLineHeight)) {
                                $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }
                            if (!empty($postTitleLetterSpacing)) {
                                $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }
                            if (!empty($postTitleFontWeight)) {
                                $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }
                            if (!empty($postTitleColor)) {
                                $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                            }
                            // Build hover color style if set
                            if (!empty($postTitleHoverColor)) {
                                $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                            }
                            // Final output
                            $output .= '<a href="' . esc_url($permalink) . '" 
                                style="' . esc_attr(trim($style)) . '"'
                                . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                                . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                . esc_html($croppedTitle) . '</a>';    
                            $output .= '</' . esc_attr($titleTag) . '>';
                        }

                        // Button Output                
                        if ($showReadMoreButton) {
                            // Button wrapper styles
                            $buttonWrapperStyle = '';

                            // Margin
                            if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                                $buttonWrapperStyle .= 'margin: ' .
                                    (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                                    (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                                    (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                                    (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                            }

                            // Order
                            if (!empty($buttonOrder)) {
                                $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                            }
                           
                            $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                            // Button inline styles
                            $buttonInlineStyles = '';

                            if (!empty($buttonTextColor)) {
                                $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                            }
                            if (!empty($buttonBackgroundColor)) {
                                $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                            }
                            if (!empty($buttonFontSize)) {
                                $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                            }
                            if (!empty($buttonFontWeight)) {
                                $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                            }
                            if (!empty($buttonBorderColor)) {
                                $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                            }
                            if (!empty($buttonBorderType)) {
                                $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                            }

                            // Border width
                            
                            if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                                $buttonInlineStyles .= 'border-width: ' .
                                    (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                                    (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                                    (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                                    (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                            }
                            if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                                $buttonInlineStyles .= 'border-radius: ' .
                                    (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                                    (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                                    (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                                    (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                            }
                            if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                                $buttonInlineStyles .= 'padding: ' .
                                    (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                                    (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                                    (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                                    (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                            }

                            // Hover styles
                            $buttonHoverInlineStyles = '';
                            $buttonResetStyles = '';

                            if (!empty($buttonHoverTextColor)) {
                                $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                                $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                            }
                            if (!empty($buttonHoverBorderColor)) {
                                $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                                $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                            }
                            if (!empty($buttonHoverBackgroundColor)) {
                                $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                                $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                            }

                            // Button anchor tag
                            $output .= '<a class="rs-btn read-more ' . esc_attr($buttonStyle1) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                            if (!empty($buttonHoverInlineStyles)) {
                                $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                            }

                            if (!empty($buttonResetStyles)) {
                                $output .= ' onmouseout="' . $buttonResetStyles . '"';
                            }

                            $output .= '>';

                            // Icon handling
                            $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                            $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                            $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                            if ($iconPosition === 'left' && $showButtonIcon) {
                                $output .= $leftIcon . ' ';
                            }

                            $output .= esc_html($readMoreLabel);

                            if ($iconPosition === 'right' && $showButtonIcon) {
                                $output .= ' ' . $rightIcon;
                            }

                            $output .= '</a></div>';
                        }
                        // End Button

                        $output .= '</div>';
                        // Add any other post content here (title, meta, etc.)
                    $output .= '</div>'; // .fancy-post-item
                $output .= '</div>';              
                
            } else if ($listLayoutStyle === 'style5') {
                
                // LEFT SIDE - Only the first post
                $output .= '<div class="col-lg-6">';
                    $output .= '<div class="rs-blog-layout-22-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                        // MARGIN    
                        if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                            $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                        } else { // Default fallback
                            $output .= 'margin: 40px 0px 0px 0px;';
                        }

                        // Padding
                        if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                            $output .= 'padding: ' . 
                                (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                                (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                                (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                                (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                        }

                        // Border Radius
                        if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                            $output .= 'border-radius: ' . 
                                (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                                (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                                (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                                (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                        }

                        // Border Width
                        if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                            $output .= 'border-width: ' . 
                                (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                                (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                                (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                                (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                        }

                        // Border Style & Color
                        if (!empty($itemBorderType)) {
                            $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                        }
                        if (!empty($itemBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                        }

                        // Background Color
                        if (!empty($itemBackgroundColor)) {
                            $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                        }

                        // Box Shadow
                        if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                            $output .= 'box-shadow: ' . 
                                (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                                (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                                (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                                (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                                esc_attr($itemBoxShadowColor) . '; ';
                        }

                    $output .= '">';

                        // Thumbnail
                        if ($thumbnail && $showThumbnail) {
                            $output .= '<div class="rs-thumb" style="';

                            // Margin
                            if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                                $output .= 'margin: ' . 
                                    (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                                    (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                                    (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                                    (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                            }

                            // Padding
                            if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                                $output .= 'padding: ' . 
                                    (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                                    (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                                    (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                                    (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                            }

                            $output .= '">';

                            // Anchor with optional border-radius and overflow
                            $output .= '<a href="' . esc_url($permalink) . '" style="';

                                if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                                    $output .= ' border-radius: ' .
                                        (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                                        (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                                        (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                                        (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                                }

                            $output .= '">';
                            $output .= $thumbnail . '</a></div>';
                        }

                        // END Thumbnail
                        // MAIN Content
                        $output .= '<div class="rs-content" style="';
                            // Margin
                            if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                                $output .= 'margin: ' .
                                    (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                                    (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                                    (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                                    (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                            }
                            // Padding
                            if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                                $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                            } else { // Default fallback
                                $output .= 'padding: 20px 0px 0px 0px;';
                            }
                            // Check if at least one side is not empty
                            if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                                $output .= 'border-width: ' .
                                    (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                                    (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                                    (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                                    (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                            }
                            // Border Style
                            if (!empty($contentNormalBorderType)) {
                                $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                            }
                            // Background Color
                            if (!empty($contentBgColor)) {
                                $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                            }
                            // Border Color
                            if (!empty($contentBorderColor)) {
                                $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                            }
                        $output .= '">';

                        // Meta Data
                        if ($showMetaData) {
                            $output .= '<div class="rs-meta">';        
                                $output .= '<ul class="blog-meta align-' . $metaAlignment5 . ' " style="';  
                                    // Margin
                                    if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                                        $output .= 'margin: ' .
                                            (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                            (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                            (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                            (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                                    }
                                    // Padding
                                    if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                                        $output .= 'padding: ' .
                                            (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                            (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                            (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                            (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                                    }   
                                    
                                    // Color
                                    if (!empty($metaTextColor)) {
                                        $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                    }
                                    // Order
                                    if (!empty($metaOrder)) {
                                        $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                    }
                                $output .= '">';

                                $meta_items = [];

                                // Date
                                if ($showPostDate) {
                                    $meta = '<li class="meta-date" style="';

                                    // Color
                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    // Font size
                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    // Icon
                                    if ($showPostDateIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-calendar-alt" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($getdate) . '</li>';
                                    $meta_items[] = $meta;
                                }
                                
                                // Category
                                if ($showPostCategory) {
                                    $meta = '<li class="meta-categories" style="';

                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostCategoryIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-folder" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    // Get category names without links
                                    $categories_list = get_the_category($post_id);
                                    if (!empty($categories_list)) {
                                        $category_names = array();
                                        foreach ($categories_list as $category) {
                                            $category_names[] = esc_html($category->name);
                                        }
                                        $meta .= implode(', ', $category_names); // comma-separated plain text categories
                                    }

                                    $meta .= '</li>';
                                    $meta_items[] = $meta;
                                }
                                

                                // Now join meta items with the separator
                                $output .= implode('<span class="meta-separator" style="color:' . esc_attr($metaIconColor) . '; font-size:' . esc_attr($metaFontSize) . 'px;">' . esc_html($metaSeperator) . '</span>', $meta_items);

                                $output .= '</ul>'; // Close meta-data-list
                            $output .= '</div>'; // Close meta-data-list
                        }
                        // End Meta Data

                        // title
                        if ($showPostTitle) {
                            $titleStyles = '';

                            // Order
                            if (!empty($titleOrder)) {
                                $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                            }
                            // Background color
                            if (!empty($postTitleBgColor)) {
                                $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                            }
                            // Margin
                            if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                                $titleStyles .= 'margin: ' .
                                    (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                                    (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                                    (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                                    (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                            }
                            // Padding
                            if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                                $titleStyles .= 'padding: ' .
                                    (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                                    (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                                    (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                                    (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                            }
                            // Class name
                            $classNames = 'title' 
                                . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                                . ' align-' . esc_attr($postTitleAlignment);
                            // Hover JS (conditionally included)
                            $onmouseover = !empty($postTitleHoverBgColor) 
                                ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                                : '';
                            $onmouseout = !empty($postTitleBgColor) 
                                ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                                : '';
                            // Final output
                            $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                                . $onmouseover 
                                . $onmouseout 
                                . '>';

                            $style = '';
                            $hoverStyle = '';
                            $mouseoutStyle = '';

                            // Build inline styles conditionally
                            if (!empty($postTitleFontSize)) {
                                $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }
                            if (!empty($postTitleLineHeight)) {
                                $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }
                            if (!empty($postTitleLetterSpacing)) {
                                $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }
                            if (!empty($postTitleFontWeight)) {
                                $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }
                            if (!empty($postTitleColor)) {
                                $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                            }
                            // Build hover color style if set
                            if (!empty($postTitleHoverColor)) {
                                $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                            }
                            // Final output
                            $output .= '<a href="' . esc_url($permalink) . '" 
                                style="' . esc_attr(trim($style)) . '"'
                                . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                                . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                . esc_html($croppedTitle) . '</a>';    
                            $output .= '</' . esc_attr($titleTag) . '>';
                        }

                        // Excerpt
                        if ($showPostExcerpt) {
                            $excerptStyles = '';

                            // Order
                            if (!empty($excerptOrder)) {
                                $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                            }

                            // Typography
                            if (!empty($excerptFontSize)) {
                                $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                            }

                            if (!empty($excerptLineHeight)) {
                                $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                            }

                            if (!empty($excerptLetterSpacing)) {
                                $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                            }

                            if (!empty($excerptFontWeight)) {
                                $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                            }

                            if (!empty($excerptColor)) {
                                $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                            }

                            if (!empty($excerptBgColor)) {
                                $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                            }

                            if (!empty($excerptBorderType)) {
                                $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                            }

                            // Margin
                            if (!empty($excerptMargin['top']) || !empty($excerptMargin['right']) || !empty($excerptMargin['bottom']) || !empty($excerptMargin['left'])) {
                                $excerptStyles .= 'margin: ' .
                                    (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) . ' ' .
                                    (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) . ' ' .
                                    (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) . ' ' .
                                    (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) . '; ';
                            }

                            // Padding
                            if (!empty($excerptPadding['top']) || !empty($excerptPadding['right']) || !empty($excerptPadding['bottom']) || !empty($excerptPadding['left'])) {
                                $excerptStyles .= 'padding: ' .
                                    (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) . ' ' .
                                    (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) . ' ' .
                                    (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) . ' ' .
                                    (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) . '; ';
                            }

                            // Handle hover logic conditionally
                            $hoverIn = '';
                            $hoverOut = '';

                            if (!empty($excerptHoverColor)) {
                                $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                                $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                            }

                            if (!empty($excerptHoverBgColor)) {
                                $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                                $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                            }

                            if (!empty($excerptHoverBorderColor)) {
                                $hoverIn .= 'this.style.borderColor=\'' . esc_attr($excerptHoverBorderColor) . '\';';
                                $hoverOut .= 'this.style.borderColor=\'inherit\';';
                            }

                            $output .= '<div class="fpg-excerpt' . ' align-' . esc_attr($excerptAlignment5) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                            if (!empty($hoverIn) || !empty($hoverOut)) {
                                $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                                $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                            }

                            $output .= '>';
                            $output .= '<p>' . esc_html($excerpt) . '</p>';
                            $output .= '</div>';
                        }
                        // End Excerpt

                        // Button Output                
                        if ($showReadMoreButton) {
                            // Button wrapper styles
                            $buttonWrapperStyle = '';

                            // Margin
                            if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                                $buttonWrapperStyle .= 'margin: ' .
                                    (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                                    (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                                    (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                                    (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                            }

                            // Order
                            if (!empty($buttonOrder)) {
                                $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                            }

                           
                            $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                            // Button inline styles
                            $buttonInlineStyles = '';

                            if (!empty($buttonTextColor)) {
                                $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                            }
                            if (!empty($buttonBackgroundColor)) {
                                $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                            }
                            if (!empty($buttonFontSize)) {
                                $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                            }
                            if (!empty($buttonFontWeight)) {
                                $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                            }
                            if (!empty($buttonBorderColor)) {
                                $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                            }
                            if (!empty($buttonBorderType)) {
                                $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                            }

                            // Border width
                            
                            if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                                $buttonInlineStyles .= 'border-width: ' .
                                    (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                                    (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                                    (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                                    (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                            }
                            if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                                $buttonInlineStyles .= 'border-radius: ' .
                                    (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                                    (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                                    (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                                    (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                            }
                            if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                                $buttonInlineStyles .= 'padding: ' .
                                    (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                                    (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                                    (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                                    (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                            }

                            // Hover styles
                            $buttonHoverInlineStyles = '';
                            $buttonResetStyles = '';

                            if (!empty($buttonHoverTextColor)) {
                                $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                                $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                            }
                            if (!empty($buttonHoverBorderColor)) {
                                $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                                $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                            }
                            if (!empty($buttonHoverBackgroundColor)) {
                                $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                                $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                            }

                            // Button anchor tag
                            $output .= '<a class="rs-btn read-more ' . esc_attr($buttonStyle5) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                            if (!empty($buttonHoverInlineStyles)) {
                                $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                            }

                            if (!empty($buttonResetStyles)) {
                                $output .= ' onmouseout="' . $buttonResetStyles . '"';
                            }

                            $output .= '>';

                            // Icon handling
                            $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                            $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                            $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                            if ($iconPosition === 'left' && $showButtonIcon) {
                                $output .= $leftIcon . ' ';
                            }

                            $output .= esc_html($readMoreLabel);

                            if ($iconPosition === 'right' && $showButtonIcon) {
                                $output .= ' ' . $rightIcon;
                            }

                            $output .= '</a></div>';
                        }
                        // End Button

                        $output .= '</div>';
                        // Add any other post content here (title, meta, etc.)
                    $output .= '</div>'; // .fancy-post-item
                $output .= '</div>';              
            } else if ($listLayoutStyle === 'style6') {
                
                // LEFT SIDE - Only the first post
                $output .= '<div class="col-lg-4">';
                    $output .= '<div class="rs-blog-layout-24-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                        // MARGIN    
                        if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                            $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                        } else { // Default fallback
                            $output .= 'margin: 40px 0px 0px 0px;';
                        }

                        // Padding
                        if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                            $output .= 'padding: ' . 
                                (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                                (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                                (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                                (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                        }

                        // Border Radius
                        if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                            $output .= 'border-radius: ' . 
                                (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                                (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                                (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                                (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                        }

                        // Border Width
                        if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                            $output .= 'border-width: ' . 
                                (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                                (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                                (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                                (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                        }

                        // Border Style & Color
                        if (!empty($itemBorderType)) {
                            $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                        }
                        if (!empty($itemBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                        }

                        // Background Color
                        if (!empty($itemBackgroundColor)) {
                            $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                        }

                        // Box Shadow
                        if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                            $output .= 'box-shadow: ' . 
                                (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                                (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                                (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                                (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                                esc_attr($itemBoxShadowColor) . '; ';
                        }

                    $output .= '">';

                        // Thumbnail
                        if ($thumbnail && $showThumbnail) {
                            $output .= '<div class="rs-thumb" style="';

                            // Margin
                            if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                                $output .= 'margin: ' . 
                                    (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                                    (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                                    (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                                    (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                            }

                            // Padding
                            if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                                $output .= 'padding: ' . 
                                    (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                                    (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                                    (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                                    (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                            }

                            $output .= '">';

                            // Anchor with optional border-radius and overflow
                            $output .= '<a href="' . esc_url($permalink) . '" style="';

                                if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                                    $output .= ' border-radius: ' .
                                        (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                                        (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                                        (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                                        (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                                }

                            $output .= '">';
                            $output .= $thumbnail . '</a></div>';
                        }
                        // END Thumbnail

                        // MAIN Content
                        $output .= '<div class="rs-content" style="';
                            // Margin
                            if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                                $output .= 'margin: ' .
                                    (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                                    (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                                    (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                                    (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                            }
                            // Padding
                            if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                                $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                            } 
                            // Check if at least one side is not empty
                            if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                                $output .= 'border-width: ' .
                                    (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                                    (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                                    (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                                    (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                            }
                            // Border Style
                            if (!empty($contentNormalBorderType)) {
                                $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                            }
                            // Background Color
                            if (!empty($contentBgColor)) {
                                $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                            }
                            // Border Color
                            if (!empty($contentBorderColor)) {
                                $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                            }
                        $output .= '">';

                        // Meta Data
                        if ($showMetaData) {
                            $output .= '<div class="rs-meta">';        
                                $output .= '<ul class="blog-meta align-' . $metaAlignment6 . ' " style="';  
                                    // Margin
                                    if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                                        $output .= 'margin: ' .
                                            (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                            (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                            (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                            (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                                    }
                                    // Padding
                                    if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                                        $output .= 'padding: ' .
                                            (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                            (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                            (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                            (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                                    }   
                                    
                                    // Color
                                    if (!empty($metaTextColor)) {
                                        $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                    }
                                    // Order
                                    if (!empty($metaOrder)) {
                                        $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                    }
                                $output .= '">';

                                $meta_items = [];

                                // Date
                                if ($showPostDate) {
                                    $meta = '<li class="meta-date" style="';

                                    // Color
                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    // Font size
                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    // Icon
                                    if ($showPostDateIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-calendar-alt" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($getdate) . '</li>';
                                    $meta_items[] = $meta;
                                }
                                
                                if ($showPostAuthor) {
                                    $meta = '<li class="meta-author" style="';

                                    if (!empty($metaTextColor)) {
                                        $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                    }

                                    if (!empty($metaFontSize)) {
                                        $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                    }

                                    $meta .= '">';

                                    if ($showPostAuthorIcon && $showMetaIcon) {
                                        $meta .= '<i class="fas fa-user" style="';

                                        if (!empty($metaIconColor)) {
                                            $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '"></i> ';
                                    }

                                    $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                                    $meta_items[] = $meta;
                                }
                                
                                // Now join meta items with the separator
                                $output .= implode('<span class="meta-separator" style="color:' . esc_attr($metaIconColor) . '; font-size:' . esc_attr($metaFontSize) . 'px;">' . esc_html($metaSeperator) . '</span>', $meta_items);

                                $output .= '</ul>'; // Close meta-data-list
                            $output .= '</div>'; // Close meta-data-list
                        }
                        // End Meta Data

                        // title
                        if ($showPostTitle) {
                            $titleStyles = '';

                            // Order
                            if (!empty($titleOrder)) {
                                $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                            }
                            // Background color
                            if (!empty($postTitleBgColor)) {
                                $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                            }
                            // Margin
                            if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                                $titleStyles .= 'margin: ' .
                                    (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                                    (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                                    (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                                    (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                            }
                            // Padding
                            if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                                $titleStyles .= 'padding: ' .
                                    (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                                    (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                                    (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                                    (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                            }
                            // Class name
                            $classNames = 'title' 
                                . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                                . ' align-' . esc_attr($postTitleAlignment);
                            // Hover JS (conditionally included)
                            $onmouseover = !empty($postTitleHoverBgColor) 
                                ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                                : '';
                            $onmouseout = !empty($postTitleBgColor) 
                                ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                                : '';
                            // Final output
                            $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                                . $onmouseover 
                                . $onmouseout 
                                . '>';

                            $style = '';
                            $hoverStyle = '';
                            $mouseoutStyle = '';

                            // Build inline styles conditionally
                            if (!empty($postTitleFontSize)) {
                                $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }
                            if (!empty($postTitleLineHeight)) {
                                $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }
                            if (!empty($postTitleLetterSpacing)) {
                                $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }
                            if (!empty($postTitleFontWeight)) {
                                $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }
                            if (!empty($postTitleColor)) {
                                $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                            }
                            // Build hover color style if set
                            if (!empty($postTitleHoverColor)) {
                                $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                            }
                            // Final output
                            $output .= '<a href="' . esc_url($permalink) . '" 
                                style="' . esc_attr(trim($style)) . '"'
                                . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                                . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                . esc_html($croppedTitle) . '</a>';    
                            $output .= '</' . esc_attr($titleTag) . '>';
                        }


                        $output .= '</div>';
                        // Add any other post content here (title, meta, etc.)
                    $output .= '</div>'; // .fancy-post-item
                $output .= '</div>';              
            } else if ($listLayoutStyle === 'style7') {
                               
                // LEFT SIDE - Only the first post
                $output .= '<div class="col-lg-12">';
                    $output .= '<div class="rs-blog-layout-25-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                        // MARGIN    
                        if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                            $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                        } else { // Default fallback
                            $output .= 'margin: 40px 0px 0px 0px;';
                        }

                        // Padding
                        if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                            $output .= 'padding: ' . 
                                (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                                (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                                (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                                (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                        }

                        // Border Radius
                        if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                            $output .= 'border-radius: ' . 
                                (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                                (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                                (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                                (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                        }

                        // Border Width
                        if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                            $output .= 'border-width: ' . 
                                (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                                (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                                (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                                (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                        }

                        // Border Style & Color
                        if (!empty($itemBorderType)) {
                            $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                        }
                        if (!empty($itemBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                        }

                        // Background Color
                        if (!empty($itemBackgroundColor)) {
                            $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                        }

                        // Box Shadow
                        if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                            $output .= 'box-shadow: ' . 
                                (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                                (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                                (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                                (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                                esc_attr($itemBoxShadowColor) . '; ';
                        }

                    $output .= '">';

                        // Thumbnail
                        if ($thumbnail && $showThumbnail) {
                            $output .= '<div class="rs-thumb" style="';

                            // Margin
                            if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                                $output .= 'margin: ' . 
                                    (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                                    (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                                    (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                                    (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                            }

                            // Padding
                            if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                                $output .= 'padding: ' . 
                                    (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                                    (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                                    (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                                    (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                            }

                            $output .= '">';

                            // Anchor with optional border-radius and overflow
                            $output .= '<a href="' . esc_url($permalink) . '" style="';

                                if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                                    $output .= ' border-radius: ' .
                                        (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                                        (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                                        (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                                        (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                                }

                            $output .= '">';
                            $output .= $thumbnail . '</a></div>';
                        }

                        // END Thumbnail
                        // MAIN Content
                        $output .= '<div class="rs-content" style="';
                            // Margin
                            if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                                $output .= 'margin: ' .
                                    (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                                    (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                                    (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                                    (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                            }
                            // Padding
                            if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                                $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                            } 
                            // Check if at least one side is not empty
                            if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                                $output .= 'border-width: ' .
                                    (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                                    (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                                    (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                                    (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                            }
                            // Border Style
                            if (!empty($contentNormalBorderType)) {
                                $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                            }
                            // Background Color
                            if (!empty($contentBgColor)) {
                                $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                            }
                            // Border Color
                            if (!empty($contentBorderColor)) {
                                $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                            }
                        $output .= '">';

                        // Meta Data
                        if ($showMetaData) {
                            $output .= '<div class="rs-cat align-' . $metaAlignment7 . '" style="';

                            // Margin
                            if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                                $output .= 'margin: ' .
                                    (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                    (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                    (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                    (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                            }

                            // Padding
                            if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                                $output .= 'padding: ' .
                                    (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                    (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                    (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                    (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                            }

                            // Color
                            if (!empty($metaTextColor)) {
                                $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                            }

                            // Order
                            if (!empty($metaOrder)) {
                                $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                            }

                            $output .= '">';

                            if ($showPostCategory) {
                                
                                $categories_list = get_the_category($post_id);
                                if (!empty($categories_list)) {
                                    $category_names = array();
                                    foreach ($categories_list as $category) {
                                        $category_names[] = esc_html($category->name);
                                    }
                                    $output .= '<a class="meta-value">' . implode(', ', $category_names) . '</a>';
                                }
                            }

                            $output .= '</div>'; // Close rs-cat
                        }
                        // End Meta Data

                        // title
                        if ($showPostTitle) {
                            $titleStyles = '';

                            // Order
                            if (!empty($titleOrder)) {
                                $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                            }
                            // Background color
                            if (!empty($postTitleBgColor)) {
                                $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                            }
                            // Margin
                            if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                                $titleStyles .= 'margin: ' .
                                    (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                                    (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                                    (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                                    (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                            }
                            // Padding
                            if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                                $titleStyles .= 'padding: ' .
                                    (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                                    (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                                    (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                                    (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                            }
                            // Class name
                            $classNames = 'blog-title' 
                                . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                                . ' align-' . esc_attr($postTitleAlignment);
                            // Hover JS (conditionally included)
                            $onmouseover = !empty($postTitleHoverBgColor) 
                                ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                                : '';
                            $onmouseout = !empty($postTitleBgColor) 
                                ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                                : '';
                            // Final output
                            $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                                . $onmouseover 
                                . $onmouseout 
                                . '>';

                            $style = '';
                            $hoverStyle = '';
                            $mouseoutStyle = '';

                            // Build inline styles conditionally
                            if (!empty($postTitleFontSize)) {
                                $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                            }
                            if (!empty($postTitleLineHeight)) {
                                $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                            }
                            if (!empty($postTitleLetterSpacing)) {
                                $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                            }
                            if (!empty($postTitleFontWeight)) {
                                $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                            }
                            if (!empty($postTitleColor)) {
                                $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                            }
                            // Build hover color style if set
                            if (!empty($postTitleHoverColor)) {
                                $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                            }
                            // Final output
                            $output .= '<a href="' . esc_url($permalink) . '" 
                                style="' . esc_attr(trim($style)) . '"'
                                . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                                . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                . esc_html($croppedTitle) . '</a>';    
                            $output .= '</' . esc_attr($titleTag) . '>';
                        }

                        // Button Output                
                        if ($showReadMoreButton) {
                            // Button wrapper styles
                            $buttonWrapperStyle = '';

                            // Margin
                            if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                                $buttonWrapperStyle .= 'margin: ' .
                                    (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                                    (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                                    (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                                    (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                            }

                            // Order
                            if (!empty($buttonOrder)) {
                                $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                            }

                           
                            $output .= '<div class="blog-btn align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                            // Button inline styles
                            $buttonInlineStyles = '';

                            if (!empty($buttonTextColor)) {
                                $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                            }
                            if (!empty($buttonBackgroundColor)) {
                                $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                            }
                            if (!empty($buttonFontSize)) {
                                $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                            }
                            if (!empty($buttonFontWeight)) {
                                $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                            }
                            if (!empty($buttonBorderColor)) {
                                $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                            }
                            if (!empty($buttonBorderType)) {
                                $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                            }

                            // Border width
                            
                            if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                                $buttonInlineStyles .= 'border-width: ' .
                                    (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                                    (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                                    (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                                    (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                            }
                            if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                                $buttonInlineStyles .= 'border-radius: ' .
                                    (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                                    (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                                    (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                                    (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                            }
                            if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                                $buttonInlineStyles .= 'padding: ' .
                                    (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                                    (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                                    (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                                    (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                            }

                            // Hover styles
                            $buttonHoverInlineStyles = '';
                            $buttonResetStyles = '';

                            if (!empty($buttonHoverTextColor)) {
                                $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                                $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                            }
                            if (!empty($buttonHoverBorderColor)) {
                                $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                                $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                            }
                            if (!empty($buttonHoverBackgroundColor)) {
                                $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                                $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                            }

                            // Button anchor tag
                            $output .= '<a class="rs-btn read-more ' . esc_attr($buttonStyle7) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                            if (!empty($buttonHoverInlineStyles)) {
                                $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                            }

                            if (!empty($buttonResetStyles)) {
                                $output .= ' onmouseout="' . $buttonResetStyles . '"';
                            }

                            $output .= '>';

                            // Icon handling
                            $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                            $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                            $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                            if ($iconPosition === 'left' && $showButtonIcon) {
                                $output .= $leftIcon . ' ';
                            }

                            $output .= esc_html($readMoreLabel);

                            if ($iconPosition === 'right' && $showButtonIcon) {
                                $output .= ' ' . $rightIcon;
                            }

                            $output .= '</a></div>';
                        }
                        // End Button

                        $output .= '</div>';
                        // Add any other post content here (title, meta, etc.)
                    $output .= '</div>'; // .fancy-post-item
                $output .= '</div>';              
            } else if ($listLayoutStyle === 'style8') {
                // LEFT SIDE: First 2 posts
                // LEFT SIDE: Open left column on first post
                if ($post_count === 1) {
                    $output .= '<div class="col-lg-6">'; // Left column open
                }

                // Post 1 – Large layout
                if ($post_count === 1) {
                    $output .= '<div class="rs-blog-layout-27-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                        // MARGIN    
                        if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                            $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                        } else { // Default fallback
                            $output .= 'margin: 40px 0px 0px 0px;';
                        }

                        // Padding
                        if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                            $output .= 'padding: ' . 
                                (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                                (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                                (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                                (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                        }

                        // Border Radius
                        if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                            $output .= 'border-radius: ' . 
                                (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                                (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                                (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                                (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                        }

                        // Border Width
                        if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                            $output .= 'border-width: ' . 
                                (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                                (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                                (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                                (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                        }

                        // Border Style & Color
                        if (!empty($itemBorderType)) {
                            $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                        }
                        if (!empty($itemBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                        }

                        // Background Color
                        if (!empty($itemBackgroundColor)) {
                            $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                        }

                        // Box Shadow
                        if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                            $output .= 'box-shadow: ' . 
                                (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                                (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                                (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                                (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                                esc_attr($itemBoxShadowColor) . '; ';
                        }

                    $output .= '">';

                    // Thumbnail
                    if ($leftThumbnailSize && $showThumbnail) {
                        $output .= '<div class="rs-thumb" style="';

                        // Margin
                        if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                            $output .= 'margin: ' . 
                                (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                                (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                                (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                                (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                        }

                        // Padding
                        if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                            $output .= 'padding: ' . 
                                (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                                (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                                (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                                (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                        }

                        $output .= '">';

                        // Anchor with optional border-radius and overflow
                        $output .= '<a href="' . esc_url($permalink) . '" style="';

                            if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                                $output .= ' border-radius: ' .
                                    (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                                    (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                                    (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                                    (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                            }

                        $output .= '">';
                        $output .= $leftThumbnailSize . '</a>';
                        
                        $output .= '</div>';
                    }
                    // END Thumbnail
                        // MAIN Content
                        $output .= '<div class="rs-content" style="';
                            // Margin
                            if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                                $output .= 'margin: ' .
                                    (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                                    (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                                    (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                                    (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                            }
                            // Padding
                            if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                                $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                            } else { // Default fallback
                                $output .= 'padding: 20px 20px 20px 20px;';
                            }
                            // Check if at least one side is not empty
                            if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                                $output .= 'border-width: ' .
                                    (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                                    (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                                    (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                                    (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                            }
                            // Border Style
                            if (!empty($contentNormalBorderType)) {
                                $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                            }
                            // Background Color
                            if (!empty($contentBgColor)) {
                                $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                            }
                            // Border Color
                            if (!empty($contentBorderColor)) {
                                $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                            }
                        $output .= '">';
                            //meta
                            if ($showMetaData) {
                                $output .= '<div class="rs-meta">';        
                                    $output .= '<ul class="blog-meta align-' . $metaAlignment8 . ' " style="';  
                                        // Margin
                                        if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                                            $output .= 'margin: ' .
                                                (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                                (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                                (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                                (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                                        }
                                        // Padding
                                        if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                                            $output .= 'padding: ' .
                                                (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                                (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                                (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                                (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                                        }   
                                        
                                        // Color
                                        if (!empty($metaTextColor)) {
                                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                        }
                                        // Order
                                        if (!empty($metaOrder)) {
                                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                        }
                                    $output .= '">';

                                    $meta_items = [];
                                    // Author
                                    if ($showPostAuthor) {
                                        $meta = '<li class="meta-author" style="';

                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        if ($showPostAuthorIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-user" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    // Date
                                    if ($showPostDate) {
                                        $meta = '<li class="meta-date" style="';

                                        // Color
                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        // Font size
                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        // Icon
                                        if ($showPostDateIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-calendar-alt" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html($getdate) . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    
                                    // Now join meta items with the separator
                                    $output .= implode('<span class="meta-separator" style="color:' . esc_attr($metaIconColor) . '; font-size:' . esc_attr($metaFontSize) . 'px;">' . esc_html($metaSeperator) . '</span>', $meta_items);

                                    $output .= '</ul>';  
                                $output .= '</div>';   
                            }

                            // title
                            if ($showPostTitle) {
                                $titleStyles = '';

                                // Order
                                if (!empty($titleOrder)) {
                                    $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                                }
                                // Background color
                                if (!empty($postTitleBgColor)) {
                                    $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                                }
                                // Margin
                                if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                                    $titleStyles .= 'margin: ' .
                                        (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                                        (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                                        (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                                        (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                                }
                                // Padding
                                if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                                    $titleStyles .= 'padding: ' .
                                        (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                                        (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                                        (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                                        (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                                }
                                // Class name
                                $classNames = 'title' 
                                    . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                                    . ' align-' . esc_attr($postTitleAlignment);
                                // Hover JS (conditionally included)
                                $onmouseover = !empty($postTitleHoverBgColor) 
                                    ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                                    : '';
                                $onmouseout = !empty($postTitleBgColor) 
                                    ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                                    : '';
                                // Final output
                                $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                                    . $onmouseover 
                                    . $onmouseout 
                                    . '>';

                                $style = '';
                                $hoverStyle = '';
                                $mouseoutStyle = '';

                                // Build inline styles conditionally
                                if (!empty($postTitleFontSize)) {
                                    $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                }
                                if (!empty($postTitleLineHeight)) {
                                    $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                }
                                if (!empty($postTitleLetterSpacing)) {
                                    $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                }
                                if (!empty($postTitleFontWeight)) {
                                    $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                }
                                if (!empty($postTitleColor)) {
                                    $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                    $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                }
                                // Build hover color style if set
                                if (!empty($postTitleHoverColor)) {
                                    $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                }
                                // Final output
                                $output .= '<a href="' . esc_url($permalink) . '" 
                                    style="' . esc_attr(trim($style)) . '"'
                                    . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                                    . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                    . esc_html($croppedTitle) . '</a>';    
                                $output .= '</' . esc_attr($titleTag) . '>';
                            }

                            // Button Output                
                            if ($showReadMoreButton) {
                                // Button wrapper styles
                                $buttonWrapperStyle = '';

                                // Margin
                                if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                                    $buttonWrapperStyle .= 'margin: ' .
                                        (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                                        (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                                        (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                                        (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                                }

                                // Order
                                if (!empty($buttonOrder)) {
                                    $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                                }

                               
                                $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                                // Button inline styles
                                $buttonInlineStyles = '';

                                if (!empty($buttonTextColor)) {
                                    $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                                }
                                if (!empty($buttonBackgroundColor)) {
                                    $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                                }
                                if (!empty($buttonFontSize)) {
                                    $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                                }
                                if (!empty($buttonFontWeight)) {
                                    $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                                }
                                if (!empty($buttonBorderColor)) {
                                    $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                                }
                                if (!empty($buttonBorderType)) {
                                    $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                                }

                                // Border width
                                
                                if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                                    $buttonInlineStyles .= 'border-width: ' .
                                        (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                                        (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                                        (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                                        (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                                }
                                if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                                    $buttonInlineStyles .= 'border-radius: ' .
                                        (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                                        (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                                        (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                                        (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                                }
                                if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                                    $buttonInlineStyles .= 'padding: ' .
                                        (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                                        (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                                        (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                                        (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                                }

                                // Hover styles
                                $buttonHoverInlineStyles = '';
                                $buttonResetStyles = '';

                                if (!empty($buttonHoverTextColor)) {
                                    $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                                    $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                                }
                                if (!empty($buttonHoverBorderColor)) {
                                    $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                                    $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                                }
                                if (!empty($buttonHoverBackgroundColor)) {
                                    $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                                    $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                                }

                                // Button anchor tag
                                $output .= '<a class="rs-btn read-more ' . esc_attr($buttonStyle8) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                                if (!empty($buttonHoverInlineStyles)) {
                                    $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                                }

                                if (!empty($buttonResetStyles)) {
                                    $output .= ' onmouseout="' . $buttonResetStyles . '"';
                                }

                                $output .= '>';

                                // Icon handling
                                $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                                $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                                $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                                if ($iconPosition === 'left' && $showButtonIcon) {
                                    $output .= $leftIcon . ' ';
                                }

                                $output .= esc_html($readMoreLabel);

                                if ($iconPosition === 'right' && $showButtonIcon) {
                                    $output .= ' ' . $rightIcon;
                                }

                                $output .= '</a></div>';
                            }
                            // End Button

                            $output .= '</div>';
                            // Add any other post content here (title, meta, etc.)
                        $output .= '</div>'; // .fancy-post-item
                }

                // Post 2 – Medium layout
                elseif ($post_count === 2) {
                    $output .= '<div class="rs-blog-layout-27-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                        // MARGIN    
                        if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                            $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                        } else { // Default fallback
                            $output .= 'margin: 40px 0px 0px 0px;';
                        }

                        // Padding
                        if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                            $output .= 'padding: ' . 
                                (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                                (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                                (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                                (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                        }

                        // Border Radius
                        if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                            $output .= 'border-radius: ' . 
                                (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                                (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                                (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                                (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                        }

                        // Border Width
                        if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                            $output .= 'border-width: ' . 
                                (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                                (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                                (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                                (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                        }

                        // Border Style & Color
                        if (!empty($itemBorderType)) {
                            $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                        }
                        if (!empty($itemBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                        }

                        // Background Color
                        if (!empty($itemBackgroundColor)) {
                            $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                        }

                        // Box Shadow
                        if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                            $output .= 'box-shadow: ' . 
                                (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                                (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                                (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                                (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                                esc_attr($itemBoxShadowColor) . '; ';
                        }

                    $output .= '">';

                        // MAIN Content
                        $output .= '<div class="rs-content" style="';
                            // Margin
                            if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                                $output .= 'margin: ' .
                                    (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                                    (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                                    (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                                    (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                            }
                            // Padding
                            if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                                $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                            } else { // Default fallback
                                $output .= 'padding: 20px 20px 20px 20px;';
                            }
                            // Check if at least one side is not empty
                            if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                                $output .= 'border-width: ' .
                                    (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                                    (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                                    (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                                    (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                            }
                            // Border Style
                            if (!empty($contentNormalBorderType)) {
                                $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                            }
                            // Background Color
                            if (!empty($contentBgColor)) {
                                $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                            }
                            // Border Color
                            if (!empty($contentBorderColor)) {
                                $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                            }
                        $output .= '">';

                            //meta
                            if ($showMetaData) {
                                $output .= '<div class="rs-meta">';        
                                    $output .= '<ul class="blog-meta align-' . $metaAlignment8 . ' " style="';  
                                        // Margin
                                        if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                                            $output .= 'margin: ' .
                                                (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                                (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                                (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                                (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                                        }
                                        // Padding
                                        if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                                            $output .= 'padding: ' .
                                                (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                                (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                                (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                                (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                                        }   
                                        
                                        // Color
                                        if (!empty($metaTextColor)) {
                                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                        }
                                        // Order
                                        if (!empty($metaOrder)) {
                                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                        }
                                    $output .= '">';

                                    $meta_items = [];
                                    // Author
                                    if ($showPostAuthor) {
                                        $meta = '<li class="meta-author" style="';

                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        if ($showPostAuthorIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-user" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    // Date
                                    if ($showPostDate) {
                                        $meta = '<li class="meta-date" style="';

                                        // Color
                                        if (!empty($metaTextColor)) {
                                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                        }

                                        // Font size
                                        if (!empty($metaFontSize)) {
                                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                        }

                                        $meta .= '">';

                                        // Icon
                                        if ($showPostDateIcon && $showMetaIcon) {
                                            $meta .= '<i class="fas fa-calendar-alt" style="';

                                            if (!empty($metaIconColor)) {
                                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '"></i> ';
                                        }

                                        $meta .= esc_html($getdate) . '</li>';
                                        $meta_items[] = $meta;
                                    }
                                    
                                    // Now join meta items with the separator
                                    $output .= implode('<span class="meta-separator" style="color:' . esc_attr($metaIconColor) . '; font-size:' . esc_attr($metaFontSize) . 'px;">' . esc_html($metaSeperator) . '</span>', $meta_items);

                                    $output .= '</ul>';  
                                $output .= '</div>';   
                            }

                            // title
                            if ($showPostTitle) {
                                $titleStyles = '';

                                // Order
                                if (!empty($titleOrder)) {
                                    $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                                }
                                // Background color
                                if (!empty($postTitleBgColor)) {
                                    $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                                }
                                // Margin
                                if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                                    $titleStyles .= 'margin: ' .
                                        (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                                        (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                                        (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                                        (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                                }
                                // Padding
                                if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                                    $titleStyles .= 'padding: ' .
                                        (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                                        (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                                        (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                                        (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                                }
                                // Class name
                                $classNames = 'title' 
                                    . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                                    . ' align-' . esc_attr($postTitleAlignment);
                                // Hover JS (conditionally included)
                                $onmouseover = !empty($postTitleHoverBgColor) 
                                    ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                                    : '';
                                $onmouseout = !empty($postTitleBgColor) 
                                    ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                                    : '';
                                // Final output
                                $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                                    . $onmouseover 
                                    . $onmouseout 
                                    . '>';

                                $style = '';
                                $hoverStyle = '';
                                $mouseoutStyle = '';

                                // Build inline styles conditionally
                                if (!empty($postTitleFontSize)) {
                                    $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                }
                                if (!empty($postTitleLineHeight)) {
                                    $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                }
                                if (!empty($postTitleLetterSpacing)) {
                                    $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                }
                                if (!empty($postTitleFontWeight)) {
                                    $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                }
                                if (!empty($postTitleColor)) {
                                    $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                    $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                }
                                // Build hover color style if set
                                if (!empty($postTitleHoverColor)) {
                                    $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                }
                                // Final output
                                $output .= '<a href="' . esc_url($permalink) . '" 
                                    style="' . esc_attr(trim($style)) . '"'
                                    . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                                    . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                    . esc_html($croppedTitle) . '</a>';    
                                $output .= '</' . esc_attr($titleTag) . '>';
                            }

                            // Button Output                
                            if ($showReadMoreButton) {
                                // Button wrapper styles
                                $buttonWrapperStyle = '';

                                // Margin
                                if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                                    $buttonWrapperStyle .= 'margin: ' .
                                        (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                                        (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                                        (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                                        (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                                }

                                // Order
                                if (!empty($buttonOrder)) {
                                    $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                                }

                               
                                $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                                // Button inline styles
                                $buttonInlineStyles = '';

                                if (!empty($buttonTextColor)) {
                                    $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                                }
                                if (!empty($buttonBackgroundColor)) {
                                    $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                                }
                                if (!empty($buttonFontSize)) {
                                    $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                                }
                                if (!empty($buttonFontWeight)) {
                                    $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                                }
                                if (!empty($buttonBorderColor)) {
                                    $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                                }
                                if (!empty($buttonBorderType)) {
                                    $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                                }

                                // Border width
                                
                                if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                                    $buttonInlineStyles .= 'border-width: ' .
                                        (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                                        (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                                        (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                                        (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                                }
                                if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                                    $buttonInlineStyles .= 'border-radius: ' .
                                        (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                                        (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                                        (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                                        (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                                }
                                if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                                    $buttonInlineStyles .= 'padding: ' .
                                        (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                                        (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                                        (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                                        (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                                }

                                // Hover styles
                                $buttonHoverInlineStyles = '';
                                $buttonResetStyles = '';

                                if (!empty($buttonHoverTextColor)) {
                                    $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                                    $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                                }
                                if (!empty($buttonHoverBorderColor)) {
                                    $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                                    $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                                }
                                if (!empty($buttonHoverBackgroundColor)) {
                                    $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                                    $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                                }

                                // Button anchor tag
                                $output .= '<a class="rs-btn read-more ' . esc_attr($buttonStyle8) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                                if (!empty($buttonHoverInlineStyles)) {
                                    $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                                }

                                if (!empty($buttonResetStyles)) {
                                    $output .= ' onmouseout="' . $buttonResetStyles . '"';
                                }

                                $output .= '>';

                                // Icon handling
                                $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                                $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                                $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                                if ($iconPosition === 'left' && $showButtonIcon) {
                                    $output .= $leftIcon . ' ';
                                }

                                $output .= esc_html($readMoreLabel);

                                if ($iconPosition === 'right' && $showButtonIcon) {
                                    $output .= ' ' . $rightIcon;
                                }

                                $output .= '</a></div>';
                            }
                            // End Button

                        $output .= '</div>';

                        // Thumbnail
                        if ($rightThumbnailSize && $showThumbnail) {
                            $output .= '<div class="rs-thumb" style="';

                            // Margin
                            if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                                $output .= 'margin: ' . 
                                    (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                                    (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                                    (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                                    (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                            }

                            // Padding
                            if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                                $output .= 'padding: ' . 
                                    (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                                    (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                                    (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                                    (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                            }

                            $output .= '">';

                            // Anchor with optional border-radius and overflow
                            $output .= '<a href="' . esc_url($permalink) . '" style="';

                                if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                                    $output .= ' border-radius: ' .
                                        (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                                        (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                                        (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                                        (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                                }

                            $output .= '">';
                            $output .= $rightThumbnailSize . '</a>';
                            
                            $output .= '</div>';
                        }
                            
                        $output .= '</div>'; // .fancy-post-item

                    $output .= '</div>'; // Close left column
                    $output .= '<div class="col-lg-6">'; // Open right column
                }

                // Post 3+ – Right side uniform layout
                elseif ($post_count > 2) {
                    
                    $output .= '<div class="rs-blog-layout-27-list-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                        // MARGIN    
                        if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                            $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                        } else { // Default fallback
                            $output .= 'margin: 40px 0px 0px 0px;';
                        }

                        // Padding
                        if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                            $output .= 'padding: ' . 
                                (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                                (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                                (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                                (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                        }

                        // Border Radius
                        if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                            $output .= 'border-radius: ' . 
                                (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                                (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                                (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                                (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                        }

                        // Border Width
                        if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                            $output .= 'border-width: ' . 
                                (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                                (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                                (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                                (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                        }

                        // Border Style & Color
                        if (!empty($itemBorderType)) {
                            $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                        }
                        if (!empty($itemBorderColor)) {
                            $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                        }

                        // Background Color
                        if (!empty($itemBackgroundColor)) {
                            $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                        }

                        // Box Shadow
                        if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                            $output .= 'box-shadow: ' . 
                                (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                                (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                                (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                                (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                                esc_attr($itemBoxShadowColor) . '; ';
                        }

                    $output .= '">';
                        $output .= '<div class="rs-date">';
                        $output .= '<span>' . get_the_date('M') . '</span>'; // Month
                        $output .= '<h3 class="title">' . get_the_date('d') . '</h3>'; // Day
                        $output .= '</div>';
                            
                        // MAIN Content
                        $output .= '<div class="rs-content">';

                            // Meta Data
                            if ($showMetaData) {
                                $output .= '<div class="rs-meta-category" >';        
                                $meta_items = [];
                               
                                if ($showPostCategory) {
                                    $meta = '<style="color:' . esc_attr($metaTextColor) . ';">';
                                    if ($showPostCategoryIcon && $showMetaIcon) {
                                        $meta .= '<i class="ri-folder-line" style="color:' . esc_attr($metaIconColor) . ';font-size:' . esc_attr($metaFontSize) . 'px;"></i> ';
                                    }

                                    // Get category names without links
                                    $categories_list = get_the_category($post_id);
                                    if (!empty($categories_list)) {
                                        $category_names = array();
                                        foreach ($categories_list as $category) {
                                            $category_names[] = esc_html($category->name);
                                        }
                                        $meta .= implode(', ', $category_names); // comma-separated plain text categories
                                    }

                                    
                                    $meta_items[] = $meta;
                                }

                                // Now join meta items with the separator
                                $output .= implode('<span class="meta-separator" style="color:' . esc_attr($metaIconColor) . '; font-size:' . esc_attr($metaFontSize) . 'px;">' . esc_html($metaSeperator) . '</span>', $meta_items);

                                $output .= '</div>'; // Close meta-data-list
                                
                            }
                            // End Meta Data

                            // title
                            if ($showPostTitle) {
                                $titleStyles = '';

                                // Order
                                if (!empty($titleOrder)) {
                                    $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                                }
                                // Background color
                                if (!empty($postTitleBgColor)) {
                                    $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                                }
                                // Margin
                                if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                                    $titleStyles .= 'margin: ' .
                                        (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                                        (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                                        (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                                        (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                                }
                                // Padding
                                if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                                    $titleStyles .= 'padding: ' .
                                        (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                                        (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                                        (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                                        (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                                }
                                // Class name
                                $classNames = 'title' 
                                    . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                                    . ' align-' . esc_attr($postTitleAlignment);
                                // Hover JS (conditionally included)
                                $onmouseover = !empty($postTitleHoverBgColor) 
                                    ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                                    : '';
                                $onmouseout = !empty($postTitleBgColor) 
                                    ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                                    : '';
                                // Final output
                                $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                                    . $onmouseover 
                                    . $onmouseout 
                                    . '>';

                                $style = '';
                                $hoverStyle = '';
                                $mouseoutStyle = '';

                                // Build inline styles conditionally
                                if (!empty($postTitleFontSize)) {
                                    $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                                }
                                if (!empty($postTitleLineHeight)) {
                                    $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                                }
                                if (!empty($postTitleLetterSpacing)) {
                                    $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                                }
                                if (!empty($postTitleFontWeight)) {
                                    $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                                }
                                if (!empty($postTitleColor)) {
                                    $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                                    $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                                }
                                // Build hover color style if set
                                if (!empty($postTitleHoverColor)) {
                                    $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                                }
                                // Final output
                                $output .= '<a href="' . esc_url($permalink) . '" 
                                    style="' . esc_attr(trim($style)) . '"'
                                    . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                                    . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                                    . esc_html($croppedTitle) . '</a>';    
                                $output .= '</' . esc_attr($titleTag) . '>';
                            }

                            $output .= '</div>';
                            
                            // Add any other post content here (title, meta, etc.)
                        $output .= '</div>'; // .fancy-post-item
                        
                }
            }
            
        }
        
        $output .= '</div>'; // End row
        $output .= '</div>'; // End container
        $output .= '</div>'; // End .fancy-post-grid

    wp_reset_postdata();

    return $output;
}

function fancy_post_isotope_render_callback($attributes) {
    // Content Layout
    
    $isotopeLayoutStyle = isset($attributes['isotopeLayoutStyle']) ? $attributes['isotopeLayoutStyle'] : 'style1';
    $gridColumns = isset($attributes['gridColumns']) ? absint($attributes['gridColumns']) : 3;
    //Query Builder
    $selectedCategory = isset($attributes['selectedCategory']) ? sanitize_text_field($attributes['selectedCategory']) : '';
    $selectedTag = isset($attributes['selectedTag']) ? sanitize_text_field($attributes['selectedTag']) : '';

    $orderBy = isset($attributes['orderBy']) ? sanitize_text_field($attributes['orderBy']) : 'title';
    $postLimit = isset($attributes['postLimit']) ? absint($attributes['postLimit']) : 6;
      
    // Links
    $postLinkTarget = isset($attributes['postLinkTarget']) ? sanitize_text_field($attributes['postLinkTarget']) : 'newWindow';
    $thumbnailLink = isset($attributes['thumbnailLink']) ? filter_var($attributes['thumbnailLink'], FILTER_VALIDATE_BOOLEAN) : true;
    $postLinkType = isset($attributes['postLinkType']) ? sanitize_text_field($attributes['postLinkType']) : 'yeslink';

    // Field Selector
    $showPostTitle = isset($attributes['showPostTitle']) ? filter_var($attributes['showPostTitle'], FILTER_VALIDATE_BOOLEAN) : true;
    $showThumbnail = isset($attributes['showThumbnail']) ? filter_var($attributes['showThumbnail'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostExcerpt = isset($attributes['showPostExcerpt']) ? filter_var($attributes['showPostExcerpt'], FILTER_VALIDATE_BOOLEAN) : true;
    $showReadMoreButton = isset($attributes['showReadMoreButton']) ? filter_var($attributes['showReadMoreButton'], FILTER_VALIDATE_BOOLEAN) : true;
    $showMetaData = isset($attributes['showMetaData']) ? filter_var($attributes['showMetaData'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostDate = isset($attributes['showPostDate']) ? filter_var($attributes['showPostDate'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostAuthor = isset($attributes['showPostAuthor']) ? filter_var($attributes['showPostAuthor'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostCategory = isset($attributes['showPostCategory']) ? filter_var($attributes['showPostCategory'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostTags = isset($attributes['showPostTags']) ? filter_var($attributes['showPostTags'], FILTER_VALIDATE_BOOLEAN) : false;
    $showPostCommentsCount = isset($attributes['showPostCommentsCount']) ? filter_var($attributes['showPostCommentsCount'], FILTER_VALIDATE_BOOLEAN) : false;
    $showMetaIcon = isset($attributes['showMetaIcon']) ? filter_var($attributes['showMetaIcon'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostDateIcon = isset($attributes['showPostDateIcon']) ? filter_var($attributes['showPostDateIcon'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostAuthorIcon = isset($attributes['showPostAuthorIcon']) ? filter_var($attributes['showPostAuthorIcon'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostCategoryIcon = isset($attributes['showPostCategoryIcon']) ? filter_var($attributes['showPostCategoryIcon'], FILTER_VALIDATE_BOOLEAN) : true;
    $showPostTagsIcon = isset($attributes['showPostTagsIcon']) ? filter_var($attributes['showPostTagsIcon'], FILTER_VALIDATE_BOOLEAN) : false;
    $showPostCommentsCountIcon = isset($attributes['showPostCommentsCountIcon']) ? filter_var($attributes['showPostCommentsCountIcon'], FILTER_VALIDATE_BOOLEAN) : false;

    // Order values
    $metaOrder = isset($attributes['metaOrder']) ? absint($attributes['metaOrder']) : '';
    $titleOrder = isset($attributes['titleOrder']) ? absint($attributes['titleOrder']) : '';
    $excerptOrder = isset($attributes['excerptOrder']) ? absint($attributes['excerptOrder']) : '';
    $buttonOrder = isset($attributes['buttonOrder']) ? absint($attributes['buttonOrder']) : '';

    // Post title settings
    $titleTag               = isset($attributes['titleTag']) ? sanitize_text_field($attributes['titleTag']) : 'h3';
    $titleHoverUnderLine    = isset($attributes['titleHoverUnderLine']) ? sanitize_text_field($attributes['titleHoverUnderLine']) : 'enable';
    $titleCropBy            = isset($attributes['titleCropBy']) ? sanitize_text_field($attributes['titleCropBy']) : 'word';
    $titleLength            = isset($attributes['titleLength']) ? absint($attributes['titleLength']) : 12;
    
    //THUMB sETTINGS
    $thumbnailSize = isset($attributes['thumbnailSize']) ? sanitize_text_field($attributes['thumbnailSize']) : '';
    $hoverAnimation = isset($attributes['hoverAnimation']) ? sanitize_text_field($attributes['hoverAnimation']) : 'hover-zoom_in';
    // Excerpt Settings
    $excerptType = isset($attributes['excerptType']) ? sanitize_text_field($attributes['excerptType']) : 'word';
    $excerptIndicator = isset($attributes['excerptIndicator']) ? sanitize_text_field($attributes['excerptIndicator']) : '...';
    $excerptLimit = isset($attributes['excerptLimit']) ? absint($attributes['excerptLimit']) : 10;
    // Meta data Settings
    $metaAuthorPrefix = isset($attributes['metaAuthorPrefix']) ? sanitize_text_field($attributes['metaAuthorPrefix']) : __('By', 'fancy-post-grid');
    $metaSeperator = isset($attributes['metaSeperator']) ? sanitize_text_field($attributes['metaSeperator']) : '';
    //Button Settings   
    $showButtonIcon = isset($attributes['showButtonIcon']) ? filter_var($attributes['showPostCommentsCountIcon'], FILTER_VALIDATE_BOOLEAN) : true;
    $iconPosition = isset($attributes['iconPosition']) ? sanitize_text_field($attributes['iconPosition']) : 'right';
    $buttonStyle = isset($attributes['buttonStyle']) ? sanitize_text_field($attributes['buttonStyle']) : '';
    $readMoreLabel = isset($attributes['readMoreLabel']) ? sanitize_text_field($attributes['readMoreLabel']) : __('Read More', 'fancy-post-grid');
    // SECTION Area
    $sectionBgColor    = isset($attributes['sectionBgColor']) ? sanitize_hex_color($attributes['sectionBgColor']) : '';
    $sectionMargin = isset($attributes['sectionMargin']) ? $attributes['sectionMargin'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $sectionPadding = isset($attributes['sectionPadding']) ? $attributes['sectionPadding'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    // ITEM Box
    $itemPadding = isset($attributes['itemPadding']) ? $attributes['itemPadding'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $itemMargin = isset($attributes['itemMargin']) ? $attributes['itemMargin'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $itemBorderRadius = isset($attributes['itemBorderRadius']) ? $attributes['itemBorderRadius'] : ['top' => '5', 'right' => '5', 'bottom' => '5', 'left' => '5'];
    $itemBorderWidth = isset($attributes['itemBorderWidth']) ? $attributes['itemBorderWidth'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $itemBoxAlignment   = isset($attributes['itemBoxAlignment']) ? sanitize_text_field($attributes['itemBoxAlignment']) : 'start';
    $itemBorderType     = isset($attributes['itemBorderType']) ? sanitize_text_field($attributes['itemBorderType']) : '';
    $itemBoxShadow = isset($attributes['itemBoxShadow']) ? $attributes['itemBoxShadow'] : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
    $itemBackgroundColor = isset($attributes['itemBackgroundColor']) ? sanitize_hex_color($attributes['itemBackgroundColor']) : '';
    $itemBorderColor    = isset($attributes['itemBorderColor']) ? sanitize_hex_color($attributes['itemBorderColor']) : '';   
    $itemBoxShadowColor = isset($attributes['itemBoxShadowColor']) ? sanitize_hex_color($attributes['itemBoxShadowColor']) : '';
    $itemGap      = isset($attributes['itemGap']) ? absint($attributes['itemGap']) : 30;

    // Content Box
    $contentitemPaddingNew = isset($attributes['contentitemPaddingNew']) ? $attributes['contentitemPaddingNew'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $contentitemMarginNew = isset($attributes['contentitemMarginNew']) ? $attributes['contentitemMarginNew'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $contentBorderWidth = isset($attributes['contentBorderWidth']) ? $attributes['contentBorderWidth'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $contentNormalBorderType = isset($attributes['contentnormalBorderType']) ? sanitize_text_field($attributes['contentnormalBorderType']) : '';
    $contentBgColor    = isset($attributes['contentBgColor']) ? sanitize_hex_color($attributes['contentBgColor']) : '';   
    $contentBorderColor = isset($attributes['contentBorderColor']) ? sanitize_hex_color($attributes['contentBorderColor']) : '';
    // Thumbnail
    $thumbnailMargin = isset($attributes['thumbnailMargin']) ? $attributes['thumbnailMargin'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $thumbnailPadding = isset($attributes['thumbnailPadding']) ? $attributes['thumbnailPadding'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $thumbnailBorderRadius = isset($attributes['thumbnailBorderRadius']) ? $attributes['thumbnailBorderRadius'] : ['top' => '5', 'right' => '5', 'bottom' => '5', 'left' => '5'];

    // Post Title
    $postTitleFontSize      = isset($attributes['postTitleFontSize']) ? absint($attributes['postTitleFontSize']) : 24;
    $postTitleLineHeight    = isset($attributes['postTitleLineHeight']) ? floatval($attributes['postTitleLineHeight']) : '';
    $postTitleLetterSpacing = isset($attributes['postTitleLetterSpacing']) ? floatval($attributes['postTitleLetterSpacing']) : '';
    $postTitleFontWeight    = isset($attributes['postTitleFontWeight']) ? sanitize_text_field($attributes['postTitleFontWeight']) : '600';
    $postTitleAlignment     = isset($attributes['postTitleAlignment']) ? sanitize_text_field($attributes['postTitleAlignment']) : 'start';
    $postTitleColor         = isset($attributes['postTitleColor']) ? sanitize_hex_color($attributes['postTitleColor']) : '';
    $postTitleBgColor       = isset($attributes['postTitleBgColor']) ? sanitize_hex_color($attributes['postTitleBgColor']) : ''; 
    $postTitleHoverColor    = isset($attributes['postTitleHoverColor']) ? sanitize_hex_color($attributes['postTitleHoverColor']) : '';
    $postTitleHoverBgColor  = isset($attributes['postTitleHoverBgColor']) ? sanitize_hex_color($attributes['postTitleHoverBgColor']) : '';
    $postTitleMargin  = isset($attributes['postTitleMargin']) ? array_map('sanitize_text_field', $attributes['postTitleMargin']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $postTitlePadding = isset($attributes['postTitlePadding']) ? array_map('sanitize_text_field', $attributes['postTitlePadding']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];

    // Excerpt
    $excerptFontSize = isset($attributes['excerptFontSize']) ? absint($attributes['excerptFontSize']) : '';
    $excerptLineHeight = isset($attributes['excerptLineHeight']) ? floatval($attributes['excerptLineHeight']) : '';
    $excerptLetterSpacing = isset($attributes['excerptLetterSpacing']) ? floatval($attributes['excerptLetterSpacing']) : '';
    $excerptFontWeight = isset($attributes['excerptFontWeight']) ? sanitize_text_field($attributes['excerptFontWeight']) : '';
    $excerptAlignment = isset($attributes['excerptAlignment']) ? sanitize_text_field($attributes['excerptAlignment']) : '';
    $excerptMargin = isset($attributes['excerptMargin']) ? array_map('sanitize_text_field', $attributes['excerptMargin']) : ['top' => '10', 'right' => '0', 'bottom' => '10', 'left' => '0'];
    $excerptPadding = isset($attributes['excerptPadding']) ? array_map('sanitize_text_field', $attributes['excerptPadding']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $excerptColor = isset($attributes['excerptColor']) ? sanitize_hex_color($attributes['excerptColor']) : '';
    $excerptBgColor = isset($attributes['excerptBgColor']) ? sanitize_hex_color($attributes['excerptBgColor']) : '';
    $excerptBorderType = isset($attributes['excerptBorderType']) ? sanitize_text_field($attributes['excerptBorderType']) : '';
    $excerptHoverColor = isset($attributes['excerptHoverColor']) ? sanitize_hex_color($attributes['excerptHoverColor']) : '';
    $excerptHoverBgColor = isset($attributes['excerptHoverBgColor']) ? sanitize_hex_color($attributes['excerptHoverBgColor']) : '';
    $excerptHoverBorderColor = isset($attributes['excerptHoverBorderColor']) ? sanitize_hex_color($attributes['excerptHoverBorderColor']) : '';

    // Meta Data Attributes
    $metaAlignment = isset($attributes['metaAlignment']) ? sanitize_text_field($attributes['metaAlignment']) : '';
    $metaMarginNew = isset($attributes['metaMarginNew']) ? $attributes['metaMarginNew'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $metaPadding = isset($attributes['metaPadding']) ? $attributes['metaPadding'] : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $metaTextColor = isset($attributes['metaTextColor']) ? sanitize_hex_color($attributes['metaTextColor']) : '';
    $separatorColor = isset($attributes['separatorColor']) ? sanitize_hex_color($attributes['separatorColor']) : '';
    $metaFontSize = isset($attributes['metaFontSize']) ? absint($attributes['metaFontSize']) : '15';
    $metaIconColor = isset($attributes['metaIconColor']) ? sanitize_hex_color($attributes['metaIconColor']) : '';
    
    // Button Alignment
    $buttonAlignment = isset($attributes['buttonAlignment']) ? sanitize_text_field($attributes['buttonAlignment']) : 'start';
    $buttonMarginNew = isset($attributes['buttonMarginNew']) ? array_map('sanitize_text_field', $attributes['buttonMarginNew']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $buttonPaddingNew = isset($attributes['buttonPaddingNew']) ? array_map('sanitize_text_field', $attributes['buttonPaddingNew']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $buttonFontSize = isset($attributes['buttonFontSize']) ? absint($attributes['buttonFontSize']) : '';
    $buttonBorderWidth = isset($attributes['buttonBorderWidth']) ? array_map('sanitize_text_field', $attributes['buttonBorderWidth']) : ['top' => '0', 'right' => '0', 'bottom' => '0', 'left' => '0'];
    $buttonFontWeight = isset($attributes['buttonFontWeight']) ? sanitize_text_field($attributes['buttonFontWeight']) : '';
    $buttonTextColor = isset($attributes['buttonTextColor']) ? sanitize_hex_color($attributes['buttonTextColor']) : '';
    $buttonBackgroundColor = isset($attributes['buttonBackgroundColor']) ? sanitize_hex_color($attributes['buttonBackgroundColor']) : '';
    $buttonBorderType = isset($attributes['buttonBorderType']) ? sanitize_text_field($attributes['buttonBorderType']) : '';
    $buttonBorderRadius = isset($attributes['buttonBorderRadius']) ? array_map('sanitize_text_field', $attributes['buttonBorderRadius']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
    $buttonHoverTextColor = isset($attributes['buttonHoverTextColor']) ? sanitize_hex_color($attributes['buttonHoverTextColor']) : '';
    $buttonHoverBackgroundColor = isset($attributes['buttonHoverBackgroundColor']) ? sanitize_hex_color($attributes['buttonHoverBackgroundColor']) : ''; 
    $buttonBorderColor = isset($attributes['buttonBorderColor']) ? sanitize_hex_color($attributes['buttonBorderColor']) : '';
    $buttonHoverBorderColor = isset($attributes['buttonHoverBorderColor']) ? sanitize_hex_color($attributes['buttonHoverBorderColor']) : '';

    //filter
    $fancyPostFilterAlignment = isset($attributes['fancyPostFilterAlignment']) ? sanitize_text_field($attributes['fancyPostFilterAlignment']) : '';
    $fancyPostFilterText = isset($attributes['fancyPostFilterText']) ? sanitize_text_field($attributes['fancyPostFilterText']) : 'ALL';


    $filterMargin = isset($attributes['filterMargin']) ? array_map('sanitize_text_field', $attributes['filterMargin']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
    $filterPadding = isset($attributes['filterPadding']) ? array_map('sanitize_text_field', $attributes['filterPadding']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];

    $filterBorderStyle = isset($attributes['filterBorderStyle']) ? sanitize_text_field($attributes['filterBorderStyle']) : 'solid';
    $filterBorderWidth = isset($attributes['filterBorderWidth']) ? array_map('sanitize_text_field', $attributes['filterBorderWidth']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
    $filterBorderRadius = isset($attributes['filterBorderRadius']) ? array_map('sanitize_text_field', $attributes['filterBorderRadius']) : ['top' => '', 'right' => '', 'bottom' => '', 'left' => ''];
    $filterFontSize = isset($attributes['filterFontSize']) ? absint($attributes['filterFontSize']) : '';
    $filterGap = isset($attributes['filterGap']) ? absint($attributes['filterGap']) : '';

    $filterTextColor = isset($attributes['filterTextColor']) ? sanitize_hex_color($attributes['filterTextColor']) : '';
    $filterBackgroundColor = isset($attributes['filterBackgroundColor']) ? sanitize_hex_color($attributes['filterBackgroundColor']) : '';
    $filterBorderColor = isset($attributes['filterBorderColor']) ? sanitize_hex_color($attributes['filterBorderColor']) : '';

    $filterHoverTextColor = isset($attributes['filterHoverTextColor']) ? sanitize_hex_color($attributes['filterHoverTextColor']) : '';
    $filterHoverBackgroundColor = isset($attributes['filterHoverBackgroundColor']) ? sanitize_hex_color($attributes['filterHoverBackgroundColor']) : '';
    $filterHoverBorderColor = isset($attributes['filterHoverBorderColor']) ? sanitize_hex_color($attributes['filterHoverBorderColor']) : '';

    $filterActiveTextColor = isset($attributes['filterActiveTextColor']) ? sanitize_hex_color($attributes['filterActiveTextColor']) : '';
    $filterActiveBackgroundColor = isset($attributes['filterActiveBackgroundColor']) ? sanitize_hex_color($attributes['filterActiveBackgroundColor']) : '';
    $filterActiveBorderColor = isset($attributes['filterActiveBorderColor']) ? sanitize_hex_color($attributes['filterActiveBorderColor']) : '';


    //END ATTRIBUTES
    
    $paged = (get_query_var('paged')) ? get_query_var('paged') : 1;

    $query_args = array(
        'post_type'      => 'post',
        'posts_per_page' => $postLimit, // Adjust as needed
        'paged'          => $paged,
        'orderby'        => $orderBy,
        'order'          => 'DESC', // Ensure ordering
    );

    // Filter by category (use 'cat' for category ID)
    if (!empty($selectedCategory) && is_numeric($selectedCategory)) {
        $query_args['cat'] = intval($selectedCategory); 
    }

    // Filter by tag (use 'tag__in' for tag IDs)
    if (!empty($selectedTag) && is_numeric($selectedTag)) {
        $query_args['tag__in'] = array(intval($selectedTag)); 
    }

    $thumbnailSize1 = ($isotopeLayoutStyle === 'style1' && $thumbnailSize == null)
              ? 'fancy_post_custom_size' : $thumbnailSize; 
    $thumbnailSize2 = ($isotopeLayoutStyle === 'style2' && $thumbnailSize == null)
              ? 'fancy_post_custom_size' : $thumbnailSize; 
    $thumbnailSize3 = ($isotopeLayoutStyle === 'style3' && $thumbnailSize == null)
              ? 'fancy_post_custom_size' : $thumbnailSize; 
    $thumbnailSize4 = ($isotopeLayoutStyle === 'style4' && $thumbnailSize == null)
              ? 'fancy_post_landscape' : $thumbnailSize; 
    $thumbnailSize5 = ($isotopeLayoutStyle === 'style5' && $thumbnailSize == null)
              ? 'fancy_post_square' : $thumbnailSize; 
    $thumbnailSize6 = ($isotopeLayoutStyle === 'style6' && $thumbnailSize == null)
              ? 'fancy_post_landscape' : $thumbnailSize; 
    $thumbnailSize7 = ($isotopeLayoutStyle === 'style7' && $thumbnailSize == null)
              ? 'fancy_post_square' : $thumbnailSize; 
    
    // MetaAlignment
    $metaAlignment1 = ($isotopeLayoutStyle === 'style1' && $metaAlignment == null)
              ? 'start' : $metaAlignment; 
    $metaAlignment2 = ($isotopeLayoutStyle === 'style2' && $metaAlignment == null)
              ? 'start' : $metaAlignment; 
    $metaAlignment3 = ($isotopeLayoutStyle === 'style3' && $metaAlignment == null)
              ? 'start' : $metaAlignment; 
    $metaAlignment4 = ($isotopeLayoutStyle === 'style4' && $metaAlignment == null)
              ? 'center' : $metaAlignment; 
    $metaAlignment5 = ($isotopeLayoutStyle === 'style5' && $metaAlignment == null)
              ? 'start' : $metaAlignment; 
    $metaAlignment6 = ($isotopeLayoutStyle === 'style6' && $metaAlignment == null)
              ? 'start' : $metaAlignment; 
    $metaAlignment7 = ($isotopeLayoutStyle === 'style7' && $metaAlignment == null)
              ? 'start' : $metaAlignment;

    // fancyPostFilterAlignment
    $fancyPostFilterAlignment1 = ($isotopeLayoutStyle === 'style1' && $fancyPostFilterAlignment == null)
              ? 'center' : $fancyPostFilterAlignment; 
    $fancyPostFilterAlignment2 = ($isotopeLayoutStyle === 'style2' && $fancyPostFilterAlignment == null)
              ? 'flex-start' : $fancyPostFilterAlignment; 
    $fancyPostFilterAlignment3 = ($isotopeLayoutStyle === 'style3' && $fancyPostFilterAlignment == null)
              ? 'center' : $fancyPostFilterAlignment; 
    $fancyPostFilterAlignment4 = ($isotopeLayoutStyle === 'style4' && $fancyPostFilterAlignment == null)
              ? 'center' : $fancyPostFilterAlignment; 
    $fancyPostFilterAlignment5 = ($isotopeLayoutStyle === 'style5' && $fancyPostFilterAlignment == null)
              ? 'center' : $fancyPostFilterAlignment; 
    $fancyPostFilterAlignment6 = ($isotopeLayoutStyle === 'style6' && $fancyPostFilterAlignment == null)
              ? 'center' : $fancyPostFilterAlignment; 
    $fancyPostFilterAlignment7 = ($isotopeLayoutStyle === 'style7' && $fancyPostFilterAlignment == null)
              ? 'flex-start' : $fancyPostFilterAlignment; 
     
    // ExcerptAlignment
    $excerptAlignment1 = ($isotopeLayoutStyle === 'style1' && $excerptAlignment == null)
              ? 'start' : $excerptAlignment; 
    $excerptAlignment2 = ($isotopeLayoutStyle === 'style2' && $excerptAlignment == null)
              ? 'start' : $excerptAlignment; 
    $excerptAlignment3 = ($isotopeLayoutStyle === 'style3' && $excerptAlignment == null)
              ? 'start' : $excerptAlignment; 
    $excerptAlignment4 = ($isotopeLayoutStyle === 'style4' && $excerptAlignment == null)
              ? 'center' : $excerptAlignment; 
    $excerptAlignment5 = ($isotopeLayoutStyle === 'style5' && $excerptAlignment == null)
              ? 'start' : $excerptAlignment; 
    $excerptAlignment6 = ($isotopeLayoutStyle === 'style6' && $excerptAlignment == null)
              ? 'start' : $excerptAlignment; 
    $excerptAlignment7 = ($isotopeLayoutStyle === 'style7' && $excerptAlignment == null)
              ? 'start' : $excerptAlignment; 
   
    // buttonStyle
    $buttonStyle1 = ($isotopeLayoutStyle === 'style1' && $buttonStyle == null)
              ? 'fpg-filled' : $buttonStyle; 
    $buttonStyle2 = ($isotopeLayoutStyle === 'style2' && $buttonStyle == null)
              ? 'fpg-filled' : $buttonStyle; 
    $buttonStyle3 = ($isotopeLayoutStyle === 'style3' && $buttonStyle == null)
              ? 'fpg-filled' : $buttonStyle; 
    $buttonStyle5 = ($isotopeLayoutStyle === 'style5' && $buttonStyle == null)
              ? 'fpg-flat' : $buttonStyle; 
    $buttonStyle7 = ($isotopeLayoutStyle === 'style7' && $buttonStyle == null)
              ? 'fpg-filled' : $buttonStyle; 
     
    // Run the query
    $query = new WP_Query($query_args);

    if (!$query->have_posts()) {
        return '<p>' . esc_html__('No posts found.', 'fancy-post-grid') . '</p>';
    }
    if ($isotopeLayoutStyle === 'style1') {
        
        $output = '<div class="rs-blog-layout-4 rs-blog-layout-10" style=" ';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }
        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';
    }
    else if ($isotopeLayoutStyle === 'style2') {
        $output = '<div class="rs-blog-layout-5 rs-blog-layout-10" style=" ';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }
        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';
    }
    else if ($isotopeLayoutStyle === 'style3') {
        $output = '<div class="rs-blog-layout-28 rs-blog-layout-10" style=" ';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }
        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';
    }
    else if ($isotopeLayoutStyle === 'style4') {
        $output = '<div class="rs-blog-layout-30 rs-blog-layout-10" style=" ';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }
        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';
    }
    else if ($isotopeLayoutStyle === 'style5') {
        $output = '<div class="rs-blog-layout-12" style=" ';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }
        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';
    }
    else if ($isotopeLayoutStyle === 'style6') {
        $output = '<div class="rs-blog-layout-15" style=" ';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }
        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';
    } 
    else if ($isotopeLayoutStyle === 'style7') {
        $output = '<div class="rs-blog-layout-26" style=" ';
        
        // Background Color
        if (!empty($sectionBgColor)) {
            $output .= 'background-color: ' . esc_attr($sectionBgColor) . '; ';
        }
        // GAP
        if (!empty($itemGap)) {
            $output .= 'gap: ' . (is_numeric($itemGap) ? $itemGap . 'px' : esc_attr($itemGap)) . '; ';
        }
        // Margin
        if (!empty($sectionMargin['top']) || !empty($sectionMargin['right']) || !empty($sectionMargin['bottom']) || !empty($sectionMargin['left'])) {
            $output .= 'margin: ' . 
                (is_numeric($sectionMargin['top']) ? $sectionMargin['top'] . 'px' : esc_attr($sectionMargin['top'])) . ' ' . 
                (is_numeric($sectionMargin['right']) ? $sectionMargin['right'] . 'px' : esc_attr($sectionMargin['right'])) . ' ' . 
                (is_numeric($sectionMargin['bottom']) ? $sectionMargin['bottom'] . 'px' : esc_attr($sectionMargin['bottom'])) . ' ' . 
                (is_numeric($sectionMargin['left']) ? $sectionMargin['left'] . 'px' : esc_attr($sectionMargin['left'])) . '; ';
        }
        // Padding
        if (!empty($sectionPadding['top']) || !empty($sectionPadding['right']) || !empty($sectionPadding['bottom']) || !empty($sectionPadding['left'])) {
            $output .= 'padding: ' . 
                (is_numeric($sectionPadding['top']) ? $sectionPadding['top'] . 'px' : esc_attr($sectionPadding['top'])) . ' ' . 
                (is_numeric($sectionPadding['right']) ? $sectionPadding['right'] . 'px' : esc_attr($sectionPadding['right'])) . ' ' . 
                (is_numeric($sectionPadding['bottom']) ? $sectionPadding['bottom'] . 'px' : esc_attr($sectionPadding['bottom'])) . ' ' . 
                (is_numeric($sectionPadding['left']) ? $sectionPadding['left'] . 'px' : esc_attr($sectionPadding['left'])) . '; ';
        }

        $output .= '">';
    }        

        if ($isotopeLayoutStyle === 'style1') {

            // Build base filter button style
            $buttonBaseStyle = '';
            if (!empty($filterFontSize)) {
                $buttonBaseStyle .= 'font-size:' . esc_attr($filterFontSize) . 'px;';
            }
            if (!empty($filterTextColor)) {
                $buttonBaseStyle .= 'color:' . esc_attr($filterTextColor) . ';';
            }
            if (!empty($filterBackgroundColor)) {
                $buttonBaseStyle .= 'background-color:' . esc_attr($filterBackgroundColor) . ';';
            }
            if (!empty($filterBorderStyle)) {
                $buttonBaseStyle .= 'border-style:' . esc_attr($filterBorderStyle) . ';';
            }
            if (!empty($filterBorderColor)) {
                $buttonBaseStyle .= 'border-color:' . esc_attr($filterBorderColor) . ';';
            }

            if (!empty($filterMargin['top']) || !empty($filterMargin['right']) || !empty($filterMargin['bottom']) || !empty($filterMargin['left'])) {
                $buttonBaseStyle .= 'margin: ' . 
                    (is_numeric($filterMargin['top']) ? $filterMargin['top'] . 'px' : esc_attr($filterMargin['top'])) . ' ' . 
                    (is_numeric($filterMargin['right']) ? $filterMargin['right'] . 'px' : esc_attr($filterMargin['right'])) . ' ' . 
                    (is_numeric($filterMargin['bottom']) ? $filterMargin['bottom'] . 'px' : esc_attr($filterMargin['bottom'])) . ' ' . 
                    (is_numeric($filterMargin['left']) ? $filterMargin['left'] . 'px' : esc_attr($filterMargin['left'])) . '; ';
            }

            // Padding
            if (!empty($filterPadding['top']) || !empty($filterPadding['right']) || !empty($filterPadding['bottom']) || !empty($filterPadding['left'])) {
                $buttonBaseStyle .= 'padding: ' . 
                    (is_numeric($filterPadding['top']) ? $filterPadding['top'] . 'px' : esc_attr($filterPadding['top'])) . ' ' . 
                    (is_numeric($filterPadding['right']) ? $filterPadding['right'] . 'px' : esc_attr($filterPadding['right'])) . ' ' . 
                    (is_numeric($filterPadding['bottom']) ? $filterPadding['bottom'] . 'px' : esc_attr($filterPadding['bottom'])) . ' ' . 
                    (is_numeric($filterPadding['left']) ? $filterPadding['left'] . 'px' : esc_attr($filterPadding['left'])) . '; ';
            }

            // Border Radius
            if (!empty($filterBorderRadius['top']) || !empty($filterBorderRadius['right']) || !empty($filterBorderRadius['bottom']) || !empty($filterBorderRadius['left'])) {
                $buttonBaseStyle .= 'border-radius: ' . 
                    (is_numeric($filterBorderRadius['top']) ? $filterBorderRadius['top'] . 'px' : esc_attr($filterBorderRadius['top'])) . ' ' . 
                    (is_numeric($filterBorderRadius['right']) ? $filterBorderRadius['right'] . 'px' : esc_attr($filterBorderRadius['right'])) . ' ' . 
                    (is_numeric($filterBorderRadius['bottom']) ? $filterBorderRadius['bottom'] . 'px' : esc_attr($filterBorderRadius['bottom'])) . ' ' . 
                    (is_numeric($filterBorderRadius['left']) ? $filterBorderRadius['left'] . 'px' : esc_attr($filterBorderRadius['left'])) . '; ';
            }

            // Border Width
            if (!empty($filterBorderWidth['top']) || !empty($filterBorderWidth['right']) || !empty($filterBorderWidth['bottom']) || !empty($filterBorderWidth['left'])) {
                $buttonBaseStyle .= 'border-width: ' . 
                    (is_numeric($filterBorderWidth['top']) ? $filterBorderWidth['top'] . 'px' : esc_attr($filterBorderWidth['top'])) . ' ' . 
                    (is_numeric($filterBorderWidth['right']) ? $filterBorderWidth['right'] . 'px' : esc_attr($filterBorderWidth['right'])) . ' ' . 
                    (is_numeric($filterBorderWidth['bottom']) ? $filterBorderWidth['bottom'] . 'px' : esc_attr($filterBorderWidth['bottom'])) . ' ' . 
                    (is_numeric($filterBorderWidth['left']) ? $filterBorderWidth['left'] . 'px' : esc_attr($filterBorderWidth['left'])) . '; ';
            }

            // Active button style
            $unique_id = 'filter-' . uniqid();
            $output .= '<style>';
            $output .= '#' . $unique_id . ' .filter-button-group button.active {';
            if (!empty($filterActiveTextColor)) {
                $output .= 'color:' . esc_attr($filterActiveTextColor) . ';';
            }
            if (!empty($filterActiveBackgroundColor)) {
                $output .= 'background-color:' . esc_attr($filterActiveBackgroundColor) . ';';
            }
            if (!empty($filterActiveBorderColor)) {
                $output .= 'border-color:' . esc_attr($filterActiveBorderColor) . ';';
            }
            $output .= '}';
            $output .= '</style>';

            // Hover styles
            $hoverStyleOn = '';
            $hoverStyleOff = '';

            if (!empty($filterHoverTextColor)) {
                $hoverStyleOn .= "this.style.color='" . esc_attr($filterHoverTextColor) . "';";
            }
            if (!empty($filterHoverBackgroundColor)) {
                $hoverStyleOn .= "this.style.backgroundColor='" . esc_attr($filterHoverBackgroundColor) . "';";
            }
            if (!empty($filterHoverBorderColor)) {
                $hoverStyleOn .= "this.style.borderColor='" . esc_attr($filterHoverBorderColor) . "';";
            }

            if (!empty($filterTextColor)) {
                $hoverStyleOff .= "this.style.color='" . esc_attr($filterTextColor) . "';";
            }
            if (!empty($filterBackgroundColor)) {
                $hoverStyleOff .= "this.style.backgroundColor='" . esc_attr($filterBackgroundColor) . "';";
            }
            if (!empty($filterBorderColor)) {
                $hoverStyleOff .= "this.style.borderColor='" . esc_attr($filterBorderColor) . "';";
            }

            // Output filter buttons
            $output .= '<div class="row" id="' . esc_attr($unique_id) . '">';
            $output .= '<div class="col-lg-12">';
            $output .= '<div class="rs-blog-layout-1-filter" style="justify-content:' . esc_attr($fancyPostFilterAlignment1) . ';">';
            $output .= '<div class="filter-button-group" style="gap:' . esc_attr($filterGap) . 'px;">';

            // "All" button
            $output .= '<button class="active" data-filter="*" style="' . esc_attr($buttonBaseStyle) . '" onmouseover="' . esc_attr($hoverStyleOn) . '" onmouseout="' . esc_attr($hoverStyleOff) . '">' . esc_html($fancyPostFilterText) . '</button>';

            // Category buttons
            $categories = get_categories(['hide_empty' => true]);
            foreach ($categories as $category) {
                $output .= '<button data-filter=".' . esc_attr($category->slug) . '" style="' . esc_attr($buttonBaseStyle) . '" onmouseover="' . esc_attr($hoverStyleOn) . '" onmouseout="' . esc_attr($hoverStyleOff) . '">' . esc_html($category->name) . '</button>';
            }

            $output .= '</div>'; // .filter-button-group
            $output .= '</div>'; // .rs-blog-layout-2-filter
            $output .= '</div>'; // .col-lg-12
            $output .= '</div>'; // .row
        }else if ($isotopeLayoutStyle === 'style2') {

            // Build base filter button style
            $buttonBaseStyle = '';
            if (!empty($filterFontSize)) {
                $buttonBaseStyle .= 'font-size:' . esc_attr($filterFontSize) . 'px;';
            }
            if (!empty($filterTextColor)) {
                $buttonBaseStyle .= 'color:' . esc_attr($filterTextColor) . ';';
            }
            if (!empty($filterBackgroundColor)) {
                $buttonBaseStyle .= 'background-color:' . esc_attr($filterBackgroundColor) . ';';
            }
            if (!empty($filterBorderStyle)) {
                $buttonBaseStyle .= 'border-style:' . esc_attr($filterBorderStyle) . ';';
            }
            if (!empty($filterBorderColor)) {
                $buttonBaseStyle .= 'border-color:' . esc_attr($filterBorderColor) . ';';
            }

            if (!empty($filterMargin['top']) || !empty($filterMargin['right']) || !empty($filterMargin['bottom']) || !empty($filterMargin['left'])) {
                $buttonBaseStyle .= 'margin: ' . 
                    (is_numeric($filterMargin['top']) ? $filterMargin['top'] . 'px' : esc_attr($filterMargin['top'])) . ' ' . 
                    (is_numeric($filterMargin['right']) ? $filterMargin['right'] . 'px' : esc_attr($filterMargin['right'])) . ' ' . 
                    (is_numeric($filterMargin['bottom']) ? $filterMargin['bottom'] . 'px' : esc_attr($filterMargin['bottom'])) . ' ' . 
                    (is_numeric($filterMargin['left']) ? $filterMargin['left'] . 'px' : esc_attr($filterMargin['left'])) . '; ';
            }

            // Padding
            if (!empty($filterPadding['top']) || !empty($filterPadding['right']) || !empty($filterPadding['bottom']) || !empty($filterPadding['left'])) {
                $buttonBaseStyle .= 'padding: ' . 
                    (is_numeric($filterPadding['top']) ? $filterPadding['top'] . 'px' : esc_attr($filterPadding['top'])) . ' ' . 
                    (is_numeric($filterPadding['right']) ? $filterPadding['right'] . 'px' : esc_attr($filterPadding['right'])) . ' ' . 
                    (is_numeric($filterPadding['bottom']) ? $filterPadding['bottom'] . 'px' : esc_attr($filterPadding['bottom'])) . ' ' . 
                    (is_numeric($filterPadding['left']) ? $filterPadding['left'] . 'px' : esc_attr($filterPadding['left'])) . '; ';
            }

            // Border Radius
            if (!empty($filterBorderRadius['top']) || !empty($filterBorderRadius['right']) || !empty($filterBorderRadius['bottom']) || !empty($filterBorderRadius['left'])) {
                $buttonBaseStyle .= 'border-radius: ' . 
                    (is_numeric($filterBorderRadius['top']) ? $filterBorderRadius['top'] . 'px' : esc_attr($filterBorderRadius['top'])) . ' ' . 
                    (is_numeric($filterBorderRadius['right']) ? $filterBorderRadius['right'] . 'px' : esc_attr($filterBorderRadius['right'])) . ' ' . 
                    (is_numeric($filterBorderRadius['bottom']) ? $filterBorderRadius['bottom'] . 'px' : esc_attr($filterBorderRadius['bottom'])) . ' ' . 
                    (is_numeric($filterBorderRadius['left']) ? $filterBorderRadius['left'] . 'px' : esc_attr($filterBorderRadius['left'])) . '; ';
            }

            // Border Width
            if (!empty($filterBorderWidth['top']) || !empty($filterBorderWidth['right']) || !empty($filterBorderWidth['bottom']) || !empty($filterBorderWidth['left'])) {
                $buttonBaseStyle .= 'border-width: ' . 
                    (is_numeric($filterBorderWidth['top']) ? $filterBorderWidth['top'] . 'px' : esc_attr($filterBorderWidth['top'])) . ' ' . 
                    (is_numeric($filterBorderWidth['right']) ? $filterBorderWidth['right'] . 'px' : esc_attr($filterBorderWidth['right'])) . ' ' . 
                    (is_numeric($filterBorderWidth['bottom']) ? $filterBorderWidth['bottom'] . 'px' : esc_attr($filterBorderWidth['bottom'])) . ' ' . 
                    (is_numeric($filterBorderWidth['left']) ? $filterBorderWidth['left'] . 'px' : esc_attr($filterBorderWidth['left'])) . '; ';
            }

            // Active button style
            $unique_id = 'filter-' . uniqid();
            $output .= '<style>';
            $output .= '#' . $unique_id . ' .filter-button-group button.active {';
            if (!empty($filterActiveTextColor)) {
                $output .= 'color:' . esc_attr($filterActiveTextColor) . ';';
            }
            if (!empty($filterActiveBackgroundColor)) {
                $output .= 'background-color:' . esc_attr($filterActiveBackgroundColor) . ';';
            }
            if (!empty($filterActiveBorderColor)) {
                $output .= 'border-color:' . esc_attr($filterActiveBorderColor) . ';';
            }
            $output .= '}';
            $output .= '</style>';

            // Hover styles
            $hoverStyleOn = '';
            $hoverStyleOff = '';

            if (!empty($filterHoverTextColor)) {
                $hoverStyleOn .= "this.style.color='" . esc_attr($filterHoverTextColor) . "';";
            }
            if (!empty($filterHoverBackgroundColor)) {
                $hoverStyleOn .= "this.style.backgroundColor='" . esc_attr($filterHoverBackgroundColor) . "';";
            }
            if (!empty($filterHoverBorderColor)) {
                $hoverStyleOn .= "this.style.borderColor='" . esc_attr($filterHoverBorderColor) . "';";
            }

            if (!empty($filterTextColor)) {
                $hoverStyleOff .= "this.style.color='" . esc_attr($filterTextColor) . "';";
            }
            if (!empty($filterBackgroundColor)) {
                $hoverStyleOff .= "this.style.backgroundColor='" . esc_attr($filterBackgroundColor) . "';";
            }
            if (!empty($filterBorderColor)) {
                $hoverStyleOff .= "this.style.borderColor='" . esc_attr($filterBorderColor) . "';";
            }

            // Output filter buttons
            $output .= '<div class="row" id="' . esc_attr($unique_id) . '">';
            $output .= '<div class="col-lg-12">';
            $output .= '<div class="rs-blog-layout-2-filter" style="justify-content:' . esc_attr($fancyPostFilterAlignment2) . ';">';
            $output .= '<div class="filter-button-group" style="gap:' . esc_attr($filterGap) . 'px;">';

            // "All" button
            $output .= '<button class="active" data-filter="*" style="' . esc_attr($buttonBaseStyle) . '" onmouseover="' . esc_attr($hoverStyleOn) . '" onmouseout="' . esc_attr($hoverStyleOff) . '">' . esc_html($fancyPostFilterText) . '</button>';

            // Category buttons
            $categories = get_categories(['hide_empty' => true]);
            foreach ($categories as $category) {
                $output .= '<button data-filter=".' . esc_attr($category->slug) . '" style="' . esc_attr($buttonBaseStyle) . '" onmouseover="' . esc_attr($hoverStyleOn) . '" onmouseout="' . esc_attr($hoverStyleOff) . '">' . esc_html($category->name) . '</button>';
            }

            $output .= '</div>'; // .filter-button-group
            $output .= '</div>'; // .rs-blog-layout-2-filter
            $output .= '</div>'; // .col-lg-12
            $output .= '</div>'; // .row
        }else if ($isotopeLayoutStyle === 'style3') {

            // Build base filter button style
            $buttonBaseStyle = '';
            if (!empty($filterFontSize)) {
                $buttonBaseStyle .= 'font-size:' . esc_attr($filterFontSize) . 'px;';
            }
            if (!empty($filterTextColor)) {
                $buttonBaseStyle .= 'color:' . esc_attr($filterTextColor) . ';';
            }
            if (!empty($filterBackgroundColor)) {
                $buttonBaseStyle .= 'background-color:' . esc_attr($filterBackgroundColor) . ';';
            }
            if (!empty($filterBorderStyle)) {
                $buttonBaseStyle .= 'border-style:' . esc_attr($filterBorderStyle) . ';';
            }
            if (!empty($filterBorderColor)) {
                $buttonBaseStyle .= 'border-color:' . esc_attr($filterBorderColor) . ';';
            }

            if (!empty($filterMargin['top']) || !empty($filterMargin['right']) || !empty($filterMargin['bottom']) || !empty($filterMargin['left'])) {
                $buttonBaseStyle .= 'margin: ' . 
                    (is_numeric($filterMargin['top']) ? $filterMargin['top'] . 'px' : esc_attr($filterMargin['top'])) . ' ' . 
                    (is_numeric($filterMargin['right']) ? $filterMargin['right'] . 'px' : esc_attr($filterMargin['right'])) . ' ' . 
                    (is_numeric($filterMargin['bottom']) ? $filterMargin['bottom'] . 'px' : esc_attr($filterMargin['bottom'])) . ' ' . 
                    (is_numeric($filterMargin['left']) ? $filterMargin['left'] . 'px' : esc_attr($filterMargin['left'])) . '; ';
            }

            // Padding
            if (!empty($filterPadding['top']) || !empty($filterPadding['right']) || !empty($filterPadding['bottom']) || !empty($filterPadding['left'])) {
                $buttonBaseStyle .= 'padding: ' . 
                    (is_numeric($filterPadding['top']) ? $filterPadding['top'] . 'px' : esc_attr($filterPadding['top'])) . ' ' . 
                    (is_numeric($filterPadding['right']) ? $filterPadding['right'] . 'px' : esc_attr($filterPadding['right'])) . ' ' . 
                    (is_numeric($filterPadding['bottom']) ? $filterPadding['bottom'] . 'px' : esc_attr($filterPadding['bottom'])) . ' ' . 
                    (is_numeric($filterPadding['left']) ? $filterPadding['left'] . 'px' : esc_attr($filterPadding['left'])) . '; ';
            }

            // Border Radius
            if (!empty($filterBorderRadius['top']) || !empty($filterBorderRadius['right']) || !empty($filterBorderRadius['bottom']) || !empty($filterBorderRadius['left'])) {
                $buttonBaseStyle .= 'border-radius: ' . 
                    (is_numeric($filterBorderRadius['top']) ? $filterBorderRadius['top'] . 'px' : esc_attr($filterBorderRadius['top'])) . ' ' . 
                    (is_numeric($filterBorderRadius['right']) ? $filterBorderRadius['right'] . 'px' : esc_attr($filterBorderRadius['right'])) . ' ' . 
                    (is_numeric($filterBorderRadius['bottom']) ? $filterBorderRadius['bottom'] . 'px' : esc_attr($filterBorderRadius['bottom'])) . ' ' . 
                    (is_numeric($filterBorderRadius['left']) ? $filterBorderRadius['left'] . 'px' : esc_attr($filterBorderRadius['left'])) . '; ';
            }

            // Border Width
            if (!empty($filterBorderWidth['top']) || !empty($filterBorderWidth['right']) || !empty($filterBorderWidth['bottom']) || !empty($filterBorderWidth['left'])) {
                $buttonBaseStyle .= 'border-width: ' . 
                    (is_numeric($filterBorderWidth['top']) ? $filterBorderWidth['top'] . 'px' : esc_attr($filterBorderWidth['top'])) . ' ' . 
                    (is_numeric($filterBorderWidth['right']) ? $filterBorderWidth['right'] . 'px' : esc_attr($filterBorderWidth['right'])) . ' ' . 
                    (is_numeric($filterBorderWidth['bottom']) ? $filterBorderWidth['bottom'] . 'px' : esc_attr($filterBorderWidth['bottom'])) . ' ' . 
                    (is_numeric($filterBorderWidth['left']) ? $filterBorderWidth['left'] . 'px' : esc_attr($filterBorderWidth['left'])) . '; ';
            }

            // Active button style
            $unique_id = 'filter-' . uniqid();
            $output .= '<style>';
            $output .= '#' . $unique_id . ' .filter-button-group button.active {';
            if (!empty($filterActiveTextColor)) {
                $output .= 'color:' . esc_attr($filterActiveTextColor) . ';';
            }
            if (!empty($filterActiveBackgroundColor)) {
                $output .= 'background-color:' . esc_attr($filterActiveBackgroundColor) . ';';
            }
            if (!empty($filterActiveBorderColor)) {
                $output .= 'border-color:' . esc_attr($filterActiveBorderColor) . ';';
            }
            $output .= '}';
            $output .= '</style>';

            // Hover styles
            $hoverStyleOn = '';
            $hoverStyleOff = '';

            if (!empty($filterHoverTextColor)) {
                $hoverStyleOn .= "this.style.color='" . esc_attr($filterHoverTextColor) . "';";
            }
            if (!empty($filterHoverBackgroundColor)) {
                $hoverStyleOn .= "this.style.backgroundColor='" . esc_attr($filterHoverBackgroundColor) . "';";
            }
            if (!empty($filterHoverBorderColor)) {
                $hoverStyleOn .= "this.style.borderColor='" . esc_attr($filterHoverBorderColor) . "';";
            }

            if (!empty($filterTextColor)) {
                $hoverStyleOff .= "this.style.color='" . esc_attr($filterTextColor) . "';";
            }
            if (!empty($filterBackgroundColor)) {
                $hoverStyleOff .= "this.style.backgroundColor='" . esc_attr($filterBackgroundColor) . "';";
            }
            if (!empty($filterBorderColor)) {
                $hoverStyleOff .= "this.style.borderColor='" . esc_attr($filterBorderColor) . "';";
            }

            // Output filter buttons
            $output .= '<div class="row" id="' . esc_attr($unique_id) . '">';
            $output .= '<div class="col-lg-12">';
            $output .= '<div class="rs-blog-layout-3-filter" style="justify-content:' . esc_attr($fancyPostFilterAlignment3) . ';">';
            $output .= '<div class="filter-button-group" style="gap:' . esc_attr($filterGap) . 'px;">';

            // "All" button
            $output .= '<button class="active" data-filter="*" style="' . esc_attr($buttonBaseStyle) . '" onmouseover="' . esc_attr($hoverStyleOn) . '" onmouseout="' . esc_attr($hoverStyleOff) . '">' . esc_html($fancyPostFilterText) . '</button>';

            // Category buttons
            $categories = get_categories(['hide_empty' => true]);
            foreach ($categories as $category) {
                $output .= '<button data-filter=".' . esc_attr($category->slug) . '" style="' . esc_attr($buttonBaseStyle) . '" onmouseover="' . esc_attr($hoverStyleOn) . '" onmouseout="' . esc_attr($hoverStyleOff) . '">' . esc_html($category->name) . '</button>';
            }

            $output .= '</div>'; // .filter-button-group
            $output .= '</div>'; // .rs-blog-layout-2-filter
            $output .= '</div>'; // .col-lg-12
            $output .= '</div>'; // .row
        }else if ($isotopeLayoutStyle === 'style4') {

            // Build base filter button style
            $buttonBaseStyle = '';
            if (!empty($filterFontSize)) {
                $buttonBaseStyle .= 'font-size:' . esc_attr($filterFontSize) . 'px;';
            }
            if (!empty($filterTextColor)) {
                $buttonBaseStyle .= 'color:' . esc_attr($filterTextColor) . ';';
            }
            if (!empty($filterBackgroundColor)) {
                $buttonBaseStyle .= 'background-color:' . esc_attr($filterBackgroundColor) . ';';
            }
            if (!empty($filterBorderStyle)) {
                $buttonBaseStyle .= 'border-style:' . esc_attr($filterBorderStyle) . ';';
            }
            if (!empty($filterBorderColor)) {
                $buttonBaseStyle .= 'border-color:' . esc_attr($filterBorderColor) . ';';
            }

            if (!empty($filterMargin['top']) || !empty($filterMargin['right']) || !empty($filterMargin['bottom']) || !empty($filterMargin['left'])) {
                $buttonBaseStyle .= 'margin: ' . 
                    (is_numeric($filterMargin['top']) ? $filterMargin['top'] . 'px' : esc_attr($filterMargin['top'])) . ' ' . 
                    (is_numeric($filterMargin['right']) ? $filterMargin['right'] . 'px' : esc_attr($filterMargin['right'])) . ' ' . 
                    (is_numeric($filterMargin['bottom']) ? $filterMargin['bottom'] . 'px' : esc_attr($filterMargin['bottom'])) . ' ' . 
                    (is_numeric($filterMargin['left']) ? $filterMargin['left'] . 'px' : esc_attr($filterMargin['left'])) . '; ';
            }

            // Padding
            if (!empty($filterPadding['top']) || !empty($filterPadding['right']) || !empty($filterPadding['bottom']) || !empty($filterPadding['left'])) {
                $buttonBaseStyle .= 'padding: ' . 
                    (is_numeric($filterPadding['top']) ? $filterPadding['top'] . 'px' : esc_attr($filterPadding['top'])) . ' ' . 
                    (is_numeric($filterPadding['right']) ? $filterPadding['right'] . 'px' : esc_attr($filterPadding['right'])) . ' ' . 
                    (is_numeric($filterPadding['bottom']) ? $filterPadding['bottom'] . 'px' : esc_attr($filterPadding['bottom'])) . ' ' . 
                    (is_numeric($filterPadding['left']) ? $filterPadding['left'] . 'px' : esc_attr($filterPadding['left'])) . '; ';
            }

            // Border Radius
            if (!empty($filterBorderRadius['top']) || !empty($filterBorderRadius['right']) || !empty($filterBorderRadius['bottom']) || !empty($filterBorderRadius['left'])) {
                $buttonBaseStyle .= 'border-radius: ' . 
                    (is_numeric($filterBorderRadius['top']) ? $filterBorderRadius['top'] . 'px' : esc_attr($filterBorderRadius['top'])) . ' ' . 
                    (is_numeric($filterBorderRadius['right']) ? $filterBorderRadius['right'] . 'px' : esc_attr($filterBorderRadius['right'])) . ' ' . 
                    (is_numeric($filterBorderRadius['bottom']) ? $filterBorderRadius['bottom'] . 'px' : esc_attr($filterBorderRadius['bottom'])) . ' ' . 
                    (is_numeric($filterBorderRadius['left']) ? $filterBorderRadius['left'] . 'px' : esc_attr($filterBorderRadius['left'])) . '; ';
            }

            // Border Width
            if (!empty($filterBorderWidth['top']) || !empty($filterBorderWidth['right']) || !empty($filterBorderWidth['bottom']) || !empty($filterBorderWidth['left'])) {
                $buttonBaseStyle .= 'border-width: ' . 
                    (is_numeric($filterBorderWidth['top']) ? $filterBorderWidth['top'] . 'px' : esc_attr($filterBorderWidth['top'])) . ' ' . 
                    (is_numeric($filterBorderWidth['right']) ? $filterBorderWidth['right'] . 'px' : esc_attr($filterBorderWidth['right'])) . ' ' . 
                    (is_numeric($filterBorderWidth['bottom']) ? $filterBorderWidth['bottom'] . 'px' : esc_attr($filterBorderWidth['bottom'])) . ' ' . 
                    (is_numeric($filterBorderWidth['left']) ? $filterBorderWidth['left'] . 'px' : esc_attr($filterBorderWidth['left'])) . '; ';
            }

            // Active button style
            $unique_id = 'filter-' . uniqid();
            $output .= '<style>';
            $output .= '#' . $unique_id . ' .filter-button-group button.active {';
            if (!empty($filterActiveTextColor)) {
                $output .= 'color:' . esc_attr($filterActiveTextColor) . ';';
            }
            if (!empty($filterActiveBackgroundColor)) {
                $output .= 'background-color:' . esc_attr($filterActiveBackgroundColor) . ';';
            }
            if (!empty($filterActiveBorderColor)) {
                $output .= 'border-color:' . esc_attr($filterActiveBorderColor) . ';';
            }
            $output .= '}';
            $output .= '</style>';

            // Hover styles
            $hoverStyleOn = '';
            $hoverStyleOff = '';

            if (!empty($filterHoverTextColor)) {
                $hoverStyleOn .= "this.style.color='" . esc_attr($filterHoverTextColor) . "';";
            }
            if (!empty($filterHoverBackgroundColor)) {
                $hoverStyleOn .= "this.style.backgroundColor='" . esc_attr($filterHoverBackgroundColor) . "';";
            }
            if (!empty($filterHoverBorderColor)) {
                $hoverStyleOn .= "this.style.borderColor='" . esc_attr($filterHoverBorderColor) . "';";
            }

            if (!empty($filterTextColor)) {
                $hoverStyleOff .= "this.style.color='" . esc_attr($filterTextColor) . "';";
            }
            if (!empty($filterBackgroundColor)) {
                $hoverStyleOff .= "this.style.backgroundColor='" . esc_attr($filterBackgroundColor) . "';";
            }
            if (!empty($filterBorderColor)) {
                $hoverStyleOff .= "this.style.borderColor='" . esc_attr($filterBorderColor) . "';";
            }

            // Output filter buttons
            $output .= '<div class="row" id="' . esc_attr($unique_id) . '">';
            $output .= '<div class="col-lg-12">';
            $output .= '<div class="rs-blog-layout-4-filter" style="justify-content:' . esc_attr($fancyPostFilterAlignment4) . ';">';
            $output .= '<div class="filter-button-group" style="gap:' . esc_attr($filterGap) . 'px;">';

            // "All" button
            $output .= '<button class="active" data-filter="*" style="' . esc_attr($buttonBaseStyle) . '" onmouseover="' . esc_attr($hoverStyleOn) . '" onmouseout="' . esc_attr($hoverStyleOff) . '">' . esc_html($fancyPostFilterText) . '</button>';

            // Category buttons
            $categories = get_categories(['hide_empty' => true]);
            foreach ($categories as $category) {
                $output .= '<button data-filter=".' . esc_attr($category->slug) . '" style="' . esc_attr($buttonBaseStyle) . '" onmouseover="' . esc_attr($hoverStyleOn) . '" onmouseout="' . esc_attr($hoverStyleOff) . '">' . esc_html($category->name) . '</button>';
            }

            $output .= '</div>'; // .filter-button-group
            $output .= '</div>'; // .rs-blog-layout-2-filter
            $output .= '</div>'; // .col-lg-12
            $output .= '</div>'; // .row
        }else if ($isotopeLayoutStyle === 'style5') {

            // Build base filter button style
            $buttonBaseStyle = '';
            if (!empty($filterFontSize)) {
                $buttonBaseStyle .= 'font-size:' . esc_attr($filterFontSize) . 'px;';
            }
            if (!empty($filterTextColor)) {
                $buttonBaseStyle .= 'color:' . esc_attr($filterTextColor) . ';';
            }
            if (!empty($filterBackgroundColor)) {
                $buttonBaseStyle .= 'background-color:' . esc_attr($filterBackgroundColor) . ';';
            }
            if (!empty($filterBorderStyle)) {
                $buttonBaseStyle .= 'border-style:' . esc_attr($filterBorderStyle) . ';';
            }
            if (!empty($filterBorderColor)) {
                $buttonBaseStyle .= 'border-color:' . esc_attr($filterBorderColor) . ';';
            }

            if (!empty($filterMargin['top']) || !empty($filterMargin['right']) || !empty($filterMargin['bottom']) || !empty($filterMargin['left'])) {
                $buttonBaseStyle .= 'margin: ' . 
                    (is_numeric($filterMargin['top']) ? $filterMargin['top'] . 'px' : esc_attr($filterMargin['top'])) . ' ' . 
                    (is_numeric($filterMargin['right']) ? $filterMargin['right'] . 'px' : esc_attr($filterMargin['right'])) . ' ' . 
                    (is_numeric($filterMargin['bottom']) ? $filterMargin['bottom'] . 'px' : esc_attr($filterMargin['bottom'])) . ' ' . 
                    (is_numeric($filterMargin['left']) ? $filterMargin['left'] . 'px' : esc_attr($filterMargin['left'])) . '; ';
            }

            // Padding
            if (!empty($filterPadding['top']) || !empty($filterPadding['right']) || !empty($filterPadding['bottom']) || !empty($filterPadding['left'])) {
                $buttonBaseStyle .= 'padding: ' . 
                    (is_numeric($filterPadding['top']) ? $filterPadding['top'] . 'px' : esc_attr($filterPadding['top'])) . ' ' . 
                    (is_numeric($filterPadding['right']) ? $filterPadding['right'] . 'px' : esc_attr($filterPadding['right'])) . ' ' . 
                    (is_numeric($filterPadding['bottom']) ? $filterPadding['bottom'] . 'px' : esc_attr($filterPadding['bottom'])) . ' ' . 
                    (is_numeric($filterPadding['left']) ? $filterPadding['left'] . 'px' : esc_attr($filterPadding['left'])) . '; ';
            }

            // Border Radius
            if (!empty($filterBorderRadius['top']) || !empty($filterBorderRadius['right']) || !empty($filterBorderRadius['bottom']) || !empty($filterBorderRadius['left'])) {
                $buttonBaseStyle .= 'border-radius: ' . 
                    (is_numeric($filterBorderRadius['top']) ? $filterBorderRadius['top'] . 'px' : esc_attr($filterBorderRadius['top'])) . ' ' . 
                    (is_numeric($filterBorderRadius['right']) ? $filterBorderRadius['right'] . 'px' : esc_attr($filterBorderRadius['right'])) . ' ' . 
                    (is_numeric($filterBorderRadius['bottom']) ? $filterBorderRadius['bottom'] . 'px' : esc_attr($filterBorderRadius['bottom'])) . ' ' . 
                    (is_numeric($filterBorderRadius['left']) ? $filterBorderRadius['left'] . 'px' : esc_attr($filterBorderRadius['left'])) . '; ';
            }

            // Border Width
            if (!empty($filterBorderWidth['top']) || !empty($filterBorderWidth['right']) || !empty($filterBorderWidth['bottom']) || !empty($filterBorderWidth['left'])) {
                $buttonBaseStyle .= 'border-width: ' . 
                    (is_numeric($filterBorderWidth['top']) ? $filterBorderWidth['top'] . 'px' : esc_attr($filterBorderWidth['top'])) . ' ' . 
                    (is_numeric($filterBorderWidth['right']) ? $filterBorderWidth['right'] . 'px' : esc_attr($filterBorderWidth['right'])) . ' ' . 
                    (is_numeric($filterBorderWidth['bottom']) ? $filterBorderWidth['bottom'] . 'px' : esc_attr($filterBorderWidth['bottom'])) . ' ' . 
                    (is_numeric($filterBorderWidth['left']) ? $filterBorderWidth['left'] . 'px' : esc_attr($filterBorderWidth['left'])) . '; ';
            }

            // Active button style
            $unique_id = 'filter-' . uniqid();
            $output .= '<style>';
            $output .= '#' . $unique_id . ' .filter-button-group button.active {';
            if (!empty($filterActiveTextColor)) {
                $output .= 'color:' . esc_attr($filterActiveTextColor) . ';';
            }
            if (!empty($filterActiveBackgroundColor)) {
                $output .= 'background-color:' . esc_attr($filterActiveBackgroundColor) . ';';
            }
            if (!empty($filterActiveBorderColor)) {
                $output .= 'border-color:' . esc_attr($filterActiveBorderColor) . ';';
            }
            $output .= '}';
            $output .= '</style>';

            // Hover styles
            $hoverStyleOn = '';
            $hoverStyleOff = '';

            if (!empty($filterHoverTextColor)) {
                $hoverStyleOn .= "this.style.color='" . esc_attr($filterHoverTextColor) . "';";
            }
            if (!empty($filterHoverBackgroundColor)) {
                $hoverStyleOn .= "this.style.backgroundColor='" . esc_attr($filterHoverBackgroundColor) . "';";
            }
            if (!empty($filterHoverBorderColor)) {
                $hoverStyleOn .= "this.style.borderColor='" . esc_attr($filterHoverBorderColor) . "';";
            }

            if (!empty($filterTextColor)) {
                $hoverStyleOff .= "this.style.color='" . esc_attr($filterTextColor) . "';";
            }
            if (!empty($filterBackgroundColor)) {
                $hoverStyleOff .= "this.style.backgroundColor='" . esc_attr($filterBackgroundColor) . "';";
            }
            if (!empty($filterBorderColor)) {
                $hoverStyleOff .= "this.style.borderColor='" . esc_attr($filterBorderColor) . "';";
            }

            // Output filter buttons
            $output .= '<div class="row" id="' . esc_attr($unique_id) . '">';
            $output .= '<div class="col-lg-12">';
            $output .= '<div class="rs-blog-layout-5-filter" style="justify-content:' . esc_attr($fancyPostFilterAlignment5) . ';">';
            $output .= '<div class="filter-button-group" style="gap:' . esc_attr($filterGap) . 'px;">';

            // "All" button
            $output .= '<button class="active" data-filter="*" style="' . esc_attr($buttonBaseStyle) . '" onmouseover="' . esc_attr($hoverStyleOn) . '" onmouseout="' . esc_attr($hoverStyleOff) . '">' . esc_html($fancyPostFilterText) . '</button>';

            // Category buttons
            $categories = get_categories(['hide_empty' => true]);
            foreach ($categories as $category) {
                $output .= '<button data-filter=".' . esc_attr($category->slug) . '" style="' . esc_attr($buttonBaseStyle) . '" onmouseover="' . esc_attr($hoverStyleOn) . '" onmouseout="' . esc_attr($hoverStyleOff) . '">' . esc_html($category->name) . '</button>';
            }

            $output .= '</div>'; // .filter-button-group
            $output .= '</div>'; // .rs-blog-layout-2-filter
            $output .= '</div>'; // .col-lg-12
            $output .= '</div>'; // .row
        }else if ($isotopeLayoutStyle === 'style6') {

            // Build base filter button style
            $buttonBaseStyle = '';
            if (!empty($filterFontSize)) {
                $buttonBaseStyle .= 'font-size:' . esc_attr($filterFontSize) . 'px;';
            }
            if (!empty($filterTextColor)) {
                $buttonBaseStyle .= 'color:' . esc_attr($filterTextColor) . ';';
            }
            if (!empty($filterBackgroundColor)) {
                $buttonBaseStyle .= 'background-color:' . esc_attr($filterBackgroundColor) . ';';
            }
            if (!empty($filterBorderStyle)) {
                $buttonBaseStyle .= 'border-style:' . esc_attr($filterBorderStyle) . ';';
            }
            if (!empty($filterBorderColor)) {
                $buttonBaseStyle .= 'border-color:' . esc_attr($filterBorderColor) . ';';
            }

            if (!empty($filterMargin['top']) || !empty($filterMargin['right']) || !empty($filterMargin['bottom']) || !empty($filterMargin['left'])) {
                $buttonBaseStyle .= 'margin: ' . 
                    (is_numeric($filterMargin['top']) ? $filterMargin['top'] . 'px' : esc_attr($filterMargin['top'])) . ' ' . 
                    (is_numeric($filterMargin['right']) ? $filterMargin['right'] . 'px' : esc_attr($filterMargin['right'])) . ' ' . 
                    (is_numeric($filterMargin['bottom']) ? $filterMargin['bottom'] . 'px' : esc_attr($filterMargin['bottom'])) . ' ' . 
                    (is_numeric($filterMargin['left']) ? $filterMargin['left'] . 'px' : esc_attr($filterMargin['left'])) . '; ';
            }

            // Padding
            if (!empty($filterPadding['top']) || !empty($filterPadding['right']) || !empty($filterPadding['bottom']) || !empty($filterPadding['left'])) {
                $buttonBaseStyle .= 'padding: ' . 
                    (is_numeric($filterPadding['top']) ? $filterPadding['top'] . 'px' : esc_attr($filterPadding['top'])) . ' ' . 
                    (is_numeric($filterPadding['right']) ? $filterPadding['right'] . 'px' : esc_attr($filterPadding['right'])) . ' ' . 
                    (is_numeric($filterPadding['bottom']) ? $filterPadding['bottom'] . 'px' : esc_attr($filterPadding['bottom'])) . ' ' . 
                    (is_numeric($filterPadding['left']) ? $filterPadding['left'] . 'px' : esc_attr($filterPadding['left'])) . '; ';
            }

            // Border Radius
            if (!empty($filterBorderRadius['top']) || !empty($filterBorderRadius['right']) || !empty($filterBorderRadius['bottom']) || !empty($filterBorderRadius['left'])) {
                $buttonBaseStyle .= 'border-radius: ' . 
                    (is_numeric($filterBorderRadius['top']) ? $filterBorderRadius['top'] . 'px' : esc_attr($filterBorderRadius['top'])) . ' ' . 
                    (is_numeric($filterBorderRadius['right']) ? $filterBorderRadius['right'] . 'px' : esc_attr($filterBorderRadius['right'])) . ' ' . 
                    (is_numeric($filterBorderRadius['bottom']) ? $filterBorderRadius['bottom'] . 'px' : esc_attr($filterBorderRadius['bottom'])) . ' ' . 
                    (is_numeric($filterBorderRadius['left']) ? $filterBorderRadius['left'] . 'px' : esc_attr($filterBorderRadius['left'])) . '; ';
            }

            // Border Width
            if (!empty($filterBorderWidth['top']) || !empty($filterBorderWidth['right']) || !empty($filterBorderWidth['bottom']) || !empty($filterBorderWidth['left'])) {
                $buttonBaseStyle .= 'border-width: ' . 
                    (is_numeric($filterBorderWidth['top']) ? $filterBorderWidth['top'] . 'px' : esc_attr($filterBorderWidth['top'])) . ' ' . 
                    (is_numeric($filterBorderWidth['right']) ? $filterBorderWidth['right'] . 'px' : esc_attr($filterBorderWidth['right'])) . ' ' . 
                    (is_numeric($filterBorderWidth['bottom']) ? $filterBorderWidth['bottom'] . 'px' : esc_attr($filterBorderWidth['bottom'])) . ' ' . 
                    (is_numeric($filterBorderWidth['left']) ? $filterBorderWidth['left'] . 'px' : esc_attr($filterBorderWidth['left'])) . '; ';
            }

            // Active button style
            $unique_id = 'filter-' . uniqid();
            $output .= '<style>';
            $output .= '#' . $unique_id . ' .filter-button-group button.active {';
            if (!empty($filterActiveTextColor)) {
                $output .= 'color:' . esc_attr($filterActiveTextColor) . ';';
            }
            if (!empty($filterActiveBackgroundColor)) {
                $output .= 'background-color:' . esc_attr($filterActiveBackgroundColor) . ';';
            }
            if (!empty($filterActiveBorderColor)) {
                $output .= 'border-color:' . esc_attr($filterActiveBorderColor) . ';';
            }
            $output .= '}';
            $output .= '</style>';

            // Hover styles
            $hoverStyleOn = '';
            $hoverStyleOff = '';

            if (!empty($filterHoverTextColor)) {
                $hoverStyleOn .= "this.style.color='" . esc_attr($filterHoverTextColor) . "';";
            }
            if (!empty($filterHoverBackgroundColor)) {
                $hoverStyleOn .= "this.style.backgroundColor='" . esc_attr($filterHoverBackgroundColor) . "';";
            }
            if (!empty($filterHoverBorderColor)) {
                $hoverStyleOn .= "this.style.borderColor='" . esc_attr($filterHoverBorderColor) . "';";
            }

            if (!empty($filterTextColor)) {
                $hoverStyleOff .= "this.style.color='" . esc_attr($filterTextColor) . "';";
            }
            if (!empty($filterBackgroundColor)) {
                $hoverStyleOff .= "this.style.backgroundColor='" . esc_attr($filterBackgroundColor) . "';";
            }
            if (!empty($filterBorderColor)) {
                $hoverStyleOff .= "this.style.borderColor='" . esc_attr($filterBorderColor) . "';";
            }

            // Output filter buttons
            $output .= '<div class="row" id="' . esc_attr($unique_id) . '">';
            $output .= '<div class="col-lg-12">';
            $output .= '<div class="rs-blog-layout-6-filter" style="justify-content:' . esc_attr($fancyPostFilterAlignment6) . ';">';
            $output .= '<div class="filter-button-group" style="gap:' . esc_attr($filterGap) . 'px;">';

            // "All" button
            $output .= '<button class="active" data-filter="*" style="' . esc_attr($buttonBaseStyle) . '" onmouseover="' . esc_attr($hoverStyleOn) . '" onmouseout="' . esc_attr($hoverStyleOff) . '">' . esc_html($fancyPostFilterText) . '</button>';

            // Category buttons
            $categories = get_categories(['hide_empty' => true]);
            foreach ($categories as $category) {
                $output .= '<button data-filter=".' . esc_attr($category->slug) . '" style="' . esc_attr($buttonBaseStyle) . '" onmouseover="' . esc_attr($hoverStyleOn) . '" onmouseout="' . esc_attr($hoverStyleOff) . '">' . esc_html($category->name) . '</button>';
            }

            $output .= '</div>'; // .filter-button-group
            $output .= '</div>'; // .rs-blog-layout-2-filter
            $output .= '</div>'; // .col-lg-12
            $output .= '</div>'; // .row
        }else if ($isotopeLayoutStyle === 'style7') {

            // Build base filter button style
            $buttonBaseStyle = '';
            if (!empty($filterFontSize)) {
                $buttonBaseStyle .= 'font-size:' . esc_attr($filterFontSize) . 'px;';
            }
            if (!empty($filterTextColor)) {
                $buttonBaseStyle .= 'color:' . esc_attr($filterTextColor) . ';';
            }
            if (!empty($filterBackgroundColor)) {
                $buttonBaseStyle .= 'background-color:' . esc_attr($filterBackgroundColor) . ';';
            }
            if (!empty($filterBorderStyle)) {
                $buttonBaseStyle .= 'border-style:' . esc_attr($filterBorderStyle) . ';';
            }
            if (!empty($filterBorderColor)) {
                $buttonBaseStyle .= 'border-color:' . esc_attr($filterBorderColor) . ';';
            }

            if (!empty($filterMargin['top']) || !empty($filterMargin['right']) || !empty($filterMargin['bottom']) || !empty($filterMargin['left'])) {
                $buttonBaseStyle .= 'margin: ' . 
                    (is_numeric($filterMargin['top']) ? $filterMargin['top'] . 'px' : esc_attr($filterMargin['top'])) . ' ' . 
                    (is_numeric($filterMargin['right']) ? $filterMargin['right'] . 'px' : esc_attr($filterMargin['right'])) . ' ' . 
                    (is_numeric($filterMargin['bottom']) ? $filterMargin['bottom'] . 'px' : esc_attr($filterMargin['bottom'])) . ' ' . 
                    (is_numeric($filterMargin['left']) ? $filterMargin['left'] . 'px' : esc_attr($filterMargin['left'])) . '; ';
            }

            // Padding
            if (!empty($filterPadding['top']) || !empty($filterPadding['right']) || !empty($filterPadding['bottom']) || !empty($filterPadding['left'])) {
                $buttonBaseStyle .= 'padding: ' . 
                    (is_numeric($filterPadding['top']) ? $filterPadding['top'] . 'px' : esc_attr($filterPadding['top'])) . ' ' . 
                    (is_numeric($filterPadding['right']) ? $filterPadding['right'] . 'px' : esc_attr($filterPadding['right'])) . ' ' . 
                    (is_numeric($filterPadding['bottom']) ? $filterPadding['bottom'] . 'px' : esc_attr($filterPadding['bottom'])) . ' ' . 
                    (is_numeric($filterPadding['left']) ? $filterPadding['left'] . 'px' : esc_attr($filterPadding['left'])) . '; ';
            }

            // Border Radius
            if (!empty($filterBorderRadius['top']) || !empty($filterBorderRadius['right']) || !empty($filterBorderRadius['bottom']) || !empty($filterBorderRadius['left'])) {
                $buttonBaseStyle .= 'border-radius: ' . 
                    (is_numeric($filterBorderRadius['top']) ? $filterBorderRadius['top'] . 'px' : esc_attr($filterBorderRadius['top'])) . ' ' . 
                    (is_numeric($filterBorderRadius['right']) ? $filterBorderRadius['right'] . 'px' : esc_attr($filterBorderRadius['right'])) . ' ' . 
                    (is_numeric($filterBorderRadius['bottom']) ? $filterBorderRadius['bottom'] . 'px' : esc_attr($filterBorderRadius['bottom'])) . ' ' . 
                    (is_numeric($filterBorderRadius['left']) ? $filterBorderRadius['left'] . 'px' : esc_attr($filterBorderRadius['left'])) . '; ';
            }

            // Border Width
            if (!empty($filterBorderWidth['top']) || !empty($filterBorderWidth['right']) || !empty($filterBorderWidth['bottom']) || !empty($filterBorderWidth['left'])) {
                $buttonBaseStyle .= 'border-width: ' . 
                    (is_numeric($filterBorderWidth['top']) ? $filterBorderWidth['top'] . 'px' : esc_attr($filterBorderWidth['top'])) . ' ' . 
                    (is_numeric($filterBorderWidth['right']) ? $filterBorderWidth['right'] . 'px' : esc_attr($filterBorderWidth['right'])) . ' ' . 
                    (is_numeric($filterBorderWidth['bottom']) ? $filterBorderWidth['bottom'] . 'px' : esc_attr($filterBorderWidth['bottom'])) . ' ' . 
                    (is_numeric($filterBorderWidth['left']) ? $filterBorderWidth['left'] . 'px' : esc_attr($filterBorderWidth['left'])) . '; ';
            }

            // Active button style
            $unique_id = 'filter-' . uniqid();
            $output .= '<style>';
            $output .= '#' . $unique_id . ' .filter-button-group button.active {';
            if (!empty($filterActiveTextColor)) {
                $output .= 'color:' . esc_attr($filterActiveTextColor) . ';';
            }
            if (!empty($filterActiveBackgroundColor)) {
                $output .= 'background-color:' . esc_attr($filterActiveBackgroundColor) . ';';
            }
            if (!empty($filterActiveBorderColor)) {
                $output .= 'border-color:' . esc_attr($filterActiveBorderColor) . ';';
            }
            $output .= '}';
            $output .= '</style>';

            // Hover styles
            $hoverStyleOn = '';
            $hoverStyleOff = '';

            if (!empty($filterHoverTextColor)) {
                $hoverStyleOn .= "this.style.color='" . esc_attr($filterHoverTextColor) . "';";
            }
            if (!empty($filterHoverBackgroundColor)) {
                $hoverStyleOn .= "this.style.backgroundColor='" . esc_attr($filterHoverBackgroundColor) . "';";
            }
            if (!empty($filterHoverBorderColor)) {
                $hoverStyleOn .= "this.style.borderColor='" . esc_attr($filterHoverBorderColor) . "';";
            }

            if (!empty($filterTextColor)) {
                $hoverStyleOff .= "this.style.color='" . esc_attr($filterTextColor) . "';";
            }
            if (!empty($filterBackgroundColor)) {
                $hoverStyleOff .= "this.style.backgroundColor='" . esc_attr($filterBackgroundColor) . "';";
            }
            if (!empty($filterBorderColor)) {
                $hoverStyleOff .= "this.style.borderColor='" . esc_attr($filterBorderColor) . "';";
            }

            // Output filter buttons
            $output .= '<div class="row" id="' . esc_attr($unique_id) . '">';
            $output .= '<div class="col-lg-12">';
            $output .= '<div class="rs-blog-layout-7-filter" style="justify-content:' . esc_attr($fancyPostFilterAlignment7) . ';">';
            $output .= '<div class="filter-button-group" style="gap:' . esc_attr($filterGap) . 'px;">';

            // "All" button
            $output .= '<button class="active" data-filter="*" style="' . esc_attr($buttonBaseStyle) . '" onmouseover="' . esc_attr($hoverStyleOn) . '" onmouseout="' . esc_attr($hoverStyleOff) . '">' . esc_html($fancyPostFilterText) . '</button>';

            // Category buttons
            $categories = get_categories(['hide_empty' => true]);
            foreach ($categories as $category) {
                $output .= '<button data-filter=".' . esc_attr($category->slug) . '" style="' . esc_attr($buttonBaseStyle) . '" onmouseover="' . esc_attr($hoverStyleOn) . '" onmouseout="' . esc_attr($hoverStyleOff) . '">' . esc_html($category->name) . '</button>';
            }

            $output .= '</div>'; // .filter-button-group
            $output .= '</div>'; // .rs-blog-layout-2-filter
            $output .= '</div>'; // .col-lg-12
            $output .= '</div>'; // .row
        }
        
        $output .= '<div class="row rs-grid" >';
                        
        while ($query->have_posts()) {
            $query->the_post();
            $post_id = get_the_ID();
            $permalink = get_permalink($post_id);
            $title = get_the_title();
            $getdate = get_the_date('M j, Y', $post_id);
            $date = get_the_date();
            $author = get_the_author();
            $categories = get_the_category_list(', ');
            $tags = get_the_tag_list('', ', ');
            $comments_count = get_comments_number();
            if ($isotopeLayoutStyle === 'style1') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize1, ['class' => 'fancy-post-thumbnail']);}
            if ($isotopeLayoutStyle === 'style2') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize2, ['class' => 'fancy-post-thumbnail']);}
            if ($isotopeLayoutStyle === 'style3') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize3, ['class' => 'fancy-post-thumbnail']);}
            if ($isotopeLayoutStyle === 'style4') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize4, ['class' => 'fancy-post-thumbnail']);}
            if ($isotopeLayoutStyle === 'style5') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize5, ['class' => 'fancy-post-thumbnail']);}
            if ($isotopeLayoutStyle === 'style6') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize6, ['class' => 'fancy-post-thumbnail']);}
            if ($isotopeLayoutStyle === 'style7') {
            $thumbnail = get_the_post_thumbnail($post_id, $thumbnailSize7, ['class' => 'fancy-post-thumbnail']);}

            // Title Crop
            if ($titleCropBy === 'word') {
                $titleArray = explode(' ', $title);
                $croppedTitle = implode(' ', array_slice($titleArray, 0, (int) $titleLength));
            } elseif ($titleCropBy === 'cha') {
                $croppedTitle = mb_substr($title, 0, $titleLength);
            } else {
                $croppedTitle = $title; // fallback
            }
            // Fetch full content when 'full_content' is selected
            if ($excerptType === 'full_content') {
                $excerpt = apply_filters('the_content', get_the_content());
            } elseif ($excerptType === 'word') {
                $excerpt = wp_trim_words(get_the_excerpt(), $excerptLimit, $excerptIndicator);
            } else { // 'character'
                $excerpt = mb_substr(get_the_excerpt(), 0, $excerptLimit) . $excerptIndicator;
            }

            $categories = get_the_category();
            $category_classes = '';

            switch ($gridColumns) {
                case 1:
                    $column_class = 'col-lg-12';
                    break;
                case 2:
                    $column_class = 'col-lg-6';
                    break;
                case 3:
                    $column_class = 'col-lg-4';
                    break;
                case 4:
                    $column_class = 'col-lg-3';
                    break;
                case 5:
                    $column_class = 'col-lg-2';
                    break;
                case 6:
                    $column_class = 'col-lg-2';
                    break;
                default:
                    $column_class = 'col-lg-4'; // Fallback to 3-column
                    break;
            }
            // Add category slugs as class for Isotope filtering
            foreach ($categories as $cat) {
                $category_classes .= ' ' . sanitize_html_class($cat->slug);
            }
                 
            // Style-based output
            if ($isotopeLayoutStyle === 'style1') {
                // Full post layout
                $output .= '<div class="' . esc_attr($column_class) . ' rs-grid-item' . esc_attr($category_classes) . '">';
                $output .= '<div class="rs-blog__item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                    // MARGIN    
                    if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                        $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'margin: 40px 0px 0px 0px;';
                    }

                    // Padding
                    if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                            (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                            (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                            (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                    }

                    // Border Radius
                    if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' . 
                            (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                            (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                            (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                            (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                    }

                    // Border Width
                    if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' . 
                            (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                            (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                            (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                            (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                    }

                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                        $output .= 'box-shadow: ' . 
                            (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                            (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                            (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                            (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                            esc_attr($itemBoxShadowColor) . '; ';
                    }

                $output .= '">';
                // Thumbnail
                if ($thumbnail && $showThumbnail) {
                    $output .= '<div class="rs-thumb" style="';

                    // Margin
                    if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                        $output .= 'margin: ' . 
                            (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                            (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                            (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                            (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                            (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                            (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                            (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                    }

                    $output .= '">';

                    // Anchor with optional border-radius and overflow
                    $output .= '<a href="' . esc_url($permalink) . '" style="';

                        if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                            $output .= ' border-radius: ' .
                                (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                                (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                                (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                                (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                        }

                    $output .= '">';
                    $output .= $thumbnail . '</a></div>';
                }
                // END Thumbnail
                
                // MAIN Content
                $output .= '<div class="rs-content" style="';
                    // Margin
                    if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                        $output .= 'margin: ' .
                            (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                            (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                            (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                            (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                    }
                    // Padding
                    if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                        $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'padding: 20px 30px 22px 30px;';
                    }
                    // Check if at least one side is not empty
                    if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                            (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                            (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                            (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';

                if ($showPostCategory) {
                    $categories_list = get_the_category();

                    if (!empty($categories_list)) {
                        $category_links = array();

                        foreach ($categories_list as $category) {
                            $category_links[] = '<a href="' . esc_url(get_category_link($category->term_id)) . '">' . esc_html($category->name) . '</a>';
                        }

                        $output .= '<div class="rs-category">' . implode(', ', $category_links) . '</div>';
                    }
                }
   
                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }
                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }
                    // Margin
                    if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .
                            (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                            (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                            (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                            (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                    }
                    // Padding
                    if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                            (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                            (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                            (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                    }
                    // Class name
                    $classNames = 'title' 
                        . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                        . ' align-' . esc_attr($postTitleAlignment);
                    // Hover JS (conditionally included)
                    $onmouseover = !empty($postTitleHoverBgColor) 
                        ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                        : '';
                    $onmouseout = !empty($postTitleBgColor) 
                        ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                        : '';
                    // Final output
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                        . $onmouseover 
                        . $onmouseout 
                        . '>';

                    $style = '';
                    $hoverStyle = '';
                    $mouseoutStyle = '';

                    // Build inline styles conditionally
                    if (!empty($postTitleFontSize)) {
                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                    }
                    if (!empty($postTitleLineHeight)) {
                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                    }
                    if (!empty($postTitleLetterSpacing)) {
                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                    }
                    if (!empty($postTitleFontWeight)) {
                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                    }
                    if (!empty($postTitleColor)) {
                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                    }
                    // Build hover color style if set
                    if (!empty($postTitleHoverColor)) {
                        $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                    }
                    // Final output
                    $output .= '<a href="' . esc_url($permalink) . '" 
                        style="' . esc_attr(trim($style)) . '"'
                        . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                        . esc_html($croppedTitle) . '</a>';    
                    $output .= '</' . esc_attr($titleTag) . '>';
                }

                // Excerpt
                if ($showPostExcerpt) {
                    $excerptStyles = '';

                    // Order
                    if (!empty($excerptOrder)) {
                        $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                    }

                    // Typography
                    if (!empty($excerptFontSize)) {
                        $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                    }

                    if (!empty($excerptLineHeight)) {
                        $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                    }

                    if (!empty($excerptLetterSpacing)) {
                        $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                    }

                    if (!empty($excerptFontWeight)) {
                        $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                    }

                    if (!empty($excerptColor)) {
                        $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                    }

                    if (!empty($excerptBgColor)) {
                        $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                    }

                    if (!empty($excerptBorderType)) {
                        $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                    }

                    // Margin
                    if (!empty($excerptMargin['top']) || !empty($excerptMargin['right']) || !empty($excerptMargin['bottom']) || !empty($excerptMargin['left'])) {
                        $excerptStyles .= 'margin: ' .
                            (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) . ' ' .
                            (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) . ' ' .
                            (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) . ' ' .
                            (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($excerptPadding['top']) || !empty($excerptPadding['right']) || !empty($excerptPadding['bottom']) || !empty($excerptPadding['left'])) {
                        $excerptStyles .= 'padding: ' .
                            (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) . ' ' .
                            (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) . ' ' .
                            (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) . ' ' .
                            (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) . '; ';
                    }

                    // Handle hover logic conditionally
                    $hoverIn = '';
                    $hoverOut = '';

                    if (!empty($excerptHoverColor)) {
                        $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                        $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                    }

                    if (!empty($excerptHoverBgColor)) {
                        $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                        $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                    }

                    if (!empty($excerptHoverBorderColor)) {
                        $hoverIn .= 'this.style.borderColor=\'' . esc_attr($excerptHoverBorderColor) . '\';';
                        $hoverOut .= 'this.style.borderColor=\'inherit\';';
                    }

                    $output .= '<div class="fpg-excerpt' . ' align-' . esc_attr($excerptAlignment1) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                    if (!empty($hoverIn) || !empty($hoverOut)) {
                        $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                        $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                    }

                    $output .= '>';
                    $output .= '<p>' . esc_html($excerpt) . '</p>';
                    $output .= '</div>';
                }
                // End Excerpt

                $output .= '<div class="rs-blog-footer" style="';
                    // Margin
                    if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                        $output .= 'margin: ' .
                            (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                            (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                            (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                            (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                    }
                    
                $output .= '">';
                        
                    $output .= '<span>';    
        
                        $meta = '<div class="meta-comment-count" style="color:' . esc_attr($metaTextColor) . ';">';
                            $meta .= '<i class="ri-chat-3-line" style="color:' . esc_attr($metaIconColor) . ';font-size:' . esc_attr($metaFontSize) . 'px;"></i> ';
                        $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</div>';
                        $output .= $meta; 
                        
                    $output .= '</span>';

                    // Button Output                
                    if ($showReadMoreButton) {
                        // Button wrapper styles
                        $buttonWrapperStyle = '';

                        // Margin
                        if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                            $buttonWrapperStyle .= 'margin: ' .
                                (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                                (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                                (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                                (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                        }

                        
                        $output .= '<div class="blog-btn align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                        // Button inline styles
                        $buttonInlineStyles = '';

                        if (!empty($buttonTextColor)) {
                            $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                        }
                        if (!empty($buttonBackgroundColor)) {
                            $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                        }
                        if (!empty($buttonFontSize)) {
                            $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                        }
                        if (!empty($buttonFontWeight)) {
                            $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                        }
                        if (!empty($buttonBorderColor)) {
                            $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                        }
                        if (!empty($buttonBorderType)) {
                            $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                        }

                        // Border width
                        
                        if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                            $buttonInlineStyles .= 'border-width: ' .
                                (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                                (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                                (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                                (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                        }
                        if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                            $buttonInlineStyles .= 'border-radius: ' .
                                (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                                (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                                (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                                (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                        }
                        if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                            $buttonInlineStyles .= 'padding: ' .
                                (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                                (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                                (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                                (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                        }

                        // Hover styles
                        $buttonHoverInlineStyles = '';
                        $buttonResetStyles = '';

                        if (!empty($buttonHoverTextColor)) {
                            $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                            $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                        }
                        if (!empty($buttonHoverBorderColor)) {
                            $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                            $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                        }
                        if (!empty($buttonHoverBackgroundColor)) {
                            $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                            $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                        }

                        // Button anchor tag
                        $output .= '<a class="rs-btn read-more ' . esc_attr($buttonStyle1) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                        if (!empty($buttonHoverInlineStyles)) {
                            $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                        }

                        if (!empty($buttonResetStyles)) {
                            $output .= ' onmouseout="' . $buttonResetStyles . '"';
                        }

                        $output .= '>';

                        // Icon handling
                        $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                        $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                        $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                        if ($iconPosition === 'left' && $showButtonIcon) {
                            $output .= $leftIcon . ' ';
                        }

                        $output .= esc_html($readMoreLabel);

                        if ($iconPosition === 'right' && $showButtonIcon) {
                            $output .= ' ' . $rightIcon;
                        }

                        $output .= '</a></div>';
                    }
                // End Button
                $output .= '</div>';

                $output .= '</div>';
                // End MAIN Content
                $output .= '</div>';
                $output .= '</div>';
                // End Full post layout
            }   
            else if ($isotopeLayoutStyle === 'style2') {
                // Full post layout
                
                $output .= '<div class="' . esc_attr($column_class) . ' rs-grid-item' . esc_attr($category_classes) . '">';

                $output .= '<div class="rs-blog__single align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                    // MARGIN    
                    if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                        $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'margin: 40px 0px 0px 0px;';
                    }

                    // Padding
                    if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                            (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                            (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                            (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                    }

                    // Border Radius
                    if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' . 
                            (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                            (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                            (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                            (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                    }

                    // Border Width
                    if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' . 
                            (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                            (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                            (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                            (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                    }

                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                        $output .= 'box-shadow: ' . 
                            (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                            (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                            (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                            (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                            esc_attr($itemBoxShadowColor) . '; ';
                    }

                $output .= '">';
                // Thumbnail
                if ($thumbnail && $showThumbnail) {
                    $output .= '<div class="rs-thumb" style="';

                    // Margin
                    if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                        $output .= 'margin: ' . 
                            (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                            (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                            (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                            (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                            (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                            (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                            (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                    }

                    $output .= '">';

                    // Anchor with optional border-radius and overflow
                    $output .= '<a href="' . esc_url($permalink) . '" style="';

                        if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                            $output .= ' border-radius: ' .
                                (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                                (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                                (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                                (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                        }

                    $output .= '">';
                    $output .= $thumbnail . '</a></div>';
                }
                // END Thumbnail
                

                // MAIN Content
                $output .= '<div class="rs-content" style="';
                    // Margin
                    if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                        $output .= 'margin: ' .
                            (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                            (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                            (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                            (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                    }
                    // Padding
                    if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                        $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'padding: 20px 0px 0px 0px;';
                    }
                    // Check if at least one side is not empty
                    if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                            (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                            (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                            (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';

                // Meta Data
                if ($showMetaData) {
                    $output .= '<ul class="meta-data-list align-' . $metaAlignment2 . ' " style="';  
                        // Margin
                        if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                            $output .= 'margin: ' .
                                (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                        }
                        // Padding
                        if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                            $output .= 'padding: ' .
                                (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                        }   
                        
                        // Color
                        if (!empty($metaTextColor)) {
                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                        }
                        // Order
                        if (!empty($metaOrder)) {
                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                        }
                    $output .= '">';

                    $meta_items = [];

                    // Date
                    if ($showPostDate) {
                        $meta = '<li class="meta-date" style="';

                        // Color
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        // Font size
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        // Icon
                        if ($showPostDateIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-calendar-alt" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($getdate) . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Author
                    if ($showPostAuthor) {
                        $meta = '<li class="meta-author" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostAuthorIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-user" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Category
                    if ($showPostCategory) {
                        $meta = '<li class="meta-categories" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCategoryIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-folder" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        // Get category names without links
                        $categories_list = get_the_category($post_id);
                        if (!empty($categories_list)) {
                            $category_names = array();
                            foreach ($categories_list as $category) {
                                $category_names[] = esc_html($category->name);
                            }
                            $meta .= implode(', ', $category_names); // comma-separated plain text categories
                        }

                        $meta .= '</li>';
                        $meta_items[] = $meta;
                    }
                    // Tags
                    if ($showPostTags && !empty($tags)) {
                        $meta = '<li class="meta-tags" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostTagsIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-tags" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Comment Count
                    if ($showPostCommentsCount) {
                        $meta = '<li class="meta-comment-count" style="';
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCommentsCountIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-comments" style="';
                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }
                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Now join meta items with the separator
                    if (!empty($meta_items)) {
                        $separator = '';

                        if ($metaSeperator !== '') {
                            $separator = '';
                            if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                $separatorStyle = '';
                                if (!empty($separatorColor)) {
                                    $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                            }
                        }

                        $output .= implode($separator, $meta_items);
                    }
                    $output .= '</ul>'; // Close meta-data-list               
                }
                // End Meta Data

                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }
                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }
                    // Margin
                    if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .
                            (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                            (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                            (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                            (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                    }
                    // Padding
                    if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                            (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                            (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                            (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                    }
                    // Class name
                    $classNames = 'title' 
                        . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                        . ' align-' . esc_attr($postTitleAlignment);
                    // Hover JS (conditionally included)
                    $onmouseover = !empty($postTitleHoverBgColor) 
                        ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                        : '';
                    $onmouseout = !empty($postTitleBgColor) 
                        ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                        : '';
                    // Final output
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                        . $onmouseover 
                        . $onmouseout 
                        . '>';

                    $style = '';
                    $hoverStyle = '';
                    $mouseoutStyle = '';

                    // Build inline styles conditionally
                    if (!empty($postTitleFontSize)) {
                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                    }
                    if (!empty($postTitleLineHeight)) {
                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                    }
                    if (!empty($postTitleLetterSpacing)) {
                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                    }
                    if (!empty($postTitleFontWeight)) {
                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                    }
                    if (!empty($postTitleColor)) {
                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                    }
                    // Build hover color style if set
                    if (!empty($postTitleHoverColor)) {
                        $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                    }
                    // Final output
                    $output .= '<a href="' . esc_url($permalink) . '" 
                        style="' . esc_attr(trim($style)) . '"'
                        . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                        . esc_html($croppedTitle) . '</a>';    
                    $output .= '</' . esc_attr($titleTag) . '>';
                }

                // Excerpt
                if ($showPostExcerpt) {
                    $excerptStyles = '';

                    // Order
                    if (!empty($excerptOrder)) {
                        $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                    }

                    // Typography
                    if (!empty($excerptFontSize)) {
                        $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                    }

                    if (!empty($excerptLineHeight)) {
                        $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                    }

                    if (!empty($excerptLetterSpacing)) {
                        $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                    }

                    if (!empty($excerptFontWeight)) {
                        $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                    }

                    if (!empty($excerptColor)) {
                        $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                    }

                    if (!empty($excerptBgColor)) {
                        $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                    }

                    if (!empty($excerptBorderType)) {
                        $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                    }

                    // Margin
                    if (!empty($excerptMargin['top']) || !empty($excerptMargin['right']) || !empty($excerptMargin['bottom']) || !empty($excerptMargin['left'])) {
                        $excerptStyles .= 'margin: ' .
                            (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) . ' ' .
                            (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) . ' ' .
                            (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) . ' ' .
                            (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($excerptPadding['top']) || !empty($excerptPadding['right']) || !empty($excerptPadding['bottom']) || !empty($excerptPadding['left'])) {
                        $excerptStyles .= 'padding: ' .
                            (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) . ' ' .
                            (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) . ' ' .
                            (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) . ' ' .
                            (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) . '; ';
                    }

                    // Handle hover logic conditionally
                    $hoverIn = '';
                    $hoverOut = '';

                    if (!empty($excerptHoverColor)) {
                        $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                        $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                    }

                    if (!empty($excerptHoverBgColor)) {
                        $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                        $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                    }

                    if (!empty($excerptHoverBorderColor)) {
                        $hoverIn .= 'this.style.borderColor=\'' . esc_attr($excerptHoverBorderColor) . '\';';
                        $hoverOut .= 'this.style.borderColor=\'inherit\';';
                    }

                    $output .= '<div class="fpg-excerpt' . ' align-' . esc_attr($excerptAlignment2) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                    if (!empty($hoverIn) || !empty($hoverOut)) {
                        $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                        $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                    }

                    $output .= '>';
                    $output .= '<p>' . esc_html($excerpt) . '</p>';
                    $output .= '</div>';
                }                
                // End Excerpt

                
                // Button Output                
                if ($showReadMoreButton) {
                    // Button wrapper styles
                    $buttonWrapperStyle = '';

                    // Margin
                    if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                        $buttonWrapperStyle .= 'margin: ' .
                            (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                            (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                            (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                            (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                    }

                    // Order
                    if (!empty($buttonOrder)) {
                        $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                    }

                   
                    $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                    // Button inline styles
                    $buttonInlineStyles = '';

                    if (!empty($buttonTextColor)) {
                        $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                    }
                    if (!empty($buttonBackgroundColor)) {
                        $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                    }
                    if (!empty($buttonFontSize)) {
                        $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                    }
                    if (!empty($buttonFontWeight)) {
                        $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                    }
                    if (!empty($buttonBorderColor)) {
                        $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                    }
                    if (!empty($buttonBorderType)) {
                        $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                    }

                    // Border width
                    
                    if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                        $buttonInlineStyles .= 'border-width: ' .
                            (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                            (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                            (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                            (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                    }
                    if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                        $buttonInlineStyles .= 'border-radius: ' .
                            (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                            (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                            (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                            (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                    }
                    if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                        $buttonInlineStyles .= 'padding: ' .
                            (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                            (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                            (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                            (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                    }

                    // Hover styles
                    $buttonHoverInlineStyles = '';
                    $buttonResetStyles = '';

                    if (!empty($buttonHoverTextColor)) {
                        $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                        $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                    }
                    if (!empty($buttonHoverBorderColor)) {
                        $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                        $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                    }
                    if (!empty($buttonHoverBackgroundColor)) {
                        $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                        $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                    }

                    // Button anchor tag
                    $output .= '<a class="rs-link read-more ' . esc_attr($buttonStyle2) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                    if (!empty($buttonHoverInlineStyles)) {
                        $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                    }

                    if (!empty($buttonResetStyles)) {
                        $output .= ' onmouseout="' . $buttonResetStyles . '"';
                    }

                    $output .= '>';

                    // Icon handling
                    $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                    $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                    $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                    if ($iconPosition === 'left' && $showButtonIcon) {
                        $output .= $leftIcon . ' ';
                    }

                    $output .= esc_html($readMoreLabel);

                    if ($iconPosition === 'right' && $showButtonIcon) {
                        $output .= ' ' . $rightIcon;
                    }

                    $output .= '</a></div>';
                }
                // End Button

                $output .= '</div>';
                // End MAIN Content
                $output .= '</div>';
                $output .= '</div>';
                // End Full post layout
            }
            else if ($isotopeLayoutStyle === 'style3') {
                
                $output .= '<div class="' . esc_attr($column_class) . ' rs-grid-item' . esc_attr($category_classes) . '">'; 
                // Full post layout
                $output .= '<div class="rs-blog-layout-28-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                    // MARGIN    
                    if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                        $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'margin: 40px 0px 0px 0px;';
                    }

                    // Padding
                    if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                            (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                            (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                            (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                    }

                    // Border Radius
                    if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' . 
                            (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                            (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                            (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                            (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                    }

                    // Border Width
                    if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' . 
                            (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                            (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                            (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                            (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                    }

                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                        $output .= 'box-shadow: ' . 
                            (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                            (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                            (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                            (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                            esc_attr($itemBoxShadowColor) . '; ';
                    }

                $output .= '">';

                    // Thumbnail
                    if ($thumbnail && $showThumbnail) {

                        $output .= '<div class="rs-thumb" style="';
                            // Margin
                            if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                                $output .= 'margin: ' . 
                                    (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                                    (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                                    (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                                    (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                            }

                            // Padding
                            if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                                $output .= 'padding: ' . 
                                    (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                                    (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                                    (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                                    (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                            }

                        $output .= '">';
                        

                        // Anchor with optional border-radius and overflow
                        $output .= '<a href="' . esc_url($permalink) . '" style="';

                            if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                                $output .= ' border-radius: ' .
                                    (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                                    (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                                    (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                                    (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                            }

                        $output .= '">';
                        $output .= $thumbnail . '</a>';

                            // Now Insert Meta Data inside the Thumbnail
                            if ($showMetaData) {
                                $output .= '<div class="rs-meta align-' . $metaAlignment3 . '">';
                                    $output .= '<ul class="meta-data-list align-' . $metaAlignment3 . ' " style="';  
                                        // Margin
                                        if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                                            $output .= 'margin: ' .
                                                (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                                (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                                (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                                (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                                        }
                                        // Padding
                                        if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                                            $output .= 'padding: ' .
                                                (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                                (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                                (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                                (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                                        }   
                                        
                                        // Color
                                        if (!empty($metaTextColor)) {
                                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                                        }
                                        // Order
                                        if (!empty($metaOrder)) {
                                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                                        }
                                    $output .= '">';

                                        $meta_items = [];

                                        // Date
                                        if ($showPostDate) {
                                            $meta = '<li class="meta-date" style="';

                                            // Color
                                            if (!empty($metaTextColor)) {
                                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                            }

                                            // Font size
                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '">';

                                            // Icon
                                            if ($showPostDateIcon && $showMetaIcon) {
                                                $meta .= '<i class="fas fa-calendar-alt" style="';

                                                if (!empty($metaIconColor)) {
                                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                                }

                                                if (!empty($metaFontSize)) {
                                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                                }

                                                $meta .= '"></i> ';
                                            }

                                            $meta .= esc_html($getdate) . '</li>';
                                            $meta_items[] = $meta;
                                        }
                                        // Author
                                        if ($showPostAuthor) {
                                            $meta = '<li class="meta-author" style="';

                                            if (!empty($metaTextColor)) {
                                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '">';

                                            if ($showPostAuthorIcon && $showMetaIcon) {
                                                $meta .= '<i class="fas fa-user" style="';

                                                if (!empty($metaIconColor)) {
                                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                                }

                                                if (!empty($metaFontSize)) {
                                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                                }

                                                $meta .= '"></i> ';
                                            }

                                            $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                                            $meta_items[] = $meta;
                                        }
                                        // Category
                                        if ($showPostCategory) {
                                            $meta = '<li class="meta-categories" style="';

                                            if (!empty($metaTextColor)) {
                                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '">';

                                            if ($showPostCategoryIcon && $showMetaIcon) {
                                                $meta .= '<i class="fas fa-folder" style="';

                                                if (!empty($metaIconColor)) {
                                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                                }

                                                if (!empty($metaFontSize)) {
                                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                                }

                                                $meta .= '"></i> ';
                                            }

                                            // Get category names without links
                                            $categories_list = get_the_category($post_id);
                                            if (!empty($categories_list)) {
                                                $category_names = array();
                                                foreach ($categories_list as $category) {
                                                    $category_names[] = esc_html($category->name);
                                                }
                                                $meta .= implode(', ', $category_names); // comma-separated plain text categories
                                            }

                                            $meta .= '</li>';
                                            $meta_items[] = $meta;
                                        }
                                        // Tags
                                        if ($showPostTags && !empty($tags)) {
                                            $meta = '<li class="meta-tags" style="';

                                            if (!empty($metaTextColor)) {
                                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                            }

                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '">';

                                            if ($showPostTagsIcon && $showMetaIcon) {
                                                $meta .= '<i class="fas fa-tags" style="';

                                                if (!empty($metaIconColor)) {
                                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                                }

                                                if (!empty($metaFontSize)) {
                                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                                }

                                                $meta .= '"></i> ';
                                            }

                                            $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                                            $meta_items[] = $meta;
                                        }
                                        // Comment Count
                                        if ($showPostCommentsCount) {
                                            $meta = '<li class="meta-comment-count" style="';
                                            if (!empty($metaTextColor)) {
                                                $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                                            }
                                            if (!empty($metaFontSize)) {
                                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                            }

                                            $meta .= '">';

                                            if ($showPostCommentsCountIcon && $showMetaIcon) {
                                                $meta .= '<i class="fas fa-comments" style="';
                                                if (!empty($metaIconColor)) {
                                                    $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                                                }
                                                if (!empty($metaFontSize)) {
                                                    $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                                }
                                                $meta .= '"></i> ';
                                            }

                                            $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                                            $meta_items[] = $meta;
                                        }
                                        // Now join meta items with the separator
                                        if (!empty($meta_items)) {
                                            $separator = '';

                                            if ($metaSeperator !== '') {
                                                $separator = '';
                                                if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                                    $separatorStyle = '';
                                                    if (!empty($separatorColor)) {
                                                        $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                                    }
                                                    if (!empty($metaFontSize)) {
                                                        $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                                    }

                                                    $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                                                }
                                            }

                                            $output .= implode($separator, $meta_items);
                                        }
                                    $output .= '</ul>'; // ul Close 
                                $output .= '</div>'; // Close meta-data-list
                            }

                        $output .= '</div>'; // Close fancy-post-image rs-thumb
                    }

                // MAIN Content
                $output .= '<div class="rs-content" style="';
                    // Margin
                    if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                        $output .= 'margin: ' .
                            (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                            (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                            (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                            (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                    }
                    // Padding
                    if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                        $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'padding: 20px 30px 30px 30px;';
                    }
                    // Check if at least one side is not empty
                    if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                            (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                            (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                            (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';

                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }
                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }
                    // Margin
                    if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .
                            (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                            (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                            (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                            (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                    }
                    // Padding
                    if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                            (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                            (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                            (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                    }
                    // Class name
                    $classNames = 'title' 
                        . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                        . ' align-' . esc_attr($postTitleAlignment);
                    // Hover JS (conditionally included)
                    $onmouseover = !empty($postTitleHoverBgColor) 
                        ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                        : '';
                    $onmouseout = !empty($postTitleBgColor) 
                        ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                        : '';
                    // Final output
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                        . $onmouseover 
                        . $onmouseout 
                        . '>';

                    $style = '';
                    $hoverStyle = '';
                    $mouseoutStyle = '';

                    // Build inline styles conditionally
                    if (!empty($postTitleFontSize)) {
                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                    }
                    if (!empty($postTitleLineHeight)) {
                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                    }
                    if (!empty($postTitleLetterSpacing)) {
                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                    }
                    if (!empty($postTitleFontWeight)) {
                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                    }
                    if (!empty($postTitleColor)) {
                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                    }
                    // Build hover color style if set
                    if (!empty($postTitleHoverColor)) {
                        $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                    }
                    // Final output
                    $output .= '<a href="' . esc_url($permalink) . '" 
                        style="' . esc_attr(trim($style)) . '"'
                        . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                        . esc_html($croppedTitle) . '</a>';    
                    $output .= '</' . esc_attr($titleTag) . '>';
                }


                // Excerpt
                if ($showPostExcerpt) {
                    $excerptStyles = '';

                    // Order
                    if (!empty($excerptOrder)) {
                        $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                    }

                    // Typography
                    if (!empty($excerptFontSize)) {
                        $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                    }

                    if (!empty($excerptLineHeight)) {
                        $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                    }

                    if (!empty($excerptLetterSpacing)) {
                        $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                    }

                    if (!empty($excerptFontWeight)) {
                        $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                    }

                    if (!empty($excerptColor)) {
                        $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                    }

                    if (!empty($excerptBgColor)) {
                        $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                    }

                    if (!empty($excerptBorderType)) {
                        $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                    }

                    // Margin
                    if (!empty($excerptMargin['top']) || !empty($excerptMargin['right']) || !empty($excerptMargin['bottom']) || !empty($excerptMargin['left'])) {
                        $excerptStyles .= 'margin: ' .
                            (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) . ' ' .
                            (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) . ' ' .
                            (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) . ' ' .
                            (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($excerptPadding['top']) || !empty($excerptPadding['right']) || !empty($excerptPadding['bottom']) || !empty($excerptPadding['left'])) {
                        $excerptStyles .= 'padding: ' .
                            (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) . ' ' .
                            (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) . ' ' .
                            (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) . ' ' .
                            (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) . '; ';
                    }

                    // Handle hover logic conditionally
                    $hoverIn = '';
                    $hoverOut = '';

                    if (!empty($excerptHoverColor)) {
                        $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                        $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                    }

                    if (!empty($excerptHoverBgColor)) {
                        $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                        $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                    }

                    if (!empty($excerptHoverBorderColor)) {
                        $hoverIn .= 'this.style.borderColor=\'' . esc_attr($excerptHoverBorderColor) . '\';';
                        $hoverOut .= 'this.style.borderColor=\'inherit\';';
                    }

                    $output .= '<div class="fpg-excerpt' . ' align-' . esc_attr($excerptAlignment3) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                    if (!empty($hoverIn) || !empty($hoverOut)) {
                        $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                        $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                    }

                    $output .= '>';
                    $output .= '<p>' . esc_html($excerpt) . '</p>';
                    $output .= '</div>';
                }
                // End Excerpt

                
                // Button Output                
                if ($showReadMoreButton) {
                    // Button wrapper styles
                    $buttonWrapperStyle = '';

                    // Margin
                    if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                        $buttonWrapperStyle .= 'margin: ' .
                            (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                            (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                            (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                            (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                    }

                    // Order
                    if (!empty($buttonOrder)) {
                        $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                    }

                   
                    $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                    // Button inline styles
                    $buttonInlineStyles = '';

                    if (!empty($buttonTextColor)) {
                        $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                    }
                    if (!empty($buttonBackgroundColor)) {
                        $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                    }
                    if (!empty($buttonFontSize)) {
                        $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                    }
                    if (!empty($buttonFontWeight)) {
                        $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                    }
                    if (!empty($buttonBorderColor)) {
                        $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                    }
                    if (!empty($buttonBorderType)) {
                        $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                    }

                    // Border width
                    
                    if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                        $buttonInlineStyles .= 'border-width: ' .
                            (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                            (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                            (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                            (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                    }
                    if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                        $buttonInlineStyles .= 'border-radius: ' .
                            (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                            (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                            (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                            (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                    }
                    if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                        $buttonInlineStyles .= 'padding: ' .
                            (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                            (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                            (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                            (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                    }

                    // Hover styles
                    $buttonHoverInlineStyles = '';
                    $buttonResetStyles = '';

                    if (!empty($buttonHoverTextColor)) {
                        $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                        $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                    }
                    if (!empty($buttonHoverBorderColor)) {
                        $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                        $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                    }
                    if (!empty($buttonHoverBackgroundColor)) {
                        $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                        $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                    }

                    // Button anchor tag
                    $output .= '<a class="rs-btn read-more ' . esc_attr($buttonStyle3) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                    if (!empty($buttonHoverInlineStyles)) {
                        $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                    }

                    if (!empty($buttonResetStyles)) {
                        $output .= ' onmouseout="' . $buttonResetStyles . '"';
                    }

                    $output .= '>';

                    // Icon handling
                    $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                    $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                    $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                    if ($iconPosition === 'left' && $showButtonIcon) {
                        $output .= $leftIcon . ' ';
                    }

                    $output .= esc_html($readMoreLabel);

                    if ($iconPosition === 'right' && $showButtonIcon) {
                        $output .= ' ' . $rightIcon;
                    }

                    $output .= '</a></div>';
                }
                // End Button

                $output .= '</div>';
                // End MAIN Content
                $output .= '</div>';
                $output .= '</div>';
                
                // End Full post layout    
            }
            else if ($isotopeLayoutStyle === 'style4') {
                // Full post layout
                $output .= '<div class="' . esc_attr($column_class) . ' rs-grid-item' . esc_attr($category_classes) . '">'; 
                $output .= '<div class="rs-blog-layout-30-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                    // MARGIN    
                    if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                        $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'margin: 40px 0px 0px 0px;';
                    }

                    if ( !empty($itemPadding['top']) || !empty($itemPadding['right']) ||  !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                        $output .= 'margin: ' .(isset($itemPadding['top']) && $itemPadding['top'] !== '' ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' . (isset($itemPadding['right']) && $itemPadding['right'] !== '' ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' . (isset($itemPadding['bottom']) && $itemPadding['bottom'] !== '' ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' . (isset($itemPadding['left']) && $itemPadding['left'] !== '' ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'padding: 20px 20px 15px 20px;';
                    }
                    // Padding
                    if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                            (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                            (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                            (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                    }

                    // Border Radius
                    if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' . 
                            (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                            (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                            (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                            (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                    }

                    // Border Width
                    if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' . 
                            (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                            (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                            (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                            (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                    }

                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                        $output .= 'box-shadow: ' . 
                            (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                            (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                            (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                            (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                            esc_attr($itemBoxShadowColor) . '; ';
                    }

                $output .= '">';

                // Thumbnail
                if ($thumbnail && $showThumbnail) {
                    $output .= '<div class="rs-thumb" style="';

                        // Margin
                        if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                            $output .= 'margin: ' . 
                                (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                                (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                                (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                                (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                        }

                        // Padding
                        if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                            $output .= 'padding: ' . 
                                (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                                (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                                (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                                (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                        }

                        $output .= '">';

                        // Anchor with optional border-radius and overflow
                        $output .= '<a href="' . esc_url($permalink) . '" style="';

                            if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                                $output .= ' border-radius: ' .
                                    (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                                    (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                                    (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                                    (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                            }

                        $output .= '">';
                        $output .= $thumbnail . '</a>';

                        // Date
                        if ($showPostDate) {
                            // Build dynamic style for the container
                            $style = '';
                            if (!empty($metaTextColor)) {
                                $style .= 'color:' . esc_attr($metaTextColor) . ';';
                            }
                            if (!empty($metaFontSize)) {
                                $style .= 'font-size:' . esc_attr($metaFontSize) . 'px;';
                            }

                            $output .= '<div class="meta-date" style="' . $style . '">';
                            $output .= '<span>';

                            // Build dynamic style for the icon
                            $iconStyle = '';
                            if (!empty($metaIconColor)) {
                                $iconStyle .= 'color:' . esc_attr($metaIconColor) . ';';
                            }
                            if (!empty($metaFontSize)) {
                                $iconStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px;';
                            }

                            if ($showPostDateIcon && $showMetaIcon) {
                                $output .= '<i class="fas fa-calendar-alt" style="' . $iconStyle . '"></i> ';
                            }

                            $output .= esc_html($getdate);
                            $output .= '</span>';
                            $output .= '</div>';
                        }

                        $output .= '</div>'; // Close fancy-post-image rs-thumb
                    }

                // MAIN Content
                $output .= '<div class="rs-content" style="';
                    // Margin
                    if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                        $output .= 'margin: ' .
                            (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                            (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                            (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                            (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                    }
                    // Padding
                    if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                        $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'padding: 20px 0px 20px 0px;';
                    }
                    // Check if at least one side is not empty
                    if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                            (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                            (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                            (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';

                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }
                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }
                    // Margin
                    if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .
                            (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                            (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                            (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                            (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                    }
                    // Padding
                    if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                            (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                            (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                            (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                    }
                    // Class name
                    $classNames = 'title' 
                        . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                        . ' align-' . esc_attr($postTitleAlignment);
                    // Hover JS (conditionally included)
                    $onmouseover = !empty($postTitleHoverBgColor) 
                        ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                        : '';
                    $onmouseout = !empty($postTitleBgColor) 
                        ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                        : '';
                    // Final output
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                        . $onmouseover 
                        . $onmouseout 
                        . '>';

                    $style = '';
                    $hoverStyle = '';
                    $mouseoutStyle = '';

                    // Build inline styles conditionally
                    if (!empty($postTitleFontSize)) {
                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                    }
                    if (!empty($postTitleLineHeight)) {
                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                    }
                    if (!empty($postTitleLetterSpacing)) {
                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                    }
                    if (!empty($postTitleFontWeight)) {
                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                    }
                    if (!empty($postTitleColor)) {
                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                    }
                    // Build hover color style if set
                    if (!empty($postTitleHoverColor)) {
                        $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                    }
                    // Final output
                    $output .= '<a href="' . esc_url($permalink) . '" 
                        style="' . esc_attr(trim($style)) . '"'
                        . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                        . esc_html($croppedTitle) . '</a>';    
                    $output .= '</' . esc_attr($titleTag) . '>';
                }
                // Now Insert Meta Data inside the Thumbnail
                if ($showMetaData) {
                    $output .= '<div class="rs-meta align-' . $metaAlignment4 . '">';
                    $output .= '<ul class="meta-data-list" style="';  
                        // Margin
                        if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                            $output .= 'margin: ' .
                                (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                        }
                        // Padding
                        if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                            $output .= 'padding: ' .
                                (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                        }   
                        
                        // Color
                        if (!empty($metaTextColor)) {
                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                        }
                        // Order
                        if (!empty($metaOrder)) {
                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                        }
                    $output .= '">';

                    $meta_items = [];

                    // Author
                    if ($showPostAuthor) {
                        $meta = '<li class="meta-author" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostAuthorIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-user" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Category
                    if ($showPostCategory) {
                        $meta = '<li class="meta-categories" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCategoryIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-folder" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        // Get category names without links
                        $categories_list = get_the_category($post_id);
                        if (!empty($categories_list)) {
                            $category_names = array();
                            foreach ($categories_list as $category) {
                                $category_names[] = esc_html($category->name);
                            }
                            $meta .= implode(', ', $category_names); // comma-separated plain text categories
                        }

                        $meta .= '</li>';
                        $meta_items[] = $meta;
                    }
                    // Tags
                    if ($showPostTags && !empty($tags)) {
                        $meta = '<li class="meta-tags" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostTagsIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-tags" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Comment Count
                    if ($showPostCommentsCount) {
                        $meta = '<li class="meta-comment-count" style="';
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCommentsCountIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-comments" style="';
                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }
                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Now join meta items with the separator
                    if (!empty($meta_items)) {
                        $separator = '';

                        if ($metaSeperator !== '') {
                            $separator = '';
                            if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                $separatorStyle = '';
                                if (!empty($separatorColor)) {
                                    $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                            }
                        }

                        $output .= implode($separator, $meta_items);
                    }
                    $output .= '</ul>'; // Close meta-data-list
                    $output .= '</div>'; // Close meta-data-list
                }
                // Excerpt
                if ($showPostExcerpt) {
                    $excerptStyles = '';

                    // Order
                    if (!empty($excerptOrder)) {
                        $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                    }

                    // Typography
                    if (!empty($excerptFontSize)) {
                        $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                    }

                    if (!empty($excerptLineHeight)) {
                        $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                    }

                    if (!empty($excerptLetterSpacing)) {
                        $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                    }

                    if (!empty($excerptFontWeight)) {
                        $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                    }

                    if (!empty($excerptColor)) {
                        $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                    }

                    if (!empty($excerptBgColor)) {
                        $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                    }

                    if (!empty($excerptBorderType)) {
                        $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                    }

                    // Margin
                    if (!empty($excerptMargin['top']) || !empty($excerptMargin['right']) || !empty($excerptMargin['bottom']) || !empty($excerptMargin['left'])) {
                        $excerptStyles .= 'margin: ' .
                            (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) . ' ' .
                            (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) . ' ' .
                            (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) . ' ' .
                            (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($excerptPadding['top']) || !empty($excerptPadding['right']) || !empty($excerptPadding['bottom']) || !empty($excerptPadding['left'])) {
                        $excerptStyles .= 'padding: ' .
                            (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) . ' ' .
                            (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) . ' ' .
                            (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) . ' ' .
                            (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) . '; ';
                    }

                    // Handle hover logic conditionally
                    $hoverIn = '';
                    $hoverOut = '';

                    if (!empty($excerptHoverColor)) {
                        $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                        $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                    }

                    if (!empty($excerptHoverBgColor)) {
                        $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                        $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                    }

                    if (!empty($excerptHoverBorderColor)) {
                        $hoverIn .= 'this.style.borderColor=\'' . esc_attr($excerptHoverBorderColor) . '\';';
                        $hoverOut .= 'this.style.borderColor=\'inherit\';';
                    }

                    $output .= '<div class="fpg-excerpt' . ' align-' . esc_attr($excerptAlignment4) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                    if (!empty($hoverIn) || !empty($hoverOut)) {
                        $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                        $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                    }

                    $output .= '>';
                    $output .= '<p>' . esc_html($excerpt) . '</p>';
                    $output .= '</div>';
                }
                // End Excerpt

                $output .= '</div>';
                // End MAIN Content
                $output .= '</div>';
                $output .= '</div>';
                // End Full post layout
            }
            elseif ($isotopeLayoutStyle === 'style5') {
                // Full post layout
                $output .= '<div class="' . esc_attr($column_class) . ' rs-grid-item' . esc_attr($category_classes) . '">';
                $output .= '<div class="pre-blog-item style_12 pre-blog-meta-style2 default">';
                $output .= '<div class="blog-inner-wrap pre-thum-default pre-meta-blocks top align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                    // MARGIN    
                    if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                        $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'margin: 0px 0px 0px 0px;';
                    }

                    // Padding
                    if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                            (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                            (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                            (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                    }

                    // Border Radius
                    if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' . 
                            (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                            (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                            (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                            (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                    }

                    // Border Width
                    if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' . 
                            (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                            (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                            (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                            (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                    }

                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                        $output .= 'box-shadow: ' . 
                            (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                            (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                            (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                            (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                            esc_attr($itemBoxShadowColor) . '; ';
                    }

                $output .= '">'; 
                    // Thumbnail
                    if ($thumbnail && $showThumbnail) {
                        $output .= '<div class="pre-image-wrap" style="';

                        // Margin
                        if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                            $output .= 'margin: ' . 
                                (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                                (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                                (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                                (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                        }

                        // Padding
                        if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                            $output .= 'padding: ' . 
                                (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                                (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                                (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                                (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                        }

                        $output .= '">';

                        // Anchor with optional border-radius and overflow
                        $output .= '<a href="' . esc_url($permalink) . '" style="';

                            if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                                $output .= ' border-radius: ' .
                                    (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                                    (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                                    (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                                    (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                            }

                        $output .= '">';
                        $output .= $thumbnail . '</a>';
                        if ($showPostDate) {
                            $output .= '<div class="pre-blog-meta" style="color:' . esc_attr($metaTextColor) . '; ">';
                            
                            $output .= '<span class="pre-date">' . esc_html(get_the_date('d')) . '</span>';
                            $output .= '<span class="pre-month"> ' . esc_html(get_the_date('F')) . '</span>'; 
                            $output .= '</div>';
                        }
                        $output .= '</div>';
                    }
                

                // MAIN Content
                $output .= '<div class="pre-blog-content" style="';
                    // Margin
                    if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                        $output .= 'margin: ' .
                            (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                            (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                            (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                            (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                    }
                    // Padding
                    if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                        $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'padding: 75px 20px 25px 20px;';
                    }
                    // Check if at least one side is not empty
                    if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                            (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                            (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                            (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';

                // Meta Data
                if ($showMetaData) {
                    $output .= '<ul class="meta-data-list align-' . $metaAlignment5 . ' " style="';  
                        // Margin
                        if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                            $output .= 'margin: ' .
                                (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                        }
                        // Padding
                        if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                            $output .= 'padding: ' .
                                (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                        }   
                        
                        // Color
                        if (!empty($metaTextColor)) {
                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                        }
                        // Order
                        if (!empty($metaOrder)) {
                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                        }
                    $output .= '">';

                    $meta_items = [];

                    // Author
                    if ($showPostAuthor) {
                        $meta = '<li class="meta-author" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostAuthorIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-user" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Category
                    if ($showPostCategory) {
                        $meta = '<li class="meta-categories" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCategoryIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-folder" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        // Get category names without links
                        $categories_list = get_the_category($post_id);
                        if (!empty($categories_list)) {
                            $category_names = array();
                            foreach ($categories_list as $category) {
                                $category_names[] = esc_html($category->name);
                            }
                            $meta .= implode(', ', $category_names); // comma-separated plain text categories
                        }

                        $meta .= '</li>';
                        $meta_items[] = $meta;
                    }
                    // Tags
                    if ($showPostTags && !empty($tags)) {
                        $meta = '<li class="meta-tags" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostTagsIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-tags" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html__('Tags:', 'fancy-post-grid') . ' ' . $tags . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Comment Count
                    if ($showPostCommentsCount) {
                        $meta = '<li class="meta-comment-count" style="';
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostCommentsCountIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-comments" style="';
                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }
                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }
                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($comments_count) . ' ' . esc_html__('Comments', 'fancy-post-grid') . '</li>';
                        $meta_items[] = $meta;
                    }
                    // Now join meta items with the separator
                    if (!empty($meta_items)) {
                        $separator = '';

                        if ($metaSeperator !== '') {
                            $separator = '';
                            if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                $separatorStyle = '';
                                if (!empty($separatorColor)) {
                                    $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                            }
                        }

                        $output .= implode($separator, $meta_items);
                    }
                    $output .= '</ul>'; // Close meta-data-list               
                }
                // End Meta Data

                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }
                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }
                    // Margin
                    
                    if ( !empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) ||  !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .(isset($postTitleMargin['top']) && $postTitleMargin['top'] !== '' ? (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) : '0px') . ' ' . (isset($postTitleMargin['right']) && $postTitleMargin['right'] !== '' ? (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) : '0px') . ' ' . (isset($postTitleMargin['bottom']) && $postTitleMargin['bottom'] !== '' ? (is_numeric($postTitleMargin['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) : '0px') . ' ' . (isset($postTitleMargin['left']) && $postTitleMargin['left'] !== '' ? (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $titleStyles .= 'margin: 0px 0px 28px 0px;';
                    }
                    // Padding
                    if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                            (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                            (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                            (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                    }
                    // Class name
                    $classNames = 'pre-post-title' 
                        . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                        . ' align-' . esc_attr($postTitleAlignment);
                    // Hover JS (conditionally included)
                    $onmouseover = !empty($postTitleHoverBgColor) 
                        ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                        : '';
                    $onmouseout = !empty($postTitleBgColor) 
                        ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                        : '';
                    // Final output
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                        . $onmouseover 
                        . $onmouseout 
                        . '>';

                    $style = '';
                    $hoverStyle = '';
                    $mouseoutStyle = '';

                    // Build inline styles conditionally
                    if (!empty($postTitleFontSize)) {
                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                    }
                    if (!empty($postTitleLineHeight)) {
                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                    }
                    if (!empty($postTitleLetterSpacing)) {
                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                    }
                    if (!empty($postTitleFontWeight)) {
                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                    }
                    if (!empty($postTitleColor)) {
                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                    }
                    // Build hover color style if set
                    if (!empty($postTitleHoverColor)) {
                        $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                    }
                    // Final output
                    $output .= '<a href="' . esc_url($permalink) . '" 
                        style="' . esc_attr(trim($style)) . '"'
                        . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                        . esc_html($croppedTitle) . '</a>';    
                    $output .= '</' . esc_attr($titleTag) . '>';
                }

                // Excerpt
                if ($showPostExcerpt) {
                    $excerptStyles = '';

                    // Order
                    if (!empty($excerptOrder)) {
                        $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                    }

                    // Typography
                    if (!empty($excerptFontSize)) {
                        $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                    }

                    if (!empty($excerptLineHeight)) {
                        $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                    }

                    if (!empty($excerptLetterSpacing)) {
                        $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                    }

                    if (!empty($excerptFontWeight)) {
                        $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                    }

                    if (!empty($excerptColor)) {
                        $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                    }

                    if (!empty($excerptBgColor)) {
                        $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                    }

                    if (!empty($excerptBorderType)) {
                        $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                    }

                    // Margin
                    if (!empty($excerptMargin['top']) || !empty($excerptMargin['right']) || !empty($excerptMargin['bottom']) || !empty($excerptMargin['left'])) {
                        $excerptStyles .= 'margin: ' .
                            (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) . ' ' .
                            (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) . ' ' .
                            (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) . ' ' .
                            (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($excerptPadding['top']) || !empty($excerptPadding['right']) || !empty($excerptPadding['bottom']) || !empty($excerptPadding['left'])) {
                        $excerptStyles .= 'padding: ' .
                            (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) . ' ' .
                            (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) . ' ' .
                            (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) . ' ' .
                            (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) . '; ';
                    }

                    // Handle hover logic conditionally
                    $hoverIn = '';
                    $hoverOut = '';

                    if (!empty($excerptHoverColor)) {
                        $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                        $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                    }

                    if (!empty($excerptHoverBgColor)) {
                        $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                        $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                    }

                    if (!empty($excerptHoverBorderColor)) {
                        $hoverIn .= 'this.style.borderColor=\'' . esc_attr($excerptHoverBorderColor) . '\';';
                        $hoverOut .= 'this.style.borderColor=\'inherit\';';
                    }

                    $output .= '<div class="pre-content' . ' align-' . esc_attr($excerptAlignment5) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                    if (!empty($hoverIn) || !empty($hoverOut)) {
                        $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                        $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                    }

                    $output .= '>';
                    $output .= '<p>' . esc_html($excerpt) . '</p>';
                    $output .= '</div>';
                }
                // End Excerpt
               
                // Button Output                
                if ($showReadMoreButton) {
                    // Button wrapper styles
                    $buttonWrapperStyle = '';

                    // Margin
                    if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                        $buttonWrapperStyle .= 'margin: ' .
                            (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                            (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                            (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                            (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                    }

                    // Order
                    if (!empty($buttonOrder)) {
                        $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                    }

                   
                    $output .= '<div class="blog-btn-part align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';


                    // Button inline styles
                    $buttonInlineStyles = '';

                    if (!empty($buttonTextColor)) {
                        $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                    }
                    if (!empty($buttonBackgroundColor)) {
                        $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                    }
                    if (!empty($buttonFontSize)) {
                        $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                    }
                    if (!empty($buttonFontWeight)) {
                        $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                    }
                    if (!empty($buttonBorderColor)) {
                        $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                    }
                    if (!empty($buttonBorderType)) {
                        $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                    }

                    // Border width
                    
                    if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                        $buttonInlineStyles .= 'border-width: ' .
                            (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                            (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                            (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                            (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                    }
                    if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                        $buttonInlineStyles .= 'border-radius: ' .
                            (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                            (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                            (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                            (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                    }
                    if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                        $buttonInlineStyles .= 'padding: ' .
                            (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                            (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                            (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                            (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                    }

                    // Hover styles
                    $buttonHoverInlineStyles = '';
                    $buttonResetStyles = '';

                    if (!empty($buttonHoverTextColor)) {
                        $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                        $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                    }
                    if (!empty($buttonHoverBorderColor)) {
                        $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                        $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                    }
                    if (!empty($buttonHoverBackgroundColor)) {
                        $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                        $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                    }

                    // Button anchor tag
                    $output .= '<a class="blog-btn icon-after read-more ' . esc_attr($buttonStyle5) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                    if (!empty($buttonHoverInlineStyles)) {
                        $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                    }

                    if (!empty($buttonResetStyles)) {
                        $output .= ' onmouseout="' . $buttonResetStyles . '"';
                    }

                    $output .= '>';

                    // Icon handling
                    $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                    $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                    $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                    if ($iconPosition === 'left' && $showButtonIcon) {
                        $output .= $leftIcon . ' ';
                    }

                    $output .= esc_html($readMoreLabel);

                    if ($iconPosition === 'right' && $showButtonIcon) {
                        $output .= ' ' . $rightIcon;
                    }

                    $output .= '</a></div>';
                }
                // End Button

                $output .= '</div>';
                // End MAIN Content
                $output .= '</div>';
                $output .= '</div>';
                $output .= '</div>';
                // End Full post layout
            } 
            else if ($isotopeLayoutStyle === 'style6') {
                // Full post layout
                $output .= '<div class="' . esc_attr($column_class) . ' rs-grid-item' . esc_attr($category_classes) . '">';
                $output .= '<div class="rs-blog-layout-15-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                    // MARGIN    
                    if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                        $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'margin: 40px 0px 0px 0px;';
                    }

                    // Padding
                    if (!empty($itemPadding['top']) || !empty($itemPadding['right']) || !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) . ' ' . 
                            (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) . ' ' . 
                            (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) . ' ' . 
                            (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) . '; ';
                    }

                    // Border Radius
                    if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' . 
                            (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                            (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                            (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                            (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                    }

                    // Border Width
                    if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' . 
                            (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                            (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                            (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                            (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                    }

                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                        $output .= 'box-shadow: ' . 
                            (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                            (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                            (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                            (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                            esc_attr($itemBoxShadowColor) . '; ';
                    }

                $output .= '">';

                
                // MAIN Content
                $output .= '<div class="rs-content" style="';
                    // Margin
                    if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                        $output .= 'margin: ' .
                            (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                            (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                            (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                            (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                    }
                    // Padding
                    if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                        $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'padding: 20px 20px 20px 20px;';
                    }
                    // Check if at least one side is not empty
                    if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                            (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                            (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                            (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';   

                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }
                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }
                    // Margin
                    if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .
                            (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                            (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                            (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                            (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                    }
                    // Padding
                    if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                            (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                            (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                            (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                    }
                    // Class name
                    $classNames = 'title' 
                        . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                        . ' align-' . esc_attr($postTitleAlignment);
                    // Hover JS (conditionally included)
                    $onmouseover = !empty($postTitleHoverBgColor) 
                        ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                        : '';
                    $onmouseout = !empty($postTitleBgColor) 
                        ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                        : '';
                    // Final output
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                        . $onmouseover 
                        . $onmouseout 
                        . '>';

                    $style = '';
                    $hoverStyle = '';
                    $mouseoutStyle = '';

                    // Build inline styles conditionally
                    if (!empty($postTitleFontSize)) {
                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                    }
                    if (!empty($postTitleLineHeight)) {
                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                    }
                    if (!empty($postTitleLetterSpacing)) {
                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                    }
                    if (!empty($postTitleFontWeight)) {
                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                    }
                    if (!empty($postTitleColor)) {
                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                    }
                    // Build hover color style if set
                    if (!empty($postTitleHoverColor)) {
                        $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                    }
                    // Final output
                    $output .= '<a href="' . esc_url($permalink) . '" 
                        style="' . esc_attr(trim($style)) . '"'
                        . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                        . esc_html($croppedTitle) . '</a>';    
                    $output .= '</' . esc_attr($titleTag) . '>';
                }
                // Meta Data
                if ($showMetaData) {
                            
                    $output .= '<div class="rs-meta align-' . $metaAlignment6 . ' " style="';  
                        // Margin
                        if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                            $output .= 'margin: ' .
                                (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                        }
                        // Padding
                        if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                            $output .= 'padding: ' .
                                (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                        }   
                        
                        // Color
                        if (!empty($metaTextColor)) {
                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                        }
                        // Order
                        if (!empty($metaOrder)) {
                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                        }
                    $output .= '">';

                    $meta_items = [];

                    // Date
                    if ($showPostDate) {
                        // Format the date as "Oct 14, 2024"
                        $formatted_date = get_the_date('M j, Y', $post_id); // 'M' = short month, 'j' = day (no leading 0), 'Y' = full year

                        $meta = '<span class="meta-date" style="';

                        // Color
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        // Font size
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        // Icon
                        if ($showPostDateIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-calendar-alt" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($formatted_date) . '</span>';
                        $meta_items[] = $meta;
                    }


                    // Author
                    if ($showPostAuthor) {
                        $meta = '<a class="meta-author" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        if ($showPostAuthorIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-user" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        $meta .= esc_html($metaAuthorPrefix) . ' ' . esc_html($author) . '</a>';
                        $meta_items[] = $meta;
                    }

                    // Now join meta items with the separator
                    if (!empty($meta_items)) {
                        $separator = '';

                        if ($metaSeperator !== '') {
                            $separator = '';
                            if (!empty($metaSeperator) && strtolower($metaSeperator) !== 'none') {
                                $separatorStyle = '';
                                if (!empty($separatorColor)) {
                                    $separatorStyle .= 'color:' . esc_attr($separatorColor) . '; ';
                                }
                                if (!empty($metaFontSize)) {
                                    $separatorStyle .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                                }

                                $separator = '<span class="meta-separator" style="' . esc_attr(trim($separatorStyle)) . '">' . esc_html($metaSeperator) . '</span>';
                            }
                        }

                        $output .= implode($separator, $meta_items);
                    }

                    $output .= '</div>'; // Close meta-data-list
                    
                }
                // End Meta Data

                $output .= '</div>';

                // Thumbnail
                if ($thumbnail && $showThumbnail) {
                    $output .= '<div class="rs-thumb" style="';

                    // Margin
                    if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                        $output .= 'margin: ' . 
                            (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                            (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                            (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                            (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                            (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                            (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                            (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                    }

                    $output .= '">';

                    // Anchor with optional border-radius and overflow
                    $output .= '<a href="' . esc_url($permalink) . '" style="';

                        if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                            $output .= ' border-radius: ' .
                                (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                                (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                                (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                                (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                        }

                    $output .= '">';
                    $output .= $thumbnail . '</a>';
                    // Category
                    if ($showPostCategory) {
                        $meta = '<div class="rs-category" style="';

                        // Add color and font-size styles if provided
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        // Add icon if enabled
                        if ($showPostCategoryIcon && $showMetaIcon) {
                            $meta .= '<i class="fas fa-folder" style="';

                            if (!empty($metaIconColor)) {
                                $meta .= 'color:' . esc_attr($metaIconColor) . '; ';
                            }

                            if (!empty($metaFontSize)) {
                                $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                            }

                            $meta .= '"></i> ';
                        }

                        // Get and display category names
                        $categories_list = get_the_category($post_id);
                        if (!empty($categories_list)) {
                            $category_names = array();
                            foreach ($categories_list as $category) {
                                $category_names[] = esc_html($category->name);
                            }
                            $meta .= implode(', ', $category_names); // comma-separated plain text
                        }

                        $meta .= '</div>';
                        $output .= $meta;
                    }

                    $output .= '</div>'; // Close fancy-post-image rs-thumb
                }
                // END Thumbnail

                // End MAIN Content
                $output .= '</div>';
                $output .= '</div>';
                // End Full post layout
            }
            else if ($isotopeLayoutStyle === 'style7') {
                // Full post layout
                $output .= '<div class="' . esc_attr($column_class) . ' rs-grid-item' . esc_attr($category_classes) . '">';
                $output .= '<div class="rs-blog-layout-26-item align-' . $itemBoxAlignment . ' ' . $hoverAnimation . '" style="';
                    // MARGIN    
                    if ( !empty($itemMargin['top']) || !empty($itemMargin['right']) ||  !empty($itemMargin['bottom']) || !empty($itemMargin['left'])) {
                        $output .= 'margin: ' .(isset($itemMargin['top']) && $itemMargin['top'] !== '' ? (is_numeric($itemMargin['top']) ? $itemMargin['top'] . 'px' : esc_attr($itemMargin['top'])) : '0px') . ' ' . (isset($itemMargin['right']) && $itemMargin['right'] !== '' ? (is_numeric($itemMargin['right']) ? $itemMargin['right'] . 'px' : esc_attr($itemMargin['right'])) : '0px') . ' ' . (isset($itemMargin['bottom']) && $itemMargin['bottom'] !== '' ? (is_numeric($itemMargin['bottom']) ? $itemMargin['bottom'] . 'px' : esc_attr($itemMargin['bottom'])) : '0px') . ' ' . (isset($itemMargin['left']) && $itemMargin['left'] !== '' ? (is_numeric($itemMargin['left']) ? $itemMargin['left'] . 'px' : esc_attr($itemMargin['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'margin: 0px 0px 40px 0px;';
                    }

                    if ( !empty($itemPadding['top']) || !empty($itemPadding['right']) ||  !empty($itemPadding['bottom']) || !empty($itemPadding['left'])) {
                        $output .= 'padding: ' .(isset($itemPadding['top']) && $itemPadding['top'] !== '' ? (is_numeric($itemPadding['top']) ? $itemPadding['top'] . 'px' : esc_attr($itemPadding['top'])) : '0px') . ' ' . (isset($itemPadding['right']) && $itemPadding['right'] !== '' ? (is_numeric($itemPadding['right']) ? $itemPadding['right'] . 'px' : esc_attr($itemPadding['right'])) : '0px') . ' ' . (isset($itemPadding['bottom']) && $itemPadding['bottom'] !== '' ? (is_numeric($itemPadding['bottom']) ? $itemPadding['bottom'] . 'px' : esc_attr($itemPadding['bottom'])) : '0px') . ' ' . (isset($itemPadding['left']) && $itemPadding['left'] !== '' ? (is_numeric($itemPadding['left']) ? $itemPadding['left'] . 'px' : esc_attr($itemPadding['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'padding: 0px 0px 40px 0px;';
                    }

                    // Border Radius
                    if (!empty($itemBorderRadius['top']) || !empty($itemBorderRadius['right']) || !empty($itemBorderRadius['bottom']) || !empty($itemBorderRadius['left'])) {
                        $output .= 'border-radius: ' . 
                            (is_numeric($itemBorderRadius['top']) ? $itemBorderRadius['top'] . 'px' : esc_attr($itemBorderRadius['top'])) . ' ' . 
                            (is_numeric($itemBorderRadius['right']) ? $itemBorderRadius['right'] . 'px' : esc_attr($itemBorderRadius['right'])) . ' ' . 
                            (is_numeric($itemBorderRadius['bottom']) ? $itemBorderRadius['bottom'] . 'px' : esc_attr($itemBorderRadius['bottom'])) . ' ' . 
                            (is_numeric($itemBorderRadius['left']) ? $itemBorderRadius['left'] . 'px' : esc_attr($itemBorderRadius['left'])) . '; ';
                    }

                    // Border Width
                    if (!empty($itemBorderWidth['top']) || !empty($itemBorderWidth['right']) || !empty($itemBorderWidth['bottom']) || !empty($itemBorderWidth['left'])) {
                        $output .= 'border-width: ' . 
                            (is_numeric($itemBorderWidth['top']) ? $itemBorderWidth['top'] . 'px' : esc_attr($itemBorderWidth['top'])) . ' ' . 
                            (is_numeric($itemBorderWidth['right']) ? $itemBorderWidth['right'] . 'px' : esc_attr($itemBorderWidth['right'])) . ' ' . 
                            (is_numeric($itemBorderWidth['bottom']) ? $itemBorderWidth['bottom'] . 'px' : esc_attr($itemBorderWidth['bottom'])) . ' ' . 
                            (is_numeric($itemBorderWidth['left']) ? $itemBorderWidth['left'] . 'px' : esc_attr($itemBorderWidth['left'])) . '; ';
                    }

                    // Border Style & Color
                    if (!empty($itemBorderType)) {
                        $output .= 'border-style: ' . esc_attr($itemBorderType) . '; ';
                    }
                    if (!empty($itemBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($itemBorderColor) . '; ';
                    }

                    // Background Color
                    if (!empty($itemBackgroundColor)) {
                        $output .= 'background-color: ' . esc_attr($itemBackgroundColor) . '; ';
                    }

                    // Box Shadow
                    if (!empty($itemBoxShadow['top']) || !empty($itemBoxShadow['right']) || !empty($itemBoxShadow['bottom']) || !empty($itemBoxShadow['left'])) {
                        $output .= 'box-shadow: ' . 
                            (is_numeric($itemBoxShadow['top']) ? $itemBoxShadow['top'] . 'px' : esc_attr($itemBoxShadow['top'])) . ' ' . 
                            (is_numeric($itemBoxShadow['right']) ? $itemBoxShadow['right'] . 'px' : esc_attr($itemBoxShadow['right'])) . ' ' . 
                            (is_numeric($itemBoxShadow['bottom']) ? $itemBoxShadow['bottom'] . 'px' : esc_attr($itemBoxShadow['bottom'])) . ' ' . 
                            (is_numeric($itemBoxShadow['left']) ? $itemBoxShadow['left'] . 'px' : esc_attr($itemBoxShadow['left'])) . ' ' . 
                            esc_attr($itemBoxShadowColor) . '; ';
                    }

                $output .= '">';

                // Thumbnail
                if ($thumbnail && $showThumbnail) {
                    $output .= '<div class="rs-thumb" style="';

                    // Margin
                    if (!empty($thumbnailMargin['top']) || !empty($thumbnailMargin['right']) || !empty($thumbnailMargin['bottom']) || !empty($thumbnailMargin['left'])) {
                        $output .= 'margin: ' . 
                            (is_numeric($thumbnailMargin['top']) ? $thumbnailMargin['top'] . 'px' : esc_attr($thumbnailMargin['top'])) . ' ' . 
                            (is_numeric($thumbnailMargin['right']) ? $thumbnailMargin['right'] . 'px' : esc_attr($thumbnailMargin['right'])) . ' ' . 
                            (is_numeric($thumbnailMargin['bottom']) ? $thumbnailMargin['bottom'] . 'px' : esc_attr($thumbnailMargin['bottom'])) . ' ' . 
                            (is_numeric($thumbnailMargin['left']) ? $thumbnailMargin['left'] . 'px' : esc_attr($thumbnailMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($thumbnailPadding['top']) || !empty($thumbnailPadding['right']) || !empty($thumbnailPadding['bottom']) || !empty($thumbnailPadding['left'])) {
                        $output .= 'padding: ' . 
                            (is_numeric($thumbnailPadding['top']) ? $thumbnailPadding['top'] . 'px' : esc_attr($thumbnailPadding['top'])) . ' ' . 
                            (is_numeric($thumbnailPadding['right']) ? $thumbnailPadding['right'] . 'px' : esc_attr($thumbnailPadding['right'])) . ' ' . 
                            (is_numeric($thumbnailPadding['bottom']) ? $thumbnailPadding['bottom'] . 'px' : esc_attr($thumbnailPadding['bottom'])) . ' ' . 
                            (is_numeric($thumbnailPadding['left']) ? $thumbnailPadding['left'] . 'px' : esc_attr($thumbnailPadding['left'])) . '; ';
                    }

                    $output .= '">';

                    // Anchor with optional border-radius and overflow
                    $output .= '<a href="' . esc_url($permalink) . '" style="';

                        if ( !empty($thumbnailBorderRadius['top']) || !empty($thumbnailBorderRadius['right']) || !empty($thumbnailBorderRadius['bottom']) || !empty($thumbnailBorderRadius['left'])) {
                            $output .= ' border-radius: ' .
                                (is_numeric($thumbnailBorderRadius['top']) ? $thumbnailBorderRadius['top'] . 'px' : esc_attr($thumbnailBorderRadius['top'])) . ' ' .
                                (is_numeric($thumbnailBorderRadius['right']) ? $thumbnailBorderRadius['right'] . 'px' : esc_attr($thumbnailBorderRadius['right'])) . ' ' .
                                (is_numeric($thumbnailBorderRadius['bottom']) ? $thumbnailBorderRadius['bottom'] . 'px' : esc_attr($thumbnailBorderRadius['bottom'])) . ' ' .
                                (is_numeric($thumbnailBorderRadius['left']) ? $thumbnailBorderRadius['left'] . 'px' : esc_attr($thumbnailBorderRadius['left'])) . ';';
                        }

                    $output .= '">';
                    $output .= $thumbnail . '</a></div>';
                }
                // END Thumbnail

                // MAIN Content
                $output .= '<div class="rs-content" style="';
                    // Margin
                    if (!empty($contentitemMarginNew['top']) || !empty($contentitemMarginNew['right']) || !empty($contentitemMarginNew['bottom']) || !empty($contentitemMarginNew['left'])) {
                        $output .= 'margin: ' .
                            (is_numeric($contentitemMarginNew['top']) ? $contentitemMarginNew['top'] . 'px' : esc_attr($contentitemMarginNew['top'])) . ' ' .
                            (is_numeric($contentitemMarginNew['right']) ? $contentitemMarginNew['right'] . 'px' : esc_attr($contentitemMarginNew['right'])) . ' ' .
                            (is_numeric($contentitemMarginNew['bottom']) ? $contentitemMarginNew['bottom'] . 'px' : esc_attr($contentitemMarginNew['bottom'])) . ' ' .
                            (is_numeric($contentitemMarginNew['left']) ? $contentitemMarginNew['left'] . 'px' : esc_attr($contentitemMarginNew['left'])) . '; ';
                    }
                    // Padding
                    if ( !empty($contentitemPaddingNew['top']) || !empty($contentitemPaddingNew['right']) ||  !empty($contentitemPaddingNew['bottom']) || !empty($contentitemPaddingNew['left'])) {
                        $output .= 'padding: ' .(isset($contentitemPaddingNew['top']) && $contentitemPaddingNew['top'] !== '' ? (is_numeric($contentitemPaddingNew['top']) ? $contentitemPaddingNew['top'] . 'px' : esc_attr($contentitemPaddingNew['top'])) : '0px') . ' ' . (isset($contentitemPaddingNew['right']) && $contentitemPaddingNew['right'] !== '' ? (is_numeric($contentitemPaddingNew['right']) ? $contentitemPaddingNew['right'] . 'px' : esc_attr($contentitemPaddingNew['right'])) : '0px') . ' ' . (isset($contentitemPaddingNew['bottom']) && $contentitemPaddingNew['bottom'] !== '' ? (is_numeric($contentitemPaddingNew['bottom']) ? $contentitemPaddingNew['bottom'] . 'px' : esc_attr($contentitemPaddingNew['bottom'])) : '0px') . ' ' . (isset($contentitemPaddingNew['left']) && $contentitemPaddingNew['left'] !== '' ? (is_numeric($contentitemPaddingNew['left']) ? $contentitemPaddingNew['left'] . 'px' : esc_attr($contentitemPaddingNew['left'])) : '0px') . '; '; 
                    } else { // Default fallback
                        $output .= 'padding: 40px 35px 50px 35px;';
                    }
                    // Check if at least one side is not empty
                    if ( !empty($contentBorderWidth['top']) || !empty($contentBorderWidth['right']) || !empty($contentBorderWidth['bottom']) || !empty($contentBorderWidth['left'])) {
                        $output .= 'border-width: ' .
                            (is_numeric($contentBorderWidth['top']) ? $contentBorderWidth['top'] . 'px' : esc_attr($contentBorderWidth['top'])) . ' ' .
                            (is_numeric($contentBorderWidth['right']) ? $contentBorderWidth['right'] . 'px' : esc_attr($contentBorderWidth['right'])) . ' ' .
                            (is_numeric($contentBorderWidth['bottom']) ? $contentBorderWidth['bottom'] . 'px' : esc_attr($contentBorderWidth['bottom'])) . ' ' .
                            (is_numeric($contentBorderWidth['left']) ? $contentBorderWidth['left'] . 'px' : esc_attr($contentBorderWidth['left'])) . '; ';
                    }
                    // Border Style
                    if (!empty($contentNormalBorderType)) {
                        $output .= 'border-style: ' . esc_attr($contentNormalBorderType) . '; ';
                    }
                    // Background Color
                    if (!empty($contentBgColor)) {
                        $output .= 'background-color: ' . esc_attr($contentBgColor) . '; ';
                    }
                    // Border Color
                    if (!empty($contentBorderColor)) {
                        $output .= 'border-color: ' . esc_attr($contentBorderColor) . '; ';
                    }
                $output .= '">';

                // Meta Data
                if ($showMetaData) {
                            
                    $output .= '<div class="rs-meta align-' . $metaAlignment7 . ' " style="';  
                        // Margin
                        if (!empty($metaMarginNew['top']) || !empty($metaMarginNew['right']) || !empty($metaMarginNew['bottom']) || !empty($metaMarginNew['left'])) {
                            $output .= 'margin: ' .
                                (is_numeric($metaMarginNew['top']) ? $metaMarginNew['top'] . 'px' : esc_attr($metaMarginNew['top'])) . ' ' .
                                (is_numeric($metaMarginNew['right']) ? $metaMarginNew['right'] . 'px' : esc_attr($metaMarginNew['right'])) . ' ' .
                                (is_numeric($metaMarginNew['bottom']) ? $metaMarginNew['bottom'] . 'px' : esc_attr($metaMarginNew['bottom'])) . ' ' .
                                (is_numeric($metaMarginNew['left']) ? $metaMarginNew['left'] . 'px' : esc_attr($metaMarginNew['left'])) . '; ';
                        }
                        // Padding
                        if (!empty($metaPadding['top']) || !empty($metaPadding['right']) || !empty($metaPadding['bottom']) || !empty($metaPadding['left'])) {
                            $output .= 'padding: ' .
                                (is_numeric($metaPadding['top']) ? $metaPadding['top'] . 'px' : esc_attr($metaPadding['top'])) . ' ' .
                                (is_numeric($metaPadding['right']) ? $metaPadding['right'] . 'px' : esc_attr($metaPadding['right'])) . ' ' .
                                (is_numeric($metaPadding['bottom']) ? $metaPadding['bottom'] . 'px' : esc_attr($metaPadding['bottom'])) . ' ' .
                                (is_numeric($metaPadding['left']) ? $metaPadding['left'] . 'px' : esc_attr($metaPadding['left'])) . '; ';
                        }   
                        
                        // Color
                        if (!empty($metaTextColor)) {
                            $output .= 'color: ' . esc_attr($metaTextColor) . '; ';
                        }
                        // Order
                        if (!empty($metaOrder)) {
                            $output .= 'order: ' . esc_attr($metaOrder) . '; ';
                        }
                    $output .= '">';

                    $meta_items = [];

                    // Date
                    if ($showPostDate) {
                        $meta = '<div class="meta-date" style="';

                        // Color
                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }

                        // Font size
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }
                        $meta .= '">';
                        $meta .= '<span>' . esc_html($getdate) . '</span>';
                        $meta .= '</div>';

                        $meta_items[] = $meta;
                    }

                    // Author
                    if ($showPostCategory) {
                        $meta = '<div class="meta-category" style="';

                        if (!empty($metaTextColor)) {
                            $meta .= 'color:' . esc_attr($metaTextColor) . '; ';
                        }
                        if (!empty($metaFontSize)) {
                            $meta .= 'font-size:' . esc_attr($metaFontSize) . 'px; ';
                        }

                        $meta .= '">';

                        // Get category names without links
                        $categories_list = get_the_category($post_id);
                        if (!empty($categories_list)) {
                            $category_names = array();

                            foreach ($categories_list as $category) {
                                // If you want to link to the category archive, use get_category_link()
                                $category_link = esc_url(get_category_link($category->term_id));
                                $category_names[] = '<a href="' . $category_link . '">' . esc_html($category->name) . '</a>';
                            }

                            $meta .= implode(', ', $category_names); // comma-separated category links
                        }

                        $meta .= '</div>';
                        $meta_items[] = $meta;
                    }


                    // Now join meta items with the separator
                    $output .= implode( $meta_items);

                    $output .= '</div>'; // Close meta-data-list
                    
                }
                // End Meta Data

                // title
                if ($showPostTitle) {
                    $titleStyles = '';

                    // Order
                    if (!empty($titleOrder)) {
                        $titleStyles .= 'order: ' . esc_attr($titleOrder) . '; ';
                    }
                    // Background color
                    if (!empty($postTitleBgColor)) {
                        $titleStyles .= 'background-color: ' . esc_attr($postTitleBgColor) . '; ';
                    }
                    // Margin
                    if (!empty($postTitleMargin['top']) || !empty($postTitleMargin['right']) || !empty($postTitleMargin['bottom']) || !empty($postTitleMargin['left'])) {
                        $titleStyles .= 'margin: ' .
                            (is_numeric($postTitleMargin['top']) ? $postTitleMargin['top'] . 'px' : esc_attr($postTitleMargin['top'])) . ' ' .
                            (is_numeric($postTitleMargin['right']) ? $postTitleMargin['right'] . 'px' : esc_attr($postTitleMargin['right'])) . ' ' .
                            (is_numeric($postTitleMargin['bottom']) ? $postTitleMargin['bottom'] . 'px' : esc_attr($postTitleMargin['bottom'])) . ' ' .
                            (is_numeric($postTitleMargin['left']) ? $postTitleMargin['left'] . 'px' : esc_attr($postTitleMargin['left'])) . '; ';
                    }
                    // Padding
                    if (!empty($postTitlePadding['top']) || !empty($postTitlePadding['right']) || !empty($postTitlePadding['bottom']) || !empty($postTitlePadding['left'])) {
                        $titleStyles .= 'padding: ' .
                            (is_numeric($postTitlePadding['top']) ? $postTitlePadding['top'] . 'px' : esc_attr($postTitlePadding['top'])) . ' ' .
                            (is_numeric($postTitlePadding['right']) ? $postTitlePadding['right'] . 'px' : esc_attr($postTitlePadding['right'])) . ' ' .
                            (is_numeric($postTitlePadding['bottom']) ? $postTitlePadding['bottom'] . 'px' : esc_attr($postTitlePadding['bottom'])) . ' ' .
                            (is_numeric($postTitlePadding['left']) ? $postTitlePadding['left'] . 'px' : esc_attr($postTitlePadding['left'])) . '; ';
                    }
                    // Class name
                    $classNames = 'title' 
                        . ($titleHoverUnderLine === 'enable' ? ' underline' : '') 
                        . ' align-' . esc_attr($postTitleAlignment);
                    // Hover JS (conditionally included)
                    $onmouseover = !empty($postTitleHoverBgColor) 
                        ? ' onmouseover="this.style.backgroundColor=\'' . esc_attr($postTitleHoverBgColor) . '\';"' 
                        : '';
                    $onmouseout = !empty($postTitleBgColor) 
                        ? ' onmouseout="this.style.backgroundColor=\'' . esc_attr($postTitleBgColor) . '\';"' 
                        : '';
                    // Final output
                    $output .= '<' . esc_attr($titleTag) . ' class="' . esc_attr($classNames) . '" style="' . esc_attr(trim($titleStyles)) . '"' 
                        . $onmouseover 
                        . $onmouseout 
                        . '>';

                    $style = '';
                    $hoverStyle = '';
                    $mouseoutStyle = '';

                    // Build inline styles conditionally
                    if (!empty($postTitleFontSize)) {
                        $style .= 'font-size: ' . esc_attr($postTitleFontSize) . 'px; ';
                    }
                    if (!empty($postTitleLineHeight)) {
                        $style .= 'line-height: ' . esc_attr($postTitleLineHeight) . '; ';
                    }
                    if (!empty($postTitleLetterSpacing)) {
                        $style .= 'letter-spacing: ' . esc_attr($postTitleLetterSpacing) . 'px; ';
                    }
                    if (!empty($postTitleFontWeight)) {
                        $style .= 'font-weight: ' . esc_attr($postTitleFontWeight) . '; ';
                    }
                    if (!empty($postTitleColor)) {
                        $style .= 'color: ' . esc_attr($postTitleColor) . '; ';
                        $mouseoutStyle = 'this.style.color=\'' . esc_attr($postTitleColor) . '\';';
                    }
                    // Build hover color style if set
                    if (!empty($postTitleHoverColor)) {
                        $hoverStyle = 'this.style.color=\'' . esc_attr($postTitleHoverColor) . '\';';
                    }
                    // Final output
                    $output .= '<a href="' . esc_url($permalink) . '" 
                        style="' . esc_attr(trim($style)) . '"'
                        . (!empty($hoverStyle) ? ' onmouseover="' . $hoverStyle . '"' : '')
                        . (!empty($mouseoutStyle) ? ' onmouseout="' . $mouseoutStyle . '"' : '') . '>'
                        . esc_html($croppedTitle) . '</a>';    
                    $output .= '</' . esc_attr($titleTag) . '>';
                }

                if ($showPostExcerpt) {
                    $excerptStyles = '';

                    // Order
                    if (!empty($excerptOrder)) {
                        $excerptStyles .= 'order: ' . esc_attr($excerptOrder) . '; ';
                    }

                    // Typography
                    if (!empty($excerptFontSize)) {
                        $excerptStyles .= 'font-size: ' . esc_attr($excerptFontSize) . 'px; ';
                    }

                    if (!empty($excerptLineHeight)) {
                        $excerptStyles .= 'line-height: ' . esc_attr($excerptLineHeight) . '; ';
                    }

                    if (!empty($excerptLetterSpacing)) {
                        $excerptStyles .= 'letter-spacing: ' . esc_attr($excerptLetterSpacing) . 'px; ';
                    }

                    if (!empty($excerptFontWeight)) {
                        $excerptStyles .= 'font-weight: ' . esc_attr($excerptFontWeight) . '; ';
                    }

                    if (!empty($excerptColor)) {
                        $excerptStyles .= 'color: ' . esc_attr($excerptColor) . '; ';
                    }

                    if (!empty($excerptBgColor)) {
                        $excerptStyles .= 'background-color: ' . esc_attr($excerptBgColor) . '; ';
                    }

                    if (!empty($excerptBorderType)) {
                        $excerptStyles .= 'border-style: ' . esc_attr($excerptBorderType) . '; ';
                    }

                    // Margin
                    if (!empty($excerptMargin['top']) || !empty($excerptMargin['right']) || !empty($excerptMargin['bottom']) || !empty($excerptMargin['left'])) {
                        $excerptStyles .= 'margin: ' .
                            (is_numeric($excerptMargin['top']) ? $excerptMargin['top'] . 'px' : esc_attr($excerptMargin['top'])) . ' ' .
                            (is_numeric($excerptMargin['right']) ? $excerptMargin['right'] . 'px' : esc_attr($excerptMargin['right'])) . ' ' .
                            (is_numeric($excerptMargin['bottom']) ? $excerptMargin['bottom'] . 'px' : esc_attr($excerptMargin['bottom'])) . ' ' .
                            (is_numeric($excerptMargin['left']) ? $excerptMargin['left'] . 'px' : esc_attr($excerptMargin['left'])) . '; ';
                    }

                    // Padding
                    if (!empty($excerptPadding['top']) || !empty($excerptPadding['right']) || !empty($excerptPadding['bottom']) || !empty($excerptPadding['left'])) {
                        $excerptStyles .= 'padding: ' .
                            (is_numeric($excerptPadding['top']) ? $excerptPadding['top'] . 'px' : esc_attr($excerptPadding['top'])) . ' ' .
                            (is_numeric($excerptPadding['right']) ? $excerptPadding['right'] . 'px' : esc_attr($excerptPadding['right'])) . ' ' .
                            (is_numeric($excerptPadding['bottom']) ? $excerptPadding['bottom'] . 'px' : esc_attr($excerptPadding['bottom'])) . ' ' .
                            (is_numeric($excerptPadding['left']) ? $excerptPadding['left'] . 'px' : esc_attr($excerptPadding['left'])) . '; ';
                    }

                    // Handle hover logic conditionally
                    $hoverIn = '';
                    $hoverOut = '';

                    if (!empty($excerptHoverColor)) {
                        $hoverIn .= 'this.style.color=\'' . esc_attr($excerptHoverColor) . '\';';
                        $hoverOut .= 'this.style.color=\'' . esc_attr($excerptColor) . '\';';
                    }

                    if (!empty($excerptHoverBgColor)) {
                        $hoverIn .= 'this.style.backgroundColor=\'' . esc_attr($excerptHoverBgColor) . '\';';
                        $hoverOut .= 'this.style.backgroundColor=\'' . esc_attr($excerptBgColor) . '\';';
                    }

                    if (!empty($excerptHoverBorderColor)) {
                        $hoverIn .= 'this.style.borderColor=\'' . esc_attr($excerptHoverBorderColor) . '\';';
                        $hoverOut .= 'this.style.borderColor=\'inherit\';';
                    }

                    $output .= '<p class="fpg-excerpt' . ' align-' . esc_attr($excerptAlignment7) . '" style="' . esc_attr(trim($excerptStyles)) . '"';

                    if (!empty($hoverIn) || !empty($hoverOut)) {
                        $output .= ' onmouseover="' . esc_attr($hoverIn) . '"';
                        $output .= ' onmouseout="' . esc_attr($hoverOut) . '"';
                    }

                    $output .= '>';
                    $output .= '' . esc_html($excerpt) . '</p>';
                    
                }
                // Button Output                
                if ($showReadMoreButton) {
                    // Button wrapper styles
                    $buttonWrapperStyle = '';

                    // Margin
                    if (!empty($buttonMarginNew['top']) || !empty($buttonMarginNew['right']) || !empty($buttonMarginNew['bottom']) || !empty($buttonMarginNew['left'])) {
                        $buttonWrapperStyle .= 'margin: ' .
                            (is_numeric($buttonMarginNew['top']) ? $buttonMarginNew['top'] . 'px' : esc_attr($buttonMarginNew['top'])) . ' ' .
                            (is_numeric($buttonMarginNew['right']) ? $buttonMarginNew['right'] . 'px' : esc_attr($buttonMarginNew['right'])) . ' ' .
                            (is_numeric($buttonMarginNew['bottom']) ? $buttonMarginNew['bottom'] . 'px' : esc_attr($buttonMarginNew['bottom'])) . ' ' .
                            (is_numeric($buttonMarginNew['left']) ? $buttonMarginNew['left'] . 'px' : esc_attr($buttonMarginNew['left'])) . '; ';
                    }

                    // Order
                    if (!empty($buttonOrder)) {
                        $buttonWrapperStyle .= 'order: ' . esc_attr($buttonOrder) . ';';
                    }
   
                    $output .= '<div class="btn-wrapper align-' . esc_attr($buttonAlignment) . '" style="' . esc_attr(trim($buttonWrapperStyle)) . '">';

                    // Button inline styles
                    $buttonInlineStyles = '';

                    if (!empty($buttonTextColor)) {
                        $buttonInlineStyles .= 'color: ' . esc_attr($buttonTextColor) . '; ';
                    }
                    if (!empty($buttonBackgroundColor)) {
                        $buttonInlineStyles .= 'background-color: ' . esc_attr($buttonBackgroundColor) . '; ';
                    }
                    if (!empty($buttonFontSize)) {
                        $buttonInlineStyles .= 'font-size: ' . esc_attr($buttonFontSize) . 'px; ';
                    }
                    if (!empty($buttonFontWeight)) {
                        $buttonInlineStyles .= 'font-weight: ' . esc_attr($buttonFontWeight) . '; ';
                    }
                    if (!empty($buttonBorderColor)) {
                        $buttonInlineStyles .= 'border-color: ' . esc_attr($buttonBorderColor) . '; ';
                    }
                    if (!empty($buttonBorderType)) {
                        $buttonInlineStyles .= 'border-style: ' . esc_attr($buttonBorderType) . '; ';
                    }

                    // Border width
                    
                    if (!empty($buttonBorderWidth['top']) || !empty($buttonBorderWidth['right']) || !empty($buttonBorderWidth['bottom']) || !empty($buttonBorderWidth['left'])) {
                        $buttonInlineStyles .= 'border-width: ' .
                            (is_numeric($buttonBorderWidth['top']) ? $buttonBorderWidth['top'] . 'px' : esc_attr($buttonBorderWidth['top'])) . ' ' .
                            (is_numeric($buttonBorderWidth['right']) ? $buttonBorderWidth['right'] . 'px' : esc_attr($buttonBorderWidth['right'])) . ' ' .
                            (is_numeric($buttonBorderWidth['bottom']) ? $buttonBorderWidth['bottom'] . 'px' : esc_attr($buttonBorderWidth['bottom'])) . ' ' .
                            (is_numeric($buttonBorderWidth['left']) ? $buttonBorderWidth['left'] . 'px' : esc_attr($buttonBorderWidth['left'])) . '; ';
                    }
                    if (!empty($buttonBorderRadius['top']) || !empty($buttonBorderRadius['right']) || !empty($buttonBorderRadius['bottom']) || !empty($buttonBorderRadius['left'])) {
                        $buttonInlineStyles .= 'border-radius: ' .
                            (is_numeric($buttonBorderRadius['top']) ? $buttonBorderRadius['top'] . 'px' : esc_attr($buttonBorderRadius['top'])) . ' ' .
                            (is_numeric($buttonBorderRadius['right']) ? $buttonBorderRadius['right'] . 'px' : esc_attr($buttonBorderRadius['right'])) . ' ' .
                            (is_numeric($buttonBorderRadius['bottom']) ? $buttonBorderRadius['bottom'] . 'px' : esc_attr($buttonBorderRadius['bottom'])) . ' ' .
                            (is_numeric($buttonBorderRadius['left']) ? $buttonBorderRadius['left'] . 'px' : esc_attr($buttonBorderRadius['left'])) . '; ';
                    }
                    if (!empty($buttonPaddingNew['top']) || !empty($buttonPaddingNew['right']) || !empty($buttonPaddingNew['bottom']) || !empty($buttonPaddingNew['left'])) {
                        $buttonInlineStyles .= 'padding: ' .
                            (is_numeric($buttonPaddingNew['top']) ? $buttonPaddingNew['top'] . 'px' : esc_attr($buttonPaddingNew['top'])) . ' ' .
                            (is_numeric($buttonPaddingNew['right']) ? $buttonPaddingNew['right'] . 'px' : esc_attr($buttonPaddingNew['right'])) . ' ' .
                            (is_numeric($buttonPaddingNew['bottom']) ? $buttonPaddingNew['bottom'] . 'px' : esc_attr($buttonPaddingNew['bottom'])) . ' ' .
                            (is_numeric($buttonPaddingNew['left']) ? $buttonPaddingNew['left'] . 'px' : esc_attr($buttonPaddingNew['left'])) . '; ';
                    }

                    // Hover styles
                    $buttonHoverInlineStyles = '';
                    $buttonResetStyles = '';

                    if (!empty($buttonHoverTextColor)) {
                        $buttonHoverInlineStyles .= "this.style.color='" . esc_attr($buttonHoverTextColor) . "';";
                        $buttonResetStyles .= "this.style.color='" . esc_attr($buttonTextColor) . "';";
                    }
                    if (!empty($buttonHoverBorderColor)) {
                        $buttonHoverInlineStyles .= "this.style.borderColor='" . esc_attr($buttonHoverBorderColor) . "';";
                        $buttonResetStyles .= "this.style.borderColor='" . esc_attr($buttonBorderColor) . "';";
                    }
                    if (!empty($buttonHoverBackgroundColor)) {
                        $buttonHoverInlineStyles .= "this.style.backgroundColor='" . esc_attr($buttonHoverBackgroundColor) . "';";
                        $buttonResetStyles .= "this.style.backgroundColor='" . esc_attr($buttonBackgroundColor) . "';";
                    }

                    // Button anchor tag
                    $output .= '<a class="rs-btn read-more ' . esc_attr($buttonStyle7) . '" href="' . esc_url(get_permalink()) . '" style="' . esc_attr(trim($buttonInlineStyles)) . '"';

                    if (!empty($buttonHoverInlineStyles)) {
                        $output .= ' onmouseover="' . $buttonHoverInlineStyles . '"';
                    }

                    if (!empty($buttonResetStyles)) {
                        $output .= ' onmouseout="' . $buttonResetStyles . '"';
                    }

                    $output .= '>';

                    // Icon handling
                    $fontSizeStyle = !empty($buttonFontSize) ? ' style="font-size: ' . esc_attr($buttonFontSize) . 'px;"' : '';

                    $leftIcon  = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';
                    $rightIcon = '<i class="ri-arrow-right-line"' . $fontSizeStyle . '></i>';

                    if ($iconPosition === 'left' && $showButtonIcon) {
                        $output .= $leftIcon . ' ';
                    }

                    $output .= esc_html($readMoreLabel);

                    if ($iconPosition === 'right' && $showButtonIcon) {
                        $output .= ' ' . $rightIcon;
                    }

                    $output .= '</a></div>';
                }
                // End Button

                $output .= '</div>';
                // End MAIN Content
                $output .= '</div>';
                $output .= '</div>';
                // End Full post layout
            }
            
        }
        
        
        $output .= '</div>'; // End row
        $output .= '</div>'; // End .fancy-post-grid
        // Check if pagination is enabled
        
        

    wp_reset_postdata();

    return $output;
}